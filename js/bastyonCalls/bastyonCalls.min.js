/*! For license information please see bastyonCalls.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.libraryStarter=e():t.libraryStarter=e()}(this,(()=>(()=>{"use strict";var t={326:(t,e,n)=>{n.d(e,{Z:()=>c});var i=n(81),o=n.n(i),r=n(645),a=n.n(r)()(o());a.push([t.id,'@keyframes callPulse{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes fadeIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes answerPulse{from{-moz-box-shadow:0 0 0 0 rgba(var(--color-bg-ac-bright), 0.4);box-shadow:0 0 0 0 rgba(var(--color-bg-ac-bright), 0.4)}50%{-moz-box-shadow:0 0 0 .6em rgba(var(--color-bg-ac-bright), 0.4);box-shadow:0 0 0 .6em rgba(var(--color-bg-ac-bright), 0.4)}to{-moz-box-shadow:0 0 0 0 rgba(var(--color-bg-ac-bright), 0.4);box-shadow:0 0 0 0 rgba(var(--color-bg-ac-bright), 0.4)}}#bc-root{-moz-transition:.05s transform;-o-transition:.05s transform;-webkit-transition:.05s transform;transition:.05s transform}#bc-root button{outline:none;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}#bc-root button:after{content:"";display:block;position:absolute;border-radius:4em;left:0;top:0;width:100%;height:100%;opacity:0;transition:all .5s;box-shadow:0 0 10px 40px rgba(var(--neutral-grad-2), 0.4)}#bc-root button.loading *{display:none}#bc-root button.loading:before{content:"";position:absolute;width:16px;height:16px;border:2px solid rgba(0,0,0,0);border-top-color:rgb(var(--text-color));border-radius:50%;animation:spin .6s linear infinite;display:block}#bc-root button:active:after{box-shadow:0 0 0 0 rgba(var(--neutral-grad-2), 0.4);position:absolute;border-radius:4em;left:0;top:0;opacity:1;transition:0s}#bc-root.full{position:fixed !important;z-index:300000;width:100vw;height:100vh;top:0}#bc-root.full #bc-format i::before{content:""}#bc-root.middle{position:fixed !important;z-index:300000;width:100vw;height:100vh;top:0}#bc-root.middle .bc-format{display:none}@media screen and (min-width: 1280px){#bc-root.middle{z-index:300000;width:70vw;height:80vh;top:10vh}#bc-root.middle .bc-topnav{width:70vw}#bc-root.middle .bc-topnav .bc-format{display:initial}#bc-root.middle .bc-video-container{width:70vw;height:80vh;position:relative}#bc-root.middle .bc-video-container .active video{max-width:70vw;max-height:80vh}#bc-root.middle .bc-video-container .minified{position:absolute}#bc-root.middle .bc-controls{max-width:70vw;bottom:10vh;padding:2% 0}}#bc-root.middle #bc-format i::before{content:""}#bc-root.minified{position:fixed;width:auto;height:auto;top:initial;right:initial;bottom:20px;left:20px;border:1px solid rgba(0,0,0,0);border-radius:30px;overflow:hidden}#bc-root.minified .status{display:none !important}#bc-root.minified .bc-topnav{width:auto;padding:5%;opacity:0}#bc-root.minified .bc-topnav .bc-call-info{max-width:100%}#bc-root.minified .bc-topnav .bc-call-info .info{overflow:hidden}#bc-root.minified .bc-topnav .bc-call-info .info .name{width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#bc-root.minified .bc-topnav .options{display:none}#bc-root.minified .bc-video-container{width:auto;height:auto;max-height:initial !important;padding-bottom:0;transition:width,height .3s ease}#bc-root.minified .bc-video-container.vertical{max-width:250px}#bc-root.minified .bc-video-container.vertical .active{max-width:250px}#bc-root.minified .bc-video.minified{display:none}#bc-root.minified .bc-video.active{height:100%;max-width:350px}#bc-root.minified .bc-video.active.novid{max-height:250px;padding:1em;max-width:250px}#bc-root.minified .bc-video.active video{transition:all .3s ease;width:auto}@media screen and (max-width: 768px){#bc-root.minified .bc-video .name{display:none}}#bc-root.minified .bc-video-btn{display:none}#bc-root.minified .bc-controls{position:absolute;bottom:0;min-width:initial !important;justify-content:space-between;opacity:0;transition:opacity .3s ease}@media screen and (max-width: 768px){#bc-root.minified .bc-controls{display:none !important}}#bc-root.minified .bc-controls .bc-btn{width:37px;height:37px;display:flex;justify-content:center;align-items:center;position:relative;max-width:55px;max-height:55px;font-size:.8rem;margin:0}#bc-root.minified .bc-controls .bc-btn.bc-camera,#bc-root.minified .bc-controls .bc-btn.bc-hide{display:none}#bc-root.minified .bc-controls .bc-btn#bc-expand{display:flex}#bc-root.minified:hover .bc-controls,#bc-root.minified:hover .bc-topnav{display:flex;opacity:1}@media screen and (max-width: 768px){#bc-root.minified{top:65px !important;right:10px !important;left:initial !important;bottom:initial !important;border-radius:10px;overflow:hidden}#bc-root.minified .bc-video-container{max-width:250px}#bc-root.minified .bc-video-container.vertical{max-width:25vw}#bc-root.minified .bc-topnav{display:none !important}}.bc{-webkit-tap-highlight-color:rgba(0,0,0,0) !important}.bc-container{font-family:"Segoe UI Variable","Segoe UI",SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;display:flex;flex-wrap:wrap;justify-content:space-evenly;align-items:center}.bc-container>div{z-index:333333}.bc-notify{z-index:4444444 !important;position:fixed;top:28px}@media screen and (max-width: 768px){.bc-notify{top:56px}}.bc-incoming-call{z-index:33333;padding:10px;width:494px;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;background:radial-gradient(87.44% 183.75% at 50% 50%, rgba(0, 0, 0, 0) 0%, #000000 100%),#242f3d;box-shadow:0 4px 20px rgba(0,0,0,.5);border-radius:12px}@media screen and (max-width: 576px){.bc-incoming-call{padding:16px;width:90vw}}.bc-incoming-call .user{display:flex;justify-content:space-between;max-width:50%}@media screen and (max-width: 576px){.bc-incoming-call .user{max-width:70%;margin-bottom:16px}}.bc-incoming-call .user .title{text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;line-height:20px;color:rgb(var(--color-cc-white))}.bc-incoming-call .user .title .name{font-size:16px;text-align:left;color:rgb(var(--text-on-bg-ac-color));width:200px;overflow:hidden;text-overflow:ellipsis}.bc-incoming-call .user .title .description{color:rgb(var(--neutral-grad-2));font-size:14px;text-align:left}.bc-incoming-call .user .avatar{margin-right:16px;border:2px solid rgba(0,0,0,0);min-width:44px;width:44px;height:44px;border-radius:50%;overflow:hidden;display:flex;justify-content:center;align-items:center;font-size:1.4em;color:rgba(var(--background-hidden-layer, 0.1))}.bc-incoming-call .user .avatar img{height:100%;width:100%}.bc-incoming-call .buttons{display:flex;justify-content:space-between}@media screen and (max-width: 576px){.bc-incoming-call .buttons{width:100%;justify-content:space-between}.bc-incoming-call .buttons .bc-btn{width:48% !important;margin:0}}.bc-incoming-call .buttons .bc-btn{width:56px;height:48px;border-radius:12px;margin:0 10px;border:none;cursor:pointer}.bc-incoming-call .buttons .bc-answer{background:linear-gradient(90deg, #495AFF 0%, #0ACFFE 100%),#00a4ff;animation:answerPulse .8s infinite;box-shadow:0 0 0 0 #00a4ff;transition:box-shadow .3s ease}.bc-incoming-call .buttons .bc-answer:hover{animation:none;filter:brightness(90%)}.bc-incoming-call .buttons #bc-answer-voice{height:48px;width:48px;border-radius:24px;background:linear-gradient(90deg, rgba(73, 90, 255, 0.3333333333) 0%, rgba(10, 207, 254, 0.3333333333) 100%),rgba(0,164,255,.3333333333)}.bc-incoming-call .buttons .bc-decline{background:linear-gradient(90deg, #EB3349 2.65%, #F45C43 100.53%),#eb5757}.bc-incoming-call .buttons .bc-decline i{transform:rotate(225deg)}.bc-incoming-call .buttons i{color:rgb(var(--text-on-bg-ac-color))}.bc-ended-call{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;background:radial-gradient(87.44% 183.75% at 50% 50%, rgba(0, 0, 0, 0) 0%, #000000 100%),#242f3d;color:rgb(var(--text-on-bg-ac-color))}.bc-ended-call .avatar{display:flex;border:2px solid rgba(var(--background-hidden-layer, 0.1));width:160px;height:160px;border-radius:50%;overflow:hidden;justify-content:center;align-items:center;font-size:1.6em;color:rgba(var(--background-hidden-layer, 0.1))}.bc-ended-call .avatar img{width:100%;height:100%}.bc-ended-call .name{font-size:28px;font-weight:600;margin-top:42px;width:400px;text-align:center;max-width:90vw;overflow:hidden;text-overflow:ellipsis}.bc-ended-call .description{color:#838383;font-size:16px;line-height:24px;margin-top:4px}.bc-ended-call button{cursor:pointer}.bc-video{position:relative;display:flex;justify-content:center}@media screen and (orientation: portrait){.bc-video{max-width:100%}}.bc-video-container{display:flex;justify-content:center;flex-wrap:wrap;align-items:center;width:100vw;height:100vh;background:radial-gradient(55.29% 79.17% at 50% 47.76%, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.88) 100%),#242f3d;box-shadow:0 32px 64px rgba(0,0,0,.56),0 2px 21px rgba(0,0,0,.55);animation:fadeIn .5s ease-out}@media screen and (orientation: portrait){.bc-video{justify-content:center}}.bc-video .name{position:absolute;bottom:0;left:0;text-align:center;font-size:12px;height:12px;line-height:12px;min-width:60px;background-color:rgba(255,255,255,.4)}.bc-video video{max-height:100%;width:100%}@media screen and (orientation: portrait){.bc-video video{max-height:40vh}}.bc-video.active{width:100%;margin:0 auto;height:100vh;max-height:100vh}.bc-video.active .avatar{border:2px solid rgba(var(--background-hidden-layer, 0.1));width:160px;height:160px;margin-bottom:20px;border-radius:50%;overflow:hidden;display:none;justify-content:center;align-items:center;font-size:1.6em;color:rgba(var(--background-hidden-layer, 0.1))}.bc-video.active .avatar img{width:100%;height:100%}.bc-video.active .status{display:none;height:0;color:rgba(var(--background-hidden-layer, 0.1));transition:opacity .3s ease;animation:2s callPulse infinite;text-align:center}.bc-video.active video{max-height:100vh;max-width:100vw;width:auto !important}.bc-video.active.novid{max-height:100%;align-items:center;align-content:center;flex-wrap:wrap;max-width:200px}.bc-video.active.novid .avatar{margin-bottom:0;display:flex}.bc-video.active.novid video{display:none}.bc-video.active.novid.connecting .status{display:block}.bc-video.minified{margin:0;border-radius:20px;z-index:33333333;position:fixed;right:20px;bottom:10%;overflow:hidden}.bc-video.minified video{transform:scale(-1, 1);height:15vh;width:auto;max-height:150px}@media screen and (orientation: portrait){.bc-video.minified video{height:15vh;width:auto}}@media screen and (max-width: 768px){.bc-video.minified{bottom:120px}}.bc-controls{display:flex;justify-content:center;position:fixed;background:linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.99466) 99.44%);bottom:0;width:100%;padding:5%;min-width:280px !important;max-width:100vw}.bc-controls .bc-btn{margin:0 20px;background:rgba(var(--neutral-grad-2), 0.4);text-align:center;font-size:1em;font-weight:600;border-radius:50%;width:55px;height:55px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:none}.bc-controls .bc-btn:disabled{cursor:not-allowed;opacity:.5;background:rgba(var(--neutral-grad-2), 0.2)}.bc-controls .bc-btn.active{background:rgb(var(--text-on-bg-ac-color))}.bc-controls .bc-btn.active i{color:rgb(var(--text-color))}@media screen and (max-width: 768px){.bc-controls .bc-btn{margin:0 10px;width:45px;height:45px}}.bc-controls .bc-btn i{pointer-events:none;color:rgb(var(--text-on-bg-ac-color))}.bc-controls .bc-btn.bc-decline{background:rgb(var(--color-bad));border:1px solid rgba(0,0,0,0);transform:rotate(225deg)}.bc-controls .bc-btn#bc-expand{display:none}@media screen and (max-width: 768px){.bc-controls{padding-bottom:60px}}.bc-topnav{z-index:4444444 !important;display:flex;justify-content:space-between;align-items:center;position:absolute;top:0;right:0;left:0;color:rgb(var(--text-on-bg-ac-color));background:linear-gradient(180deg, rgba(0, 0, 0, 0.799466) 0%, rgba(0, 0, 0, 0) 99.44%);padding:26px 28px;width:100vw}.bc-topnav .options button{background:rgba(0,0,0,0);border:none;cursor:pointer}.bc-topnav .options button i{color:rgb(var(--text-on-bg-ac-color))}@media screen and (max-width: 768px){.bc-topnav{padding-top:44px}}.bc-call-info{display:flex;align-items:center}.bc-call-info .avatar{display:flex;min-width:40px;width:40px;height:40px;border-radius:50%;overflow:hidden;justify-content:center;align-items:center;font-size:1.6em;color:rgba(var(--background-hidden-layer, 0.1));background:rgb(var(--neutral-grad-0))}.bc-call-info .avatar img{height:100%}.bc-call-info .info{margin-left:10px;display:flex;flex-direction:column}.bc-call-info .info .name{font-weight:700;width:200px;overflow:hidden;text-overflow:ellipsis;transition:width .3s ease}@media(pointer: fine){.bc-call-info .info .name:hover{width:400px}}#controls[data-call-type=voice] #bc-video-on{display:none}#controls[data-call-type=voice] #bc-video-off{background:rgb(var(--text-on-bg-ac-color))}#controls[data-call-type=voice] #bc-video-off i{color:rgb(var(--text-color))}#controls[data-call-type=video] #bc-video-off{display:none}.hidden{display:none}',""]);const c=a},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,o,r){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var s=0;s<t.length;s++){var d=[].concat(t[s]);i&&a[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),e.push(d))}},e}},81:t=>{t.exports=function(t){return t[1]}},187:t=>{var e,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function r(){r.init.call(this)}t.exports=r,t.exports.once=function(t,e){return new Promise((function(n,i){function o(n){t.removeListener(e,r),i(n)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}h(t,e,r,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&h(t,"error",e,{once:!0})}(t,o)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var a=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function s(t,e,n,i){var o,r,a,s;if(c(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),a=r[e]),void 0===a)a=r[e]=n,++t._eventsCount;else if("function"==typeof a?a=r[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(o=l(t))>0&&a.length>o&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=e,d.count=a.length,s=d,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=d.bind(i);return o.listener=n,i.wrapFn=o,o}function f(t,e,n){var i=t._events;if(void 0===i)return[];var o=i[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):p(o,o.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function h(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function o(r){i.once&&t.removeEventListener(e,o),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var o="error"===t,r=this._events;if(void 0!==r)o=o&&void 0===r.error;else if(!o)return!1;if(o){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)i(l,this,e);else{var s=l.length,d=p(l,s);for(n=0;n<s;++n)i(d[n],this,e)}return!0},r.prototype.addListener=function(t,e){return s(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return s(this,t,e,!0)},r.prototype.once=function(t,e){return c(e),this.on(t,u(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,u(this,t,e)),this},r.prototype.removeListener=function(t,e){var n,i,o,r,a;if(c(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){a=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},r.prototype.listeners=function(t){return f(this,t,!0)},r.prototype.rawListeners=function(t){return f(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},r.prototype.listenerCount=v,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},a=[],c=0;c<t.length;c++){var l=t[c],s=i.base?l[0]+i.base:l[0],d=r[s]||0,u="".concat(s," ").concat(d);r[s]=d+1;var f=n(u),v={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)e[f].references++,e[f].updater(v);else{var p=o(v,i);i.byIndex=c,e.splice(c,0,{identifier:u,updater:p,references:1})}a.push(u)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var r=i(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<r.length;a++){var c=n(r[a]);e[c].references--}for(var l=i(t,o),s=0;s<r.length;s++){var d=n(r[s]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}r=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0;var i={};return(()=>{n.r(i),n.d(i,{default:()=>M});var t=n(187),e=n(379),o=n.n(e),r=n(795),a=n.n(r),c=n(569),l=n.n(c),s=n(565),d=n.n(s),u=n(216),f=n.n(u),v=n(589),p=n.n(v),h=n(326),m={};function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=y(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,r=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw r}}}}function y(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function x(){x=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var o=e&&e.prototype instanceof u?e:u,r=Object.create(o.prototype),a=new I(i||[]);return r._invoke=function(t,e,n){var i="suspendedStart";return function(o,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw r;return{value:void 0,done:!0}}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var c=C(a,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=s(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),r}function s(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d={};function u(){}function f(){}function v(){}var p={};c(p,o,(function(){return this}));var h=Object.getPrototypeOf,m=h&&h(h(L([])));m&&m!==e&&n.call(m,o)&&(p=m);var g=v.prototype=u.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(o,r,a,c){var l=s(t[o],t,r);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==b(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,a,c)}),(function(t){i("throw",t,a,c)})):e.resolve(u).then((function(t){d.value=t,a(d)}),(function(t){return i("throw",t,a,c)}))}c(l.arg)}var o;this._invoke=function(t,n){function r(){return new e((function(e,o){i(t,n,e,o)}))}return o=o?o.then(r,r):r()}}function C(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,C(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=s(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=v,c(g,"constructor",v),c(v,"constructor",f),f.displayName=c(v,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),c(w.prototype,r,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,i,o,r){void 0===r&&(r=Promise);var a=new w(l(e,n,i,o),r);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,a,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var c=n.call(r,"catchLoc"),l=n.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function C(t,e,n,i,o,r,a){try{var c=t[r](a),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(i,o)}function A(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var r=t.apply(e,n);function a(t){C(r,i,o,a,c,"next",t)}function c(t){C(r,i,o,a,c,"throw",t)}a(void 0)}))}}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function L(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return E(t)}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}m.styleTagTransform=p(),m.setAttributes=d(),m.insert=l().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=f(),o()(h.Z,m),h.Z&&h.Z.locals&&h.Z.locals;var T="video",O="voice",P=function(t){return t===T},_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(c,t);var e,n,i,o,r,a=(o=c,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=S(o);if(r){var n=S(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return L(this,t)});function c(t,e,n,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),j(E(o=a.call(this)),"controls",{}),j(E(o),"isFrontalCamera",!1),j(E(o),"videoStreams",null),j(E(o),"isMuted",!1),j(E(o),"activeCall",null),j(E(o),"secondCall",null),j(E(o),"syncInterval",null),j(E(o),"isWaitingForConnect",!1),j(E(o),"signal",null),j(E(o),"timer",null),j(E(o),"timeInterval",null),j(E(o),"title",null),j(E(o),"destroyed",!1),j(E(o),"view","middle"),j(E(o),"templates",{incomingCall:function(t){var e=P(t.type),n=e?"incomingVideoCall":"incomingAudioCall";return'\n\t\t\t<div class="bc-incoming-call">\n\t\t\t\t<div class="user">\n\t\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t'.concat(this.getAvatar(t),'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="title">\n\t\t\t\t\t\t<div class="name">').concat(t.initiator.source.name,'</div>\n\t\t\t\t\t\t<div class="description">').concat(this.options.getWithLocale(n),'</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="buttons">\n\t\t\t\t\t<button class="bc-btn bc-decline" id="bc-decline"><i class="fas fa-phone"></i></button>\n\t\t\t\t\t').concat(e?'<button class="bc-btn bc-answer" id="bc-answer-video"><i class="fa fa-video"></i></button>':"",'\n\t\t\t\t\t<button class="bc-btn bc-answer " id="bc-answer-voice"><i class="fas fa-flip-horizontal fa-phone"></i></button>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t')},endedCall:function(t){return'\t\n\t\t\t<div class="bc-ended-call">\n\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t'.concat(this.getAvatar(t),'\n\t\t\t\t</div>\n\t\t\t\t<div class="name">').concat(this.activeCall.initiator.source.name,'</div>\n\t\t\t\t<div class="description">').concat(this.options.getWithLocale("endedCall"),"</div>\n\t\t\t</div>")},videoCall:function(){return'\n\t\t\t<div class="bc-topnav">\n\t\t\t\t<div class="bc-call-info">\n\t\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t'.concat(this.getAvatar(),'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="info">\n\t\t\t\t\t\t<div class="name">').concat(this.activeCall.initiator.source.name,'</div>\n\t\t\t\t\t\t<div class="time" id="time">0:00</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="options">\n\x3c!--\t\t\t\t\t<button class="bc-btn bc-cog" id="bc-cog"><i class="fas fa-cog"></i></button>--\x3e\n\t\t\t\t\t<button class="bc-btn bc-pip" id="bc-pip"><i class="fas fa-minus"></i></button>\n\t\t\t\t\t<button class="bc-btn bc-format" id="bc-format"><i class="fas"></i></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bc-video-container">\n\t\t\t\t<div class="bc-video active novid" id="remote-scene">\n\t\t\t\t\t<video id="remote" pip="false" autoplay disablePictureInPicture="true" playsinline poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="></video>\n\t\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t').concat(this.getAvatar(),'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="status">').concat(this.options.getWithLocale("connecting"),'</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bc-video minified">\n\t\t\t\t\t<video id="local" muted pip="false" disablePictureInPicture="true" autoplay playsinline poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="></video>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bc-controls" data-call-type="video" id="controls">\n\t\t\t\t<button disabled class="bc-btn bc-camera" id="bc-camera"><i class="fas fa-sync-alt"></i></button>\n\t\t\t\t<button class="bc-btn bc-video-on call-update-control" disabled id="bc-video-on"><i class="fas fa-video"></i></button>\n\t\t\t\t<button class="bc-btn bc-video-off call-update-control" id="bc-video-off"><i class="fas fa-video-slash"></i></button>\n\t\t\t\t<button class="bc-btn bc-mute" id="bc-mute"><i class="fas fa-microphone"></i></button>\n\t\t\t\t<button class="bc-btn bc-decline" id="bc-decline"><i class="fas fa-phone"></i></button>\n\t\t\t\t<button class="bc-btn bc-expand" id="bc-expand"><i class="fas fa-expand"></i></button>\n\t\t\t</div>\n\t\t')},voiceCall:function(){return'<div class="bc-topnav">\n\t\t\t\t<div class="bc-call-info">\n\t\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t'.concat(this.getAvatar(),'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="info">\n\t\t\t\t\t\t<div class="name">').concat(this.activeCall.initiator.source.name,'</div>\n\t\t\t\t\t\t<div class="time" id="time">0:00</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="options">\n\x3c!--\t\t\t\t\t<button class="bc-btn bc-cog" id="bc-cog"><i class="fas fa-cog"></i></button>--\x3e\n\t\t\t\t\t<button class="bc-btn bc-pip" id="bc-pip"><i class="fas fa-minus"></i></button>\n\t\t\t\t\t<button class="bc-btn bc-format" id="bc-format"><i class="fas"></i></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bc-video-container">\n\t\t\t\t<div class="bc-video active novid" id="remote-scene">\n\t\t\t\t\t<video id="remote" pip="false" autoplay playsinline poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="></video>\n\t\t\t\t\t<div class="avatar">\n\t\t\t\t\t\t').concat(this.getAvatar(),'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="status">').concat(this.options.getWithLocale("connecting"),'</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bc-video minified">\n\t\t\t\t\t<video id="local" class="hidden" muted pip="false" autoplay playsinline poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="></video>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-call-type="voice" class="bc-controls voice" id="controls">\n\t\t\t\t<button class="bc-btn bc-camera" disabled id="bc-camera"><i class="fas fa-sync-alt"></i></button>\n\t\t\t\t<button class="bc-btn bc-video-on call-update-control" id="bc-video-on"><i class="fas fa-video"></i></button>\n\t\t\t\t<button class="bc-btn bc-video-off call-update-control" disabled id="bc-video-off" ><i class="fas fa-video-slash"></i></button>\n\t\t\t\t<button class="bc-btn bc-mute" id="bc-mute"><i class="fas fa-microphone"></i></button>\n\t\t\t\t<button class="bc-btn bc-decline" id="bc-decline"><i class="fas fa-phone"></i></button>\n\t\t\t\t<button class="bc-btn bc-expand" id="bc-expand"><i class="fas fa-expand"></i></button>\n\t\t\t</div>\n\t\t')}}),j(E(o),"renderTemplates",{call:function(t){if(o.root){var e=document.getElementById("controls"),n=!!e,i=P(t);if(n){var r=document.getElementById("bc-camera"),a=document.getElementById("local");e.dataset.callType=t,r&&(r.disabled=!i),a&&a.classList.toggle("hidden",!i)}else{var c=o.templates["".concat(t,"Call")];if(!c)throw Error("No template for ".concat(t));o.root.innerHTML=(null==c?void 0:c.call(E(o)))||"",o.initCallInterface("videoCall")}}},incomingCall:function(t){var e,n,i,r,a;o.notify&&("ringing"!==(null===(e=E(o))||void 0===e||null===(n=e.activeCall)||void 0===n?void 0:n.state)||(null===(i=E(o))||void 0===i||null===(r=i.activeCall)||void 0===r?void 0:r.callId)===t.callId?(o.notify.innerHTML=(null===(a=o.templates.incomingCall)||void 0===a?void 0:a.call(E(o),t))||"",o.initCallInterface("incomingCall",t)):t.reject("busy"))},clearNotify:function(){o.notify&&(o.notify.innerHTML="")},clearVideo:function(){o.root&&(o.root.innerHTML="")},clearInterface:function(){o.root&&(o.root.classList.remove("active"),o.cancelMini(),o.root.classList.remove("middle"),o.root.classList.remove("full"))},endedCall:function(t){var e;o.root&&(o.root.classList.contains("minified")&&o.cancelMini(),o.root.innerHTML=(null===(e=o.templates.endedCall)||void 0===e?void 0:e.call(E(o),t))||"")}}),j(E(o),"updateCall",function(){var t=A(x().mark((function t(e){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.handleCallUpdate(A(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("dasda"),!P(e)){t.next=7;break}return t.next=5,o.activeCall.upgradeCall(!0,!0);case 5:t.next=8;break;case 7:o.activeCall.setLocalVideoMuted(!0);case 8:o.renderTemplates.call(e);case 9:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),o.client=t,o.matrixcs=e,o.initEvents(),o.initSignals(),o.initTemplates(n),o.options=i,console.log("ss",t,e),console.log("dd",e),o}return e=c,n=[{key:"destroy",value:function(){var t;this.destroyed=!0,this.activeCall&&this.activeCall.hangup(),this.secondCall&&this.secondCall.hangup(),this.clearTimer(),this.clearBlinking(),clearInterval(this.syncInterval),null===(t=this.signal)||void 0===t||t.pause(),this.signal=null,this.renderTemplates.clearInterface(),this.renderTemplates.clearVideo(),this.renderTemplates.clearNotify(),this.container&&this.container.remove(),this.container=null,this.root=null,this.notify=null}},{key:"initTemplates",value:function(t){var e=this;t.insertAdjacentHTML("beforeend",'<div class="bc-container" id="bc-container"><div id="bc-notify" class="bc-notify"></div><div id="bc-root"></div></div>'),this.root=document.getElementById("bc-root"),this.notify=document.getElementById("bc-notify"),this.container=document.getElementById("bc-container"),window&&(window.onbeforeunload=function(){e.activeCall&&e.activeCall.hangup()})}},{key:"initEvents",value:function(){var t=this;this.client.on("Call.incoming",function(){var e=A(x().mark((function e(n){var i,o,r,a,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fledgling"!=n.state){e.next=3;break}return e.next=3,R((function(){return"fledgling"!=n.state}),50);case 3:if(!n.hangupParty&&!n.hangupReason){e.next=5;break}return e.abrupt("return");case 5:t.clearBlinking(),t.setBlinking(),t.emit("initcall"),null!=t&&null!==(i=t.options)&&void 0!==i&&i.onIncomingCall&&t.options.onIncomingCall(n),o=t.client.store.rooms[n.roomId].currentState.members,r=Object.keys(o).filter((function(e){return e!==t.client.credentials.userId})),a=o[r],c=o[t.client.credentials.userId],n.initiator=a,n.user=c,t.options.getUserInfo(a.userId).then((function(e){if(!n.hangupParty&&!n.hangupReason){if(a.source=e[0]||e,t.addCallListeners(n),t.activeCall){if(t.secondCall)n.reject("busy"),n.hangup("busy");else if(t.secondCall=n,"ringing"!==t.activeCall.state){var i=new Audio("js/lib");return i.autoplay=!0,i.loop=!0,i.volume=.5,t.signal=i,t.signal.src="sounds/incoming.mp3",void t.renderTemplates.incomingCall(n)}}else t.activeCall=n;var o=new Audio("js/lib");o.autoplay=!0,o.loop=!0,o.volume=.5,t.signal=o,t.renderTemplates.incomingCall(n),t.signal.src="sounds/incoming.mp3"}}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"initSignals",value:function(){this.signal=new Audio}},{key:"clearTimer",value:function(){this.timer=null,clearInterval(this.timeInterval),this.timeInterval=null}},{key:"initTimer",value:function(){this.timer=0;var t=document.getElementById("time");this.timeInterval=setInterval(function(){this.timer++;var e=Math.floor(this.timer/60),n=this.timer%60;t.innerHTML="".concat(e,":").concat(n>=10?n:"0"+n)}.bind(this),1e3)}},{key:"answer",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,i=P(n);null===(t=this.signal)||void 0===t||t.pause();var o=function(){return e.activeCall.answer(!0,i)};this.initCordovaPermisions(n).then((function(){try{"connected"!==e.activeCall.state&&"ended"!==e.activeCall.state?(o(),e.renderTemplates.clearNotify(),e.renderTemplates.call(n)):(e.isWaitingForConnect=!0,e.renderTemplates.clearNotify(),e.activeCall.hangup(),setTimeout((function(){if(!e.destroyed)try{o(),e.isWaitingForConnect=!1,e.renderTemplates.call(n)}catch(t){console.error("Ошибка при ответе на вторую линию",t)}}),1e3))}catch(t){return Promise.reject(t)}return Promise.resolve()})).catch((function(t){console.error(t)}))}},{key:"initsync",value:function(){var t=this,e=document.querySelector(".bc-video-container");this.activeCall.peerConn.getStats(null).then((function(t){var e;(e=t,function(t){if(Array.isArray(t))return w(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).filter((function(t){return"candidate-pair"===t[1].type})).forEach((function(t){}))}));var n=!1;this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval((function(){var i;if(null!=t&&null!==(i=t.activeCall)&&void 0!==i&&i.remoteUsermediaStream){var o,r,a,c=null===(o=t.activeCall)||void 0===o||null===(r=o.remoteUsermediaStream)||void 0===r?void 0:r.getVideoTracks()[0],l=null!==(a=null==c?void 0:c.getSettings().aspectRatio)&&void 0!==a?a:1.3,s=!c;if(s||c&&l||window.isios&&window.isios()){if(!n){var d=document.getElementById("remote-scene");s?d.classList.add("novid"):d.classList.remove("novid"),d.classList.remove("connecting")}n=!0}if(l)return e.style.aspectRatio=1/l,void(l>1?e.classList.add("vertical"):e.classList.remove("vertical"));1!=e.style.aspectRatio&&(e.style.aspectRatio=1)}}),300)}},{key:"mute",value:function(t){t.stopPropagation();var e=this.activeCall.peerConn.getSenders().find((function(t){return"audio"===t.track.kind})),n=document.querySelector(".bc-mute");e.track.enabled?(n.firstChild.classList.remove("fa-microphone"),n.classList.add("active"),n.firstChild.classList.add("fa-microphone-slash")):(n.firstChild.classList.remove("fa-microphone-slash"),n.classList.remove("active"),n.firstChild.classList.add("fa-microphone")),e.track.enabled=!e.track.enabled}},{key:"handleCallUpdate",value:(i=A(x().mark((function t(e){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setCallUpdateControlsLoading(!0),t.prev=1,t.next=4,e();case 4:return t.prev=4,this.setCallUpdateControlsLoading(!1),t.finish(4);case 7:case"end":return t.stop()}}),t,this,[[1,,4,7]])}))),function(t){return i.apply(this,arguments)})},{key:"setCallUpdateControlsLoading",value:function(t){document.querySelectorAll(".call-update-control").forEach((function(e){e.disabled=t,e.classList.toggle("loading",t)}))}},{key:"hide",value:function(t){t.stopPropagation();var e=this.activeCall.peerConn.getSenders().find((function(t){var e;return"video"===(null===(e=t.track)||void 0===e?void 0:e.kind)||!t.track}));e.track.enabled,e.track.enabled=!e.track.enabled}},{key:"cameraCount",value:function(){navigator.mediaDevices.enumerateDevices().then((function(t){t.filter((function(t){return"videoinput"===t.kind})).length<=1&&(document.getElementById("bc-camera").style.display="none")}))}},{key:"devices",value:function(){return navigator.mediaDevices.enumerateDevices().then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return window.cordova&&window.cordova.plugins.EnumerateDevicesPlugin?cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={},i=[];return e.reverse(),console.log("cdevices",e),console.log("devices",t),t.forEach((function(t){var o={deviceId:t.deviceId,groupId:t.groupId,kind:t.kind,label:t.label},r=e.find((function(t,e){return o.kind==t.kind&&!n[t.deviceId]}));r&&(n[r.deviceId]=!0,o.label||(o.label=(r.label||"").toLowerCase())),i.push(o)})),console.log(i),Promise.resolve(i)})):Promise.resolve(t)}))}},{key:"camera",value:function(t){var e=this,n=this;try{this.devices().then((function(t){console.log("devices",t);var i,o=t.filter((function(t){return"videoinput"===t.kind})),r=n.activeCall.peerConn.getSenders().find((function(t){return"video"===t.track.kind}));if(console.log("video",o),console.log("sender",r),r&&o.length>1&&(r.track.label.includes("front")||r.track.label.includes("передней")?(console.log("to back"),i=o.reverse().find((function(t){return t.label.includes("back")||t.label.includes("задней")}))):r.track.label.includes("back")||r.track.label.includes("задней")?(console.log("to front"),i=o.find((function(t){return t.label.includes("front")||t.label.includes("передней")}))):(console.log("no labeled"),i=o.find((function(t){return t.label!==r.track.label}))),console.log("target",i),i)){var a={};a.deviceId={exact:i.deviceId},console.log("videoConstraints",a);var c={video:a,audio:!1};navigator.mediaDevices.getUserMedia(c).then((function(t){t.getTracks().forEach((function(e){var i=n.activeCall.peerConn.getSenders().find((function(t){return t.track.kind==e.kind}));i.track.label!==e.label&&(e.muted,i.replaceTrack(e),i.track.stop(),n.videoStreams.local.srcObject=t)})),e.hide()})).catch((function(t){}))}})).catch((function(t){}))}catch(t){}}},{key:"format",value:function(){console.log("format",this.root),this.root.classList.contains("middle")?(this.root.classList.remove("middle"),this.toFull()):this.root.classList.contains("full")&&(this.root.classList.remove("full"),this.toMiddle())}},{key:"pip",value:function(t){console.log("E",t),this.root.classList.contains("middle")?(this.root.classList.remove("middle"),this.toMini()):this.root.classList.contains("full")?(this.root.classList.remove("full"),this.toMini()):(this.cancelMini(),this.toMiddle())}},{key:"toMiddle",value:function(){var t;this.root.classList.add("middle"),localStorage.setItem("callSizeSettings","middle"),this.view="middle",null!=this&&null!==(t=this.options)&&void 0!==t&&t.changeView&&this.options.changeView(this.activeCall,this)}},{key:"toFull",value:function(){var t;this.root.classList.add("full"),localStorage.setItem("callSizeSettings","full"),this.view="full",null!=this&&null!==(t=this.options)&&void 0!==t&&t.changeView&&this.options.changeView(this.activeCall,this)}},{key:"getRootTranslate",value:function(){var t=((this.root.style.transform||"").replace("translate3d(","").replace(")","").replace(/px/g,"")||"0,0,0").split(",");return{x:Number(t[0]),y:Number(t[1])}}},{key:"setRootTranslate",value:function(t){var e=this,n=t.x,i=t.y;window.requestAnimationFrame((function(){e.root.style.transform="translate3d("+(n||0)+"px,"+(i||0)+"px,0px)"}))}},{key:"toMini",value:function(){var t,e=this;this.root.classList.add("minified"),localStorage.setItem("callSizeSettings","mini"),this.view="mini",null!=this&&null!==(t=this.options)&&void 0!==t&&t.changeView&&this.options.changeView(this.activeCall,this);var n=JSON.parse(localStorage.getItem("callPositionSettings"));console.log("pospos",n),n&&n.top&&n.left&&(this.root.style.bottom="auto",this.root.style.top=n.top,this.root.style.left=n.left),this.root.onmousedown=function(t){if(console.log("mouse down"),t.preventDefault(),!t.target.classList.contains("bc-btn")){var n=t.clientX-e.root.getBoundingClientRect().left,i=t.clientY-e.root.getBoundingClientRect().top;e.root.style.cursor="grabbing",e.root.style.zIndex=1e7,document.onmousemove=function(t){e.root.style.bottom="auto",t.pageY&&(window.innerHeight-e.root.getBoundingClientRect().bottom>10&&t.clientY-i>10?window.innerHeight-e.root.offsetHeight-11>=t.clientY-i&&(e.root.style.top=e.getPercents("height",t.clientY-i)):window.innerHeight-e.root.getBoundingClientRect().bottom<=10&&t.movementY<0?e.root.style.top=e.getPercents("height",window.innerHeight-e.root.offsetHeight-11):console.log("y out",window.innerHeight-e.root.getBoundingClientRect().bottom,t.clientY-i),t.pageX&&(0<t.clientX-n&&t.clientX-n<10&&t.movementX>0?e.root.style.left=t.pageX-n+"px":t.clientX-n>10&&document.body.clientWidth-e.root.getBoundingClientRect().left-e.root.offsetWidth>70?document.body.clientWidth-e.root.offsetWidth-71>=t.pageX-n&&(e.root.style.left=e.getPercents("width",t.pageX-n)):document.body.clientWidth-e.root.getBoundingClientRect().left-e.root.offsetWidth<=70&&t.movementX<0?e.root.style.left=e.root.style.left=e.getPercents("width",document.body.clientWidth-e.root.offsetWidth-71):console.log("x out",document.body.clientWidth-e.root.getBoundingClientRect().left-e.root.offsetWidth)))},document.onmouseleave=function(t){t.preventDefault(),console.log("leave"),document.onmousemove=null,e.root.onmouseup=null,e.root.ontouchend=null},document.onmouseup=function(t){console.log("mouse up"),localStorage.setItem("callPositionSettings",JSON.stringify({left:e.root.style.left,top:e.root.style.top})),document.onmousemove=null,e.root.style.cursor="grab",document.onmouseup=null},document.ontouchend=function(t){localStorage.setItem("callPositionSettings",JSON.stringify({left:e.root.style.left,top:e.root.style.top})),t.target.classList.contains("bc-btn")||t.preventDefault(),document.onmousemove=null,e.root.style.cursor="grab",document.ontouchend=null},t.stopPropagation()}},this.root.ondragstart=function(){return!1}}},{key:"getPercents",value:function(t,e){var n;switch(t){case"width":n=parseInt(e,10)/window.innerWidth;break;case"height":n=parseInt(e,10)/window.innerHeight}return"".concat(100*n+"%")}},{key:"cancelMini",value:function(){var t;this.root.classList.remove("minified"),this.hammertime&&(this.hammertime.off("pan"),this.hammertime.destroy()),document.onmousemove=null,this.root.style={},this.root.onmousedown=null,null!=this&&null!==(t=this.options)&&void 0!==t&&t.onCancelMini&&this.options.onCancelMini(this.activeCall,this)}},{key:"initCall",value:function(t){var e,n,i,o=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T,a=P(r);return(null==this||null===(e=this.activeCall)||void 0===e?void 0:e.roomId)===t?(console.log("only one call in room",null==this||null===(n=this.activeCall)||void 0===n?void 0:n.state),"ringing"===(null==this||null===(i=this.activeCall)||void 0===i?void 0:i.state)&&(console.log("answer to incoming from same room"),this.answer(r)),Promise.reject()):(console.log("init call"),this.initCordovaPermisions(r).then((function(){var e=o.client.store.rooms[t].currentState.members,n=e[Object.keys(e).filter((function(t){return t!==o.client.credentials.userId}))],i=e[o.client.credentials.userId];return o.options.getUserInfo(n.userId).then((function(e){n.source=e[0]||e,console.log(e,n),o.emit("initcall");var c=o.matrixcs.createNewMatrixCall(o.client,t);if(!o.activeCall){o.activeCall=c;var l=new Audio("js/lib");return l.autoplay=!0,l.loop=!0,l.volume=.5,o.signal=l,console.log("init call2"),c.placeCall(!0,a).then((function(){return console.log("init call3"),c.initiator=n,c.user=i,o.addCallListeners(c),o.signal.src="sounds/calling.mp3",o.renderTemplates.call(r),c}))}})).catch((function(t){return console.log("get user info error",t),Promise.reject(t)}))})))}},{key:"hexDecode",value:function(t){for(var e=0,n="",i=2;i<=t.length;i+=2){var o;(e=parseInt(t.substring(i-2,i),16))>=128&&(e+=848),n+=e=String.fromCharCode("0x"+(null===(o=e)||void 0===o?void 0:o.toString(16)))}return n}},{key:"hangup",value:function(t){t.stopPropagation(),this.activeCall.hangup("ended",!1),this.renderTemplates.clearVideo(),this.signal.pause()}},{key:"reject",value:function(t){t.reject("busy"),this.signal.pause()}},{key:"setLocalElement",value:function(){var t,e=this,n=null===(t=this.activeCall.feeds.find((function(t){return t.userId===e.activeCall.user.userId})))||void 0===t?void 0:t.stream;try{n&&document.getElementById("local")&&!document.getElementById("local").srcObject&&(document.getElementById("local").srcObject=n)}catch(t){console.log(t)}}},{key:"setRemoteElement",value:function(){var t,e=this,n=null===(t=this.activeCall.feeds.find((function(t){return t.userId!==e.activeCall.user.userId})))||void 0===t?void 0:t.stream;try{n&&document.getElementById("remote")&&(document.getElementById("remote").srcObject=n)}catch(t){console.log(t)}}},{key:"initCallInterface",value:function(t,e){var n,i=this;switch(t){case"incomingCall":document.getElementById("bc-answer-voice").addEventListener("click",(function(){return i.answer(O)})),null===(n=document.getElementById("bc-answer-video"))||void 0===n||n.addEventListener("click",(function(){return i.answer(T)})),document.getElementById("bc-decline").addEventListener("click",(function(){return i.reject(e)}));break;case"videoCall":this.videoStreams={remote:document.getElementById("remote"),local:document.getElementById("local")};try{var o;console.log("init call interface",this.activeCall),this.cameraCount(),this.root.style={};var r=null===(o=localStorage.getItem("callSizeSettings"))||void 0===o?void 0:o.toString();switch(this.setLocalElement(),console.log("init with "+r),r){case"mini":this.toMini();break;case"middle":default:this.toMiddle();break;case"full":this.toFull()}this.addVideoInterfaceListeners()}catch(t){console.log("init interface error",t)}}}},{key:"addVideoInterfaceListeners",value:function(){var t,e,n,i,o,r,a,c,l,s=this;null===(t=document.getElementById("bc-decline"))||void 0===t||t.addEventListener("click",(function(t){return s.hangup.call(s,t)})),null===(e=document.getElementById("bc-mute"))||void 0===e||e.addEventListener("click",(function(t){return s.mute.call(s,t)})),null===(n=document.getElementById("bc-video-on"))||void 0===n||n.addEventListener("click",(function(t){return s.updateCall(O)})),null===(i=document.getElementById("bc-video-off"))||void 0===i||i.addEventListener("click",(function(t){return s.updateCall(T)})),null===(o=document.getElementById("bc-camera"))||void 0===o||o.addEventListener("click",(function(t){return s.camera.call(s,t)})),null===(r=document.getElementById("bc-expand"))||void 0===r||r.addEventListener("click",(function(t){return s.pip.call(s,t)})),null===(a=document.getElementById("remote-scene"))||void 0===a||a.addEventListener("click",(function(t){return s.pip.call(s,t)})),null===(c=document.getElementById("bc-pip"))||void 0===c||c.addEventListener("click",(function(t){return s.pip.call(s,t)})),null===(l=document.getElementById("bc-format"))||void 0===l||l.addEventListener("click",(function(t){return s.format.call(s,t)}))}},{key:"updateCallElements",value:function(){this.setRemoteElement(),this.setLocalElement()}},{key:"addCallListeners",value:function(t){var e=this;console.log("addCallListeners"),this.on("muteStateChanged",(function(){console.log("changed idas df as")})),t.on("feeds_changed",(function(t,n){console.log("feed",t),e.updateCallElements()})),this.client.on("Room.timeline",(function(t){var n,i,o,r=t.event,a="m.call.negotiate"===r.type&&r.room_id===(null==e||null===(n=e.activeCall)||void 0===n?void 0:n.roomId),c="answer"===(null===(i=r.content)||void 0===i||null===(o=i.description)||void 0===o?void 0:o.type);a&&c&&e.initsync()})),t.on("state",(function(n,i){var o,r;console.log("state",n,t),"connecting"===n&&(e.signal.pause(),e.showConnecting()),"connected"===n&&(e.signal.pause(),e.showRemoteVideo(),e.timeInterval||e.initTimer(),e.clearBlinking(),e.initsync(),e.setCallUpdateControlsLoading(!1),null!=e&&null!==(o=e.options)&&void 0!==o&&o.onConnected&&e.options.onConnected(t,e)),"ended"===n&&(e.clearTimer(),clearInterval(e.syncInterval),e.syncInterval=null,e.signal.pause(),e.clearBlinking(),null!=e&&null!==(r=e.options)&&void 0!==r&&r.onEnded&&e.options.onEnded(t,e))})),t.on("hangup",(function(t){var n,i,o;if(console.log("hangup",t),clearInterval(e.syncInterval),e.syncInterval=null,console.log("Call ended",t.callId),t){if(t.callId===(null===(n=e.secondCall)||void 0===n?void 0:n.callId)&&(e.secondCall=null,"ringing"!==(null==e||null===(o=e.activeCall)||void 0===o?void 0:o.state)&&e.renderTemplates.clearNotify()),t.callId===(null===(i=e.activeCall)||void 0===i?void 0:i.callId)){if(e.isWaitingForConnect)return e.activeCall=e.secondCall,void(e.secondCall=null);if(e.renderTemplates.clearVideo(),e.renderTemplates.clearNotify(),"local"===t.hangupParty||t.localVideoElement)return e.root.classList.contains("minified")||!e.root.classList.length?(e.renderTemplates.clearVideo(),e.renderTemplates.clearInterface(),void(e.activeCall=null)):(e.renderTemplates.endedCall(t),"user_hangup"!==t.hangupReason||t.remoteStream||"local"===t.hangupParty||(e.signal.loop=!1,e.signal.src="sounds/busy.mp3"),void setTimeout((function(){e.renderTemplates.clearVideo(),e.renderTemplates.clearInterface(),e.activeCall=null}),1e3));e.signal.pause(),e.renderTemplates.clearInterface(),e.activeCall=null}}else e.renderTemplates.clearNotify()})),t.on("replaced",(function(t){console.log("replaced",t),console.log("old",e.activeCall),e.activeCall=null,e.signal.pause();var n=e.client.store.rooms[t.roomId].currentState.members,i=n[Object.keys(n).filter((function(t){return t!==e.client.credentials.userId}))],o=n[e.client.credentials.userId];t.initiator=i,t.user=o,e.options.getUserInfo(i.userId).then((function(n){t.hangupParty||t.hangupReason||(i.source=n[0]||n,e.addCallListeners(t),console.log("listen added",e,t),e.activeCall?e.secondCall?(console.log("all lines"),t.hangup("busy"),t.reject("busy")):(e.secondCall=t,console.log("now second",e.secondCall)):(e.activeCall=t,e.answer(),console.log("now active",e.activeCall)),"wait_local_media"===t.state?(console.log("wait media!"),setTimeout(function(){this.answer()}.bind(e),1e3)):e.answer())}))})),t.on("error",(function(n){console.error("some error",n,e),t.hangup("error"),e.signal.pause(),e.renderTemplates.clearVideo(),e.emit("error",n)}))}},{key:"getAvatar",value:function(t){var e,n,i,o;return null!=t&&null!==(e=t.initiator)&&void 0!==e&&null!==(n=e.source)&&void 0!==n&&n.image?'<img src="'.concat("undefined"!=typeof replaceArchiveInImage?replaceArchiveInImage(t.initiator.source.image):t.initiator.source.image,'"/>'):null!==(i=this.activeCall.initiator)&&void 0!==i&&null!==(o=i.source)&&void 0!==o&&o.image?'<img src="'.concat("undefined"!=typeof replaceArchiveInImage?replaceArchiveInImage(this.activeCall.initiator.source.image):this.activeCall.initiator.source.image,'"/>'):"<span>".concat(this.activeCall.initiator.source.name[0].toUpperCase(),"</span>")}},{key:"showRemoteVideo",value:function(){this.setRemoteElement()}},{key:"showConnecting",value:function(){document.getElementById("remote-scene").classList.add("connecting")}},{key:"setBlinking",value:function(){this.options.changeTitle&&this.options.changeTitle(this.options.getWithLocale("incomingCall"))}},{key:"clearBlinking",value:function(){this.options.changeTitle&&this.options.changeTitle()}},{key:"initCordovaPermisions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,e=P(t);return new Promise((function(t,n){var i;null!==(i=window)&&void 0!==i&&i.cordova?window.BSTMedia.permissions({audio:!0,video:e}).then((function(){console.log("camera is turned on"),setTimeout((function(){t()}),50)})).catch((function(t){console.log("Camera permission is not turned on"),n(t)})):A(x().mark((function i(){var o,r,a,c;return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,o=!!navigator.webkitGetUserMedia,i.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:e&&{facingMode:["user","environment"],width:o?{exact:640}:{ideal:640},height:o?{exact:360}:{ideal:360}}});case 4:r=i.sent,t(),a=g(r.getTracks());try{for(a.s();!(c=a.n()).done;)c.value.stop()}catch(t){a.e(t)}finally{a.f()}console.log("resolve",r),i.next=15;break;case 11:i.prev=11,i.t0=i.catch(0),console.log("reject",i.t0),n(i.t0);case 15:case"end":return i.stop()}}),i,null,[[0,11]])})))()}))}}],n&&k(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(t.EventEmitter);if(void 0===B)var B=function(t,e,n,i){if(t())e&&e();else{n||(n=20);var o=0,r=setInterval((function(){(t()||i&&i<=o)&&(clearInterval(r),e&&e()),o+=n}),n)}},R=function(t,e,n){return new Promise((function(i,o){B(t,i,e,n)}))};window.BastyonCalls=_;const M=_})(),i})()));