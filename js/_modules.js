
 /*_____*/ 
var about=function(){function n(e){var n,t,a,e=deep(e,"history"),i=null,o=null,s={videoWidth:function(e){var t=560,n=315,a=e.width(),n=a/(t/n);e.find("iframe").width(a),e.find("iframe").height(n)},time:function(){today=new Date,today=Math.floor((t-today)/1e3),tsec=today%60,today=Math.floor(today/60),tsec<0?tsec="00":tsec<10&&(tsec="0"+tsec),tmin=today%60,today=Math.floor(today/60),tmin<0?tmin="00":tmin<10&&(tmin="0"+tmin),thour=today%24,today=Math.floor(today/24),thour<0&&(thour="00"),today<0&&(today="00"),n.days.html(today),n.seconds.html(tsec),n.minutes.html(tmin),n.hours.html(thour)},fixed:function(){var e=$(window).scrollTop();n.main.offset().top+n.main.height()<e?n.fixed.addClass("active"):n.fixed.removeClass("active")},explore:function(){var e=n.c.find(".faq");_scrollToTop(e)},validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,t,n,a){a=a||"4";t={Email:e,Name:t};t.Action||(t.Action="ADDTOMAILLIST"),t.TemplateID||(t.TemplateID=a),$.ajax({type:"POST",url:"https://bastyon.com/Shop/AJAXMain.aspx",data:t,dataType:"json",success:function(){n&&n()}})},joinSuccess:function(e){m.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){m.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var t=e.el.find(".email"),e=e.el.find(".name"),t=t.val(),e=e.val();if(s.validateEmail(t)&&e)return s.saveEmail(t,e),s.joinSuccess(t,e),!0},clbk:function(e){function t(){var e=a.val(),t=n.val();return s.validateEmail(e)&&t?(i.removeClass("disabled"),!0):(i.addClass("disabled"),!1)}var n=e.find(".name"),a=e.find(".email"),i=e.find(".btn1");i.addClass("disabled"),i.on("click",function(){}),n.focus(),n.on("change",t),n.on("keyup",t),a.on("change",t),a.on("keyup",t)},class:"one joinbeta"})},{action:e})},whitepaperSuccess:function(){m.fastTemplate("whitepaperSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})})},whitepaper:function(){m.fastTemplate("whitepaper",function(e){dialog({html:e,wrap:!0,success:function(e){e=e.el.find("input").val();if(s.validateEmail(e))return s.saveEmail(e,"",null,"5"),s.whitepaperSuccess(),!0},clbk:function(e){function t(){var e=$(this).val();return s.validateEmail(e)?(n.removeClass("disabled"),!0):(n.addClass("disabled"),!1)}var n=e.find(".btn1");n.addClass("disabled"),n.on("click",function(){});e=e.find("input");e.focus(),e.on("change",t),e.on("keyup",t)},class:"one joinbeta"})})}},c=function(){s.whitepaper()},l=function(){s.join()},d=function(){var e=$(this).attr("answer");e&&o.send(e,function(){u.survey()})},r=[{name:"Twitter",icon:'<i class="fab fa-twitter"></i>',href:"https://twitter.com/Pocket_Net"},{name:"Telegram",icon:'<i class="fab fa-telegram"></i>',href:"https://t.me/PocketRep"},{name:"Facebook",icon:'<i class="fab fa-facebook"></i>',href:"https://www.facebook.com/PocketNet"},{name:"Minds",image:"https://cdn-assets.minds.com/front/dist/assets/logos/bulb.svg",href:"https://www.minds.com/PocketNet"},{name:"Linkedin",icon:'<i class="fab fa-linkedin"></i>',href:"https://www.linkedin.com/company/cryptolo-io"},{name:"Mastodon",icon:'<i class="fab fa-mastodon"></i>',href:"https://mastodon.social/@PocketRep"},{name:"Gab",image:"https://gab.com/assets/img/logo-dec.png",href:"https://gab.com/PocketNet"},{name:"Sola",image:"https://web.solacore.net/img/logo_medium-3_mNF.png",href:"https://sola.ai/cryptolo_io"},{name:"Medium",icon:'<i class="fab fa-medium"></i>',href:"https://medium.com/@cryptolo.io"}],u={survey:function(t){m.shell({name:"survey",el:n.survey,data:{survey:o},animation:"fadeIn"},function(e){e.el.find(".sendanswer").on("click",d),e.el.find(".resultpercent").each(function(){var e=$(this);e.animate({width:e.attr("w")+"%"},130)}),t&&t()})},tes:function(){var e=n.c.find(".tes");lazyEach({array:e,sync:!0,action:function(e){var t=$(e.item),n=t.attr("time")||600;t.addClass("show"),setTimeout(function(){e.success()},n)}})},lenta:function(){m.nav.api.load({open:!0,id:"lenta",el:n.lenta,animation:!1,mid:"about",essenseData:{author:"PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd",byauthor:!0,authAction:function(e){s.join(e)},notscrollloading:!0},clbk:function(e,t){i=t}})}},f=function(){};return{primary:e,getdata:function(e){i=null,o=new sQuestion({id:"pocketnetlanding",ajax:m.app.ajax,question:"Are you fed up with traditional social media like Facebook, Twitter and others?",answers:[{t:"Yes, very",v:1},{t:"Yes, somewhat",v:2},{t:"Facebook and Twitter are just great",v:3}]}),e({socials:r,survey:o})},destroy:function(){a&&clearInterval(a),i&&(i.destroy(),i=null),window.removeEventListener("scroll",s.fixed),n={}},init:function(e){f(),(n={}).c=e.el.find("#"+m.map.id),n.lenta=e.el.find(".lenta"),n.main=n.c.find(".main"),n.fixed=n.c.find(".fixedButton"),n.join=n.c.find(".ejoin"),n.whitepaper=n.c.find(".whitepaper"),n.days=e.el.find(".days"),n.seconds=e.el.find(".seconds"),n.minutes=e.el.find(".minutes"),n.hours=e.el.find(".hours"),n.survey=e.el.find(".survey"),t=new Date(2019,0,23,23,59),a=setInterval(s.time,1e3),n.join.on("click",l),n.whitepaper.on("click",c),n.c.find(".exploremore").on("click",s.explore),window.addEventListener("scroll",s.fixed),u.tes(),u.lenta(),o.init(function(){u.survey()}),s.videoWidth(n.c.find(".videoContent")),e.clbk(null,e)}}}var m=new nModule,a={};return m.run=function(e){var t=m.addEssense(a,n,e);m.init(t,e)},m.stop=function(){_.each(a,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=about:(app.modules.about={},app.modules.about.module=about);
 /*_____*/ 
var pkview=function(){function i(n){var e,n=deep(n,"history"),t={},a={qrcode:function(n,e){return new QRCode(n[0],{text:e,width:256,height:256})},mnemonic:function(n){var i="",o=(t.mnemonicMask.length*n/100).toFixed(0);return _.each(t.mnemonicKey,function(n,e){e=_.indexOf(t.mnemonicMask,e);i+=e<o||" "==n?n:c.app.platform.values.alph[rand(0,c.app.platform.values.alph.length-1)]}),i},mnemonicEffect:function(i,n,e){var o=indexArray(101);n&&o.reverse(),lazyEach({array:o,sync:!0,action:function(n){var e=n.item;i.html(a.mnemonic(e)),h=i.height(),setTimeout(n.success,rand(1,5))},all:{success:function(){e&&e()}}})},key:function(o){c.shell({name:"key",el:e.c.find(".keywrapper"),data:t,animation:{id:"slide"}},function(e){var n=e.el.find(".mnemonicKey");a.mnemonicEffect(n,!1,function(){});var i=a.qrcode(e.el.find(".qrcode"),t.mk);e.el.find(".copy").on("click",function(){copyText(e.el.find(".hiddenMnemonicKey")),sitemessage(c.app.localization.e("successfullycopied"))}),e.el.find(".save").on("click",function(){var n=e.el.find(".qrcode img").attr("src");saveAs({file:n,format:"png",name:"pocketnetkey"})}),window.cordova&&e.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:c.app.localization.e("e13145"),class:"itemmain",action:function(n){var e=b64toBlob(i._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(e,"pkey"+c.app.platform.currentTime()+".png",function(){n()})}}]})}),o&&o(e)})},dontshowagain:function(){e.c.find(".dontshowagain").addClass("active")}},i=function(){};return{primary:n,getdata:function(n,e){n({})},destroy:function(){e={}},init:function(n){i(),(e={}).c=n.el.find("#"+c.map.id),e.c.find(".dontshowagain").on("click",function(){c.closeContainer(),c.app.platform.sdk.registrations.remove(),isMobile()&&app.nav.api.load({open:!0,href:"index",history:!0})}),function(){t={};var n=localStorage.mnemonic;n&&c.app.platform.cryptography.api.aeswc.decryption(n,c.app.options.fingerPrint,{},function(n){var e;n&&(bitcoin.bip39.validateMnemonic(n)?(e=c.app.user.keysFromMnemo(trim(n)),t.mk=e.privateKey.toString("hex")):t.mk=n,t.mnemonicKey=n,t.mnemonicMask=_.shuffle(indexArray(t.mnemonicKey.length)),t.mnemonicContent=t.mnemonicKey.split(" "),a.key(),setTimeout(function(){a.dontshowagain()},2e3))})}(),n.clbk(null,n)},wnd:{class:"allscreen black withoutButtons pkviewwnd"}}}var c=new nModule,o={};return c.run=function(n){var e=c.addEssense(o,i,n);c.init(e,n)},c.stop=function(){_.each(o,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=pkview:(app.modules.pkview={},app.modules.pkview.module=pkview);
 /*_____*/ 
var applications=function(){function t(n){var t,i,n=deep(n,"history"),e=function(t,i){t&&t.github&&$.get(t.github.url,{},function(n){var o=deep(n,"assets")||[],n=_.find(o,function(n){return n.name==t.github.name});n&&((o=document.createElement("a")).setAttribute("href",n.browser_download_url),o.setAttribute("download","download"),o.click(),i&&i(n.browser_download_url))})},o=function(n){var o=os();o&&s.app.platform.applications[i.key][o]&&"undefined"==typeof _Electron&&!window.cordova?a.os(s.app.platform.applications[i.key][o],n):n&&n()},a={os:function(o){s.shell({turi:"registration",name:"os",el:t.c.find(".currentos"),data:{os:o,last:!1}},function(n){n.el.find(".downloadOs").on("click",function(){e(o,function(n){t.c.find(".os").addClass("rundownloading"),t.c.find(".skipositem").html('<div class="downloadstart">'+s.app.localization.e("e13011")+'</div><div><a href="'+n+'"><b>'+s.app.localization.e("e13012")+"</b></a></div>"),sa})})})}},d=function(){};return{primary:n,getdata:function(n,o){(i=deep(o,"settings.essenseData")||{}).key||(i.key="ui");n({})},destroy:function(){t={}},init:function(n){d(),(t={}).c=n.el.find("#"+s.map.id),o(),n.clbk(null,n)}}}var s=new nModule,i={};return s.run=function(n){var o=s.addEssense(i,t,n);s.init(o,n)},s.stop=function(){_.each(i,function(n){n.destroy()})},s}();"undefined"!=typeof module?module.exports=applications:(app.modules.applications={},app.modules.applications.module=applications);
 /*_____*/ 
var terms=function(){function e(n){var t,n=deep(n,"history"),e=function(){u.shell({name:u.app.localization.key,el:t.c,data:{}},function(n){})},o=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){t={}},init:function(n){o(),(t={}).c=n.el.find("#"+u.map.id),e(),n.clbk(null,n)},wnd:{class:"withoutButtons allscreen black a100"}}}var u=new nModule,o={};return u.run=function(n){var t=u.addEssense(o,e,n);u.init(t,n)},u.stop=function(){_.each(o,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=terms:(app.modules.terms={},app.modules.terms.module=terms);
 /*_____*/ 
var token=function(){function n(e){var e=deep(e,"history"),o=function(){var e=parameters().token||null;return{type:parameters().type||null,token:e}};return{primary:e,getdata:function(t){var e,n=o();"activate"!=n.type?a.app.platform.ws.addBlock():(delete(e=a.app.platform.ws.messages.CUSTOMER.ACTIVE).clbks.successDialog,e.clbks.success=function(){var e=deep(a,"app.modules.menu.module");e&&e.restart()}),a.app.platform.sdk.tokens.check(n.token,function(e){n.result=e,t(n)})},destroy:function(){a.app.platform.ws.removeBlock(),0},init:function(e){o(),{}.c=e.el.find("#"+a.map.id),e.clbk(null,e)}}}var a=new nModule,o={};return a.run=function(e){var t=a.addEssense(o,n,e);a.init(t,e)},a.stop=function(){_.each(o,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=token:(app.modules.token={},app.modules.token.module=token);
 /*_____*/ 
var page404=function(){function o(n){var n=deep(n,"history"),e=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){0},init:function(n){e(),{}.c=n.el.find("#"+t.map.id),n.clbk(null,n)}}}var t=new nModule,u={};return t.run=function(n){var e=t.addEssense(u,o,n);t.init(e,n)},t.stop=function(){_.each(u,function(n){n.destroy()})},t}();"undefined"!=typeof module?module.exports=page404:(app.modules.page404={},app.modules.page404.module=page404);
 /*_____*/ 
var registration=function(){function i(n){var c,i,t,e=deep(n,"history"),o={last:!1,end:!1},r=null,a={type:"STRING",name:"keyInput",id:"keyInput",placeholder:g.app.localization.e("confirmkey"),autoSearch:function(e,n,i){var t;0==o.mnemonicKey.indexOf(e)&&" "!=e[e.length-1]&&((e=e.split(" "))[t=e.length-1],i(_.filter(o.mnemonicContent,function(e,n){if(n<=t)return!0}).join(" ")))}};isMobile()&&delete a.autoSearch;var s=new Parameter(a),l={download:function(i){o.os&&o.os.github&&$.get(o.os.github.url,{},function(e){var n=deep(e,"assets")||[],e=_.find(n,function(e){return e.name==o.os.github.name});e&&((n=document.createElement("a")).setAttribute("href",e.browser_download_url),n.setAttribute("download","download"),n.click(),i&&i(e.browser_download_url))})},validation:function(){var e=trim(s.value);return e!=o.mnemonicKey&&e!=o.mk?(c.c.find(".note").html(g.app.localization.e("keysnotmatch")),c.c.addClass("error"),!1):(c.c.removeClass("error"),c.c.find(".note").html(""),!0)},registration:function(){l.validation()&&(localStorage.stay="1",g.app.user.stay=1,g.user.signin(o.mnemonicKey,function(e){return e?(o.end=!0,void v.confirm(function(){v.success(function(){setTimeout(function(){var e;"_this"==deep(i,"successHref")?g.app.user.validate()?((e=deep(t,"container.close"))&&e(),i.signInClbk&&i.signInClbk()):g.nav.api.loadSameThis("filluser",n):(i.nav||(i.nav={}),i.nav.history=!0,i.nav.reload=!1,g.app.reload({href:i.successHref||"filluser",nav:i.nav}))},2e3)})})):(c.c.find.note.html(g.app.localization.e("id98")),void c.c.addClass("error"))}))},generate:function(){c.c.removeClass("begin");var n=bitcoin.bip39.generateMnemonic();l.testqrcodeandkey(n,function(e){e?(o.mnemonicKey=n,o.mnemonicMask=_.shuffle(indexArray(o.mnemonicKey.length)),o.mnemonicContent=o.mnemonicKey.split(" "),e=g.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnet(e.publicKey).address,o.mk=e.privateKey.toString("hex"),v.key()):l.generate()})},repeat:function(){o.last=!1,v.confirm(function(){v.tips(function(){setTimeout(function(){c.c.removeClass("last"),setTimeout(function(){l.generate()},300)},300)})})},continue:function(){var e=c.c.find(".mnemonicKey");c.c.find(".keyStep").removeClass("showedPanel"),v.mnemonicEffect(e,!0,function(){o.last=!0,v.key(function(){setTimeout(function(){v.tips(),c.c.addClass("last"),setTimeout(function(){v.confirm()},300)},300)})})},removeDisabled:function(e){e.find(".continue").removeClass("disabled"),e.find(".preloader").remove(),e.find(".save").addClass("black"),e.find(".copy").addClass("black")},testqrcodeandkey:function(e,n){e=g.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=v.qrcode(c.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg");grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?n&&n(!1):n&&n(!0)},qrscanner.q.decode(e)})}},d=function(){l.registration()},u=function(){l.generate()},f=function(){$(this).hasClass("disabled")||l.continue()},p=function(){l.repeat()},m=function(){l.download(function(e){c.c.find(".osStep").addClass("rundownloading"),c.c.find(".skipositem").html('<div class="downloadstart">'+g.app.localization.e("e13011")+'</div><div><a href="'+e+'"><b>'+g.app.localization.e("e13012")+"</b></a></div>")})},v={os:function(n){var e=os();e&&g.app.platform.applications[e]&&"undefined"==typeof _Electron&&!window.cordova&&!g.app.ref?(o.os=g.app.platform.applications[e],v.step("os",function(e){e.el.find(".downloadOs").on("click",m),e.el.find(".skip").on("click",function(){n&&n()})})):n()},step:function(e,n){g.shell({name:e,el:c.c.find("."+e+"Step"),data:o,animation:{id:"slide"}},function(e){n&&n(e)})},success:function(n){v.step("success",function(e){n&&n()})},tips:function(n){v.step("tips",function(e){e.el.find(".generate").on("click",u),n&&n()})},confirm:function(n){s.value="",o.keyInput=s,v.step("confirm",function(e){e.el.find(".repeat").on("click",p),e.el.find(".registrationButton").on("click",d),n?n():(ParametersLive([s],e.el),_scrollTo(e.el,r),initUpload({el:e.el.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:c.c.find(".confirm"),action:function(e,n){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?c.c.find(".note").html(g.app.localization.e("filedamaged")):(s.value=trim(e),s.el.val(s.value),l.registration())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(s.value=trim(e[1]),s.el.val(s.value),l.registration()):c.c.find(".note").html(g.app.localization.e("filedamaged")))}}),setTimeout(function(){e.el.find('input[type="text"]').on("focus",function(){e.el.find(".inputTable").addClass("typeactive")}),e.el.find('input[type="text"]').on("blur",function(){e.el.find(".inputTable").removeClass("typeactive")}),isMobile()||e.el.find(".autosearchInputCnt input").focus()},600))})},qrcode:function(e,n){return new QRCode(e[0],{text:n,width:256,height:256})},key:function(a){v.step("key",function(n){var e=n.el.find(".mnemonicKey"),i=c.c.find(".keyStep");i.removeClass("showedPanel");var t,o=n.el.find(".hiddenMnemonicKey").html();o&&(o=g.app.user.keysFromMnemo(trim(o)).privateKey.toString("hex"),t=v.qrcode(n.el.find(".qrcode"),o)),v.mnemonicEffect(e,!1,function(){i.addClass("showedPanel")}),n.el.find(".continue").on("click",f),setTimeout(function(){l.removeDisabled(n.el)},2e3),g.app.platform.clbks._focus.registration=function(){l.removeDisabled(n.el)},n.el.find(".copy").on("click",function(){copyText(n.el.find(".hiddenMnemonicKey")),sitemessage(g.app.localization.e("successfullycopied")),l.removeDisabled(n.el)}),n.el.find(".save").on("click",function(){var e=n.el.find(".qrcode img").attr("src");saveAs({file:e,format:"png",name:"pocketnetkey"})}),window.cordova&&n.el.find(".qrcode").on("click",function(){menuDialog({items:[{text:"Save key on device",class:"itemmain",action:function(e){var n=b64toBlob(t._oDrawing._elImage.currentSrc.split(",")[1],"image/png",512);saveAsWithCordova(n,"pkey"+g.app.platform.currentTime()+".png",function(){e()})}}]})}),a?a():_scrollTo(n.el,r)})},mnemonicEffect:function(i,e,n){var t=indexArray(101);e&&t.reverse();var o=i.height();i.css("min-height",o+"px"),lazyEach({array:t,sync:!0,action:function(e){var n=e.item;i.html(v.mnemonic(n)),o=i.height(),i.css("min-height",o+"px"),setTimeout(e.success,rand(1,5))},all:{success:function(){i.css("min-height","0px"),n&&n()}}})},mnemonic:function(e){var i="",t=(o.mnemonicMask.length*e/100).toFixed(0);return _.each(o.mnemonicKey,function(e,n){n=_.indexOf(o.mnemonicMask,n);i+=n<t||" "==e?e:g.app.platform.values.alph[rand(0,g.app.platform.values.alph.length-1)]}),i}};return{primary:e,getdata:function(e,n){g.nav.api.load({open:!0,href:"filluserfast"})},destroy:function(){delete g.app.platform.clbks._focus.registration,c={}},init:function(e){var n;(c={}).c=e.el.find("#"+g.map.id),c.registrationButton=c.c.find(".registrationButton"),c.toAuthorization=c.c.find(".toAuthorization"),c.login=c.c.find(".loginValue"),c.ler=c.c.find(".ler"),c.key=c.c.find(".key"),i=e.essenseData||{},t=e,(r=c.c.closest(".wndcontent")).length||(r=null),v.os(function(){v.tips()}),n=e,c.toAuthorization.on("click",function(){g.nav.api.loadSameThis("authorization",n)}),e.clbk(null,e)},wnd:{class:"withoutButtons allscreen"}}}var g=new nModule,t={};return g.run=function(e){var n=g.addEssense(t,i,e);g.init(n,e)},g.stop=function(){_.each(t,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=registration:(app.modules.registration={},app.modules.registration.module=registration);
 /*_____*/ 
var filluser=function(){function t(e){function l(n){w.app.ref?w.sdk.users.get(w.app.ref,function(){var e=deep(w,"sdk.users.storage."+w.app.ref+".name");n&&n(e)}):n&&n(null)}function c(){var e=w.app.ref||"",n="Overall";return-1<e.indexOf("author")&&(n="Account"),n=-1<e.indexOf("&s=")||-1<e.indexOf("&v=")?"Post":n}function i(n){return _.findIndex(t,function(e){return e==n})}var r,o,a,n,e=deep(e,"history"),s=null,p=!1,f=!1,d={captcha:{id:"captcha",render:"captcha",nextindex:"email",prev:function(t){var e=w.sdk.address.pnet().address;w.app.settings.get(e,"request")||""?k.next():h.check(function(e){e?k.next():w.sdk.captcha.get(function(e,n){n?k.to("network"):e.done?(k.next(),h.request()):(d.captcha.current=e,t())},!0)},!0)},after:function(e,n){var t,a=e.find(".ucaptchainput"),o=e.find(".redo"),i=e.find(".addCaptcha");setTimeout(function(){a.focus()},150);function r(e){return!!/^[a-zA-Z0-9]{4,}$/.test(e)}a.on("keyup",function(){t=$(this).val(),r(t)?i.removeClass("disabled"):i.addClass("disabled")}),i.on("click",function(){var e=a.val();r(e)&&w.sdk.captcha.make(e,function(e,n){return"captchashots"==e?(sitemessage(w.app.localization.e("e13118")),void k.redo()):void(e?sitemessage(w.app.localization.e("e13118")):n.done&&(k.next(),h.request()))},!0)}),o.one("click",function(){w.app.platform.m.log("userwisard_captcha_redo"),k.redo()})}},email:{id:"email",nextindex:"money",prev:function(e){m.referral(),localStorage.uei?k.next():e()},render:"email",after:function(e,n,t){function a(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)}var o,i=e.find(".uemailinput"),r=e.find(".skip"),s=e.find(".addEmail");i.focus(),i.on("keyup",function(){o=$(this).val(),a(o)?(s.removeClass("disabled"),r.addClass("hidden"),s.html(w.app.localization.e("e13119"))):(s.addClass("disabled"),r.removeClass("hidden"),s.html(w.app.localization.e("e13113")))}),s.on("click",function(){var e=i.val();a(e)&&(w.app.platform.m.log("userwisard_email_add"),k.next(),localStorage.uei=!0,function(e,t){topPreloader(20);var a={Email:e};a.Action||(a.Action="ADDTOMAILLIST"),a.TemplateID="1005",a.ref="",l(function(e){var n="";a.ref+=c(),e&&(a.ref+=", "+e,n+='<p><a href="https://bastyon.com/author?address='+w.app.ref+'">Referrer: '+e+"</a></p>");e=deep(document,"referrer");e&&(n+='<p><a href="'+e+'">From: '+e+"</a></p>"),a.body=encodeURIComponent(n),$.ajax({type:"POST",url:"https://bastyon.com/Shop/AJAXMain.aspx",data:a,dataType:"json",success:function(){topPreloader(100),t&&t()}})})}(e,function(){}))}),r.one("click",function(){w.app.platform.m.log("userwisard_email_skip"),localStorage.uei=!0,k.next()})}},money:{id:"money",nextindex:"settings",prev:function(n){h.check(function(e){e?k.next():p?k.to("captcha"):f?k.to("moneyfail"):n()})},ret:!1,render:"money",after:function(n,t,e){k.timer(n.find(".time"),e||59,function(){h.check(function(e){!e||"money"!=u&&"captcha"!=u?(w.app.platform.m.log("userwisard_modey_delay"),n.find(".subcaption").html(w.app.localization.e("wesentmoneydelay")),d.money.after(n,t,30)):(w.app.platform.m.log("userwisard_money_success"),k.next())},!0)})}},settings:{id:"settings",nextindex:"welcome",prev:function(e){e(),w.app.platform.m.log("userwisard_account")},render:"settings",after:function(e,n){},next:!0},welcome:{id:"welcome",prev:function(e){e()},render:"welcome",after:function(e){w.app.platform.m.log("userwisard_success"),setTimeout(function(){w.nav.api.go({href:"index?r=recommended",history:!0,open:!0})},1500),e.find(".welcome").on("click",function(){var e;"_this"==deep(a,"successHref")?((e=deep(n,"container.close"))&&e(),a.signInClbk&&a.signInClbk()):w.nav.api.go({href:"index?r=recommended",history:!0,open:!0})})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){w.app.errors.clbks.filluser=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=u||w.app.platform.loadingWithErrors||k.to("captcha"),delete w.app.errors.clbks.filluser)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(n){function t(){w.app.platform.sdk.node.transactions.get.allBalance(function(e){n.find(".balance").html("Balance: "+w.app.platform.mp.coin(e)+" PKOIN")})}t(),n.find(".check").on("click",function(){topPreloader(20),w.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),0<e&&("moneyfail"==u&&k.to("settings"),delete w.app.platform.sdk.node.transactions.clbks.moneyfail),t()}),w.app.platform.sdk.node.transactions.clbks.moneyfail=function(){w.app.platform.sdk.node.transactions.get.allBalance(function(e){0<e&&("moneyfail"==u&&k.to("settings"),delete w.app.platform.sdk.node.transactions.clbks.moneyfail)})}})}}},u=null,t=_.map(d,function(e,n){return n}),m={referral:function(){l(function(e){var n=c(),t=deep(document,"referrer");w.app.platform.m.log("registration_referal_name",e),w.app.platform.m.log("registration_referal_type",n),t&&w.app.platform.m.log("registration_referal_referrer",t)})}},h={request:function(o){w.sdk.users.requestFreeMoney(function(e,n){var t=w.sdk.address.pnet().address,a=w.app.settings.get(t,"request")||"";e||a?(w.app.settings.set(t,"request","true"),h.follow(),o&&o(!0)):("captcha"==n&&(p=!0,"money"!=u&&"captcha"!=u||k.to("captcha")),"error"==n&&(f=!0,"money"!=u&&"captcha"!=u||k.to("captcha")),o&&o(!1,"err"))})},check:function(n,e){w.app.platform.sdk.node.transactions.get.allBalance(function(e){n&&n(0<e)},e)},follow:function(){w.app.platform.sdk.node.transactions.clbks.filluser||(w.app.platform.sdk.node.transactions.clbks.filluser=function(){delete w.app.platform.sdk.node.transactions.clbks.filluser,h.check(function(e){e?"money"==u&&(w.app.platform.m.log("userwisard_money_success"),k.next()):h.follow()})})}},k={to:function(e,n){u=e,k.makeStep(n)},redo:function(e){k.makeStep(function(){})},next:function(e){(u=u?d[u].nextindex:d.captcha.id)&&k.makeStep(function(){})},makeStep:function(e){var t=d[u];t&&t.prev(function(){r.c&&(r.c.attr("step",t.id),g.panel(t,function(n){g.step(t,function(e){_scrollTop(e,s),n.find(".elpanel").addClass("active"),t.after(e,n)})}))})},timer:function(t,a,e){var o=new CircularProgress({radius:120,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 56px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#5D5D5D",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}});t.find(".circle").html(o.el);function n(e){var n=secInTime(e/1e3).split(":");t.find(".t .min").html(n[0]),t.find(".t .sec").html(n[1]),o.options.text={value:""},(e=100*(1-e/(1e3*a)))<0&&(e=0),o.update(e)}timer=new Timer({ontick:function(){n(timer.getDuration())},onend:function(){e&&e()}}),timer.start(a),n(timer.getDuration())}},v=function(){var e,n;u&&(e=d[u],n=r.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=r.c.find(".stepsWrapperLine"),n=n.closest(".stepsWrapper").width(),r.c.find(".step").width(n),e.css("margin-left","-"+i(u)*n+"px"),e.width(n*_.toArray(d).length))},g={step:function(e,t){r.c.find(".step").removeClass("active");var n=r.c.find('.step[step="'+e.id+'"] .stepBody'),a=n.closest(".step"),o=r.c.find(".stepsWrapperLine");g[e.render](n,function(e){var n=a.closest(".stepsWrapper").width();r.c.find(".step").width(n),o.width(n*_.toArray(d).length);n="-"+i(u)*n+"px";o.css("margin-left",n),a.closest(".step").addClass("active"),t&&t(e)})},panel:function(e,n){w.shell({name:"panel",el:r.panel,data:{step:e}},function(e){n&&n(e.el)})},captcha:function(e,n){w.shell({name:"captcha",el:e,data:{captcha:d.captcha.current}},function(e){n&&n(e.el)})},email:function(e,n){w.shell({name:"email",el:e,data:{}},function(e){n&&n(e.el)})},welcome:function(e,n){w.shell({name:"welcome",el:e,data:{}},function(e){n&&n(e.el)})},moneyfail:function(e,n){w.shell({name:"moneyfail",el:e,data:{}},function(e){n&&n(e.el)})},network:function(e,n){w.shell({name:"network",el:e,data:{}},function(e){n&&n(e.el)})},money:function(e,n){w.shell({name:"money",el:e,data:{}},function(e){n&&n(e.el)})},settings:function(t,a,e){w.nav.api.load({open:!0,id:"test",el:t,essenseData:{wizard:!0,panel:r.panel,success:function(){k.next()}},clbk:function(e,n){o=n,a&&a(t)}})}},y=function(){};return{primary:e,getdata:function(n,e){f=p=!1,a=e.settings.essenseData||{},u=null;var t={steps:d};w.app.user.validate()?w.app.nav.api.load({open:!0,href:"index",history:!0}):w.app.errors.connection()?w.app.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):w.fastTemplate("panel",function(e){n(t)})},destroy:function(){window.removeEventListener("resize",v),o&&o.destroy(),o=null,r={},$("html").removeClass("fillinguser")},init:function(e){y(),(r={}).c=e.el.find("#"+w.map.id),r.panel=r.c.find(".panelWrapper"),window.addEventListener("resize",v),n=e,k.next(),(s=r.c.closest(".wndcontent")).length||(s=null),$("html").addClass("fillinguser"),e.clbk(null,e)}}}var w=new nModule,a={};return w.run=function(e){var n=w.addEssense(a,t,e);w.init(n,e)},w.stop=function(){_.each(a,function(e){e.destroy()})},w}();"undefined"!=typeof module?module.exports=filluser:(app.modules.filluser={},app.modules.filluser.module=filluser);
 /*_____*/ 
var anothersite=function(){function t(n){var n=deep(n,"history"),e=function(){};return{primary:n,getdata:function(n,e){n({link:e.settings.essenseData.link})},destroy:function(){0},init:function(n){e(),{}.c=n.el.find("#"+i.map.id),n.clbk(null,n)},wnd:{header:"Another site",class:"transparent small anothersite"}}}var i=new nModule,o={};return i.run=function(n){var e=i.addEssense(o,t,n);i.init(e,n)},i.stop=function(){_.each(o,function(n){n.destroy()})},i}();"undefined"!=typeof module?module.exports=anothersite:(app.modules.anothersite={},app.modules.anothersite.module=anothersite);
 /*_____*/ 
var test=function(){function n(e){var t,o,d,n,a=deep(e,"history"),r=!1,i={language:h.app.localization.key||"en"},p={saveemail:function(e,n){var a,s={Email:e};s.Action||(s.Action="ADDTOMAILLIST"),s.TemplateID="1005",s.ref="",a=function(e){var a="";e&&(s.ref+=e,a+='<p><a href="https://bastyon.com/author?address='+h.app.ref+'">Referrer: '+e+"</a></p>");e=deep(document,"referrer");e&&(a+='<p><a href="'+e+'">From: '+e+"</a></p>"),s.body=encodeURIComponent(a),$.ajax({type:"POST",url:"https://bastyon.com/Shop/AJAXMain.aspx",data:s,dataType:"json",success:function(){n&&n()}})},h.app.ref?h.sdk.users.get(h.app.ref,function(){var e=deep(h,"sdk.users.storage."+h.app.ref+".name");a&&a(e)}):a&&a(null)},valid:function(e,a){if(!p.equal(e,a)&&trim(e.name)&&e.image)return!0},equal:function(e,a){function n(e){return"name:"+(trim(e.name)||"")+"image:"+(e.image||"")+"about:"+(trim(e.about)||"")+"site:"+(trim(e.site)||"")+"language:"+(e.language||"")+"addresses:"+JSON.stringify(e.addresses||[])}return n(e)==n(a)},cancel:function(){p.userOptions(),p.upanel(),v.icon(),v.options()},ref:function(e){d&&r&&(localStorage[h.app.platform.sdk.address.pnet().address+"subscribeRef"]=d.address)},save:function(e){function r(){t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100),a?h.nav.api.go({href:"index",history:!0,open:!0}):o.success?o.success():e&&e()}h.sdk.users.checkFreeRef(h.app.platform.sdk.address.pnet()?h.app.platform.sdk.address.pnet().address:"",function(n,e){if(!t.c.find(".userPanel").hasClass("loading"))if(p.equal(i,h.app.platform.sdk.user.storage.me))sitemessage(h.app.localization.e("uchanges"));else{if(!p.valid(i,h.app.platform.sdk.user.storage.me))return sitemessage(h.app.localization.e("uchangesvalid")),void(trim(i.name)?i.image||(s=t.c.find(".fileUploader"),_scrollTo(s)):((s=t.c.find('[parameter="name"] input')).focus(),_scrollTo(s)));var a=new UserInfo;a.name.set(trim(i.name)),a.language.set(i.language),a.about.set(trim(i.about)),a.site.set(trim(i.site)),a.image.set(i.image),a.addresses.set(i.addresses),a.ref.set(deep(d,"address")||"");var s,e=a.validation();if(e)return t.c.find(".errorname").fadeIn(),"namelength"==e&&t.c.find(".errorname span").html("The name length can be more than 20 symbols"),"pocketnet"==e&&t.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved"),(s=t.c.find('[parameter="name"] input')).focus(),_scrollTo(s),!1;topPreloader(30),t.c.find(".userPanel").addClass("loading"),t.upanel.addClass("loading"),h.app.platform.sdk.users.nameExist(a.name.v,function(e){!e||h.app.platform.sdk.address.pnet()&&e==h.app.platform.sdk.address.pnet().address?(topPreloader(50),o.presave(function(){t.c.find(".errorname").fadeOut(),topPreloader(70),a.uploadImage(function(){if(o.makeuser)return topPreloader(100),t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),void o.makeuser(a);var e=i.email;e&&p.saveemail(e),h.sdk.node.transactions.create.commonFromUnspent(a,function(e,a){e?(successCheck(),delete h.sdk.usersl.storage[h.app.platform.sdk.address.pnet().address],delete h.sdk.users.storage[h.app.platform.sdk.address.pnet().address],h.app.platform.sdk.user.storage.me=e,i=_.clone(h.app.platform.sdk.user.storage.me),p.upanel(),p.ref(n),h.app.platform.sdk.users.getone(h.app.platform.sdk.address.pnet().address,function(){h.app.reloadModules(function(){o.presuccess?o.presuccess(r):r()})})):(h.app.platform.errorHandler(a,!0),t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100))},{relay:!!o.relay&&o.relay()})})})):(t.upanel.removeClass("loading"),t.c.find(".userPanel").removeClass("loading"),topPreloader(100),t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("This username is taken in Pocketnet"))})}})},upload:function(e,s){topPreloader(20);var a=[{original:e.base64,index:0}];h.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:0,images:a,apply:!0,crop:{aspectRatio:1,style:"round apply",autoCropArea:.9},success:function(e,n){a[0].original,resize(a[0].original,100,100,function(e){var a=e.split(",");n(),a[1]?(i.image=e,v.icon(),p.upanel(),s&&s()):topPreloader(100)})}}})},upanel:function(){t.upanel&&(0<_.toArray(h.app.platform.sdk.node.transactions.temp.userInfo||{}).length||h.app.platform.sdk.address.pnet()&&0<deep(h.sdk.relayTransactions.storage,h.app.platform.sdk.address.pnet().address+".userInfo.length")?(t.upanel.addClass("wait"),t.c.find(".caption").remove()):(t.upanel.removeClass("wait"),p.equal(i,h.app.platform.sdk.user.storage.me)||!p.valid(i,h.app.platform.sdk.user.storage.me)?t.upanel.removeClass("changes"):t.upanel.addClass("changes")))},clear:function(){p.userOptions(),v.caption()},userOptions:function(){i=_.clone(h.app.platform.sdk.user.storage.me),_.each(l,function(a,n){var e=h.app.platform.sdk.user.storage.me[a.id];"addresses"==n&&(e=_.clone(h.app.platform.sdk.user.storage.me[a.id])),a.value=e||a.defaultValue||"",i[a.id]=a.value,a._onChange=function(e){if(i[a.id]="addresses"==n?_.clone(e):trim(e),p.upanel(),"language"!=n||(e=h.app.localization.available[e])&&e.key!=h.app.localization.key&&h.app.localization.lightSet(e.key),"name"==n){if(-1<i[a.id].toLowerCase().replace(/[^a-z]/g,"").indexOf("pocketnet"))return t.c.find(".errorname").fadeIn(),void t.c.find(".errorname span").html("To avoid user confusion using Pocketnet in name is reserved");20<i[a.id].length?(t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("The name length can be more than 20 symbols")):h.app.platform.sdk.users.nameExist(i[a.id],function(e){!e||h.app.platform.sdk.address.pnet()&&e==h.app.platform.sdk.address.pnet().address?t.c.find(".errorname").fadeOut():(t.c.find(".errorname").fadeIn(),t.c.find(".errorname span").html("This username is taken in Pocketnet"))})}}})},signout:function(){h.app.user.signout(),h.app.reload({href:"authorization"})}},l={name:new Parameter({name:h.app.localization.e("unickname"),id:"name",type:"NICKNAME",require:!0}),email:new Parameter({name:"Email",id:"email",type:"EMAIL",onType:!0}),language:new Parameter({name:h.app.localization.e("ulanguage"),id:"language",type:"VALUES",defaultValue:h.app.localization.key||"en",possibleValues:["en","ru"],possibleValuesLabels:["English","Русский"]}),about:new Parameter({name:h.app.localization.e("uabout"),id:"about",type:"TEXT",onType:!0,placeholder:h.app.localization.e("e13351")}),site:new Parameter({name:h.app.localization.e("uwebsite"),id:"site",type:"STRINGANY",onType:!0,value:""}),addresses:new function(){var n=this;return n.id="addresses",n.name=h.app.localization.e("uaddresesd"),n.value=[],n.defaultValue=[],n.remove=function(e,a){removeEqual(n.value,{currency:e,address:a}),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.add=function(e){n.value.push(e),n._onChange&&n._onChange(n.value),n.addedAddresses()},n.addDialog=function(){function r(e,a){return 0<a.length}y.fastTemplate("addaddress",function(e){dialog({html:e,wrap:!0,success:function(e){var a=e.el.find(".currency").val(),e=e.el.find(".address").val();if(r(0,e))return n.add({currency:a,address:e}),!0},clbk:function(e){var a=e.find(".currency"),n=e.find(".address"),s=e.find(".btn1"),e=function(){a.val();var e=n.val();return r(0,e)?(s.removeClass("disabled"),!0):(s.addClass("disabled"),!1)};n.focus(),n.on("change",e),n.on("keyup",e),a.on("change",e),a.on("keyup",e),e()},class:"one addaddressDialog zindex"})},{})},n.removeEvent=function(){var e=$(this).closest(".addedAddress").attr("currency"),a=$(this).closest(".addedAddress").attr("address");n.remove(e,a)},n.addedAddresses=function(){var a="";_.each(n.value,function(e){e&&e.currency&&(a+='<div class="addedAddressWrapper">',a+='<div class="addedAddress table" currency="'+e.currency+'" address="'+e.address+'">',a+='<div class="currencyWrapper">',a+=e.currency.toUpperCase(),a+="</div>",a+='<div class="addressWrapper">',a+=e.address,a+="</div>",a+='<div class="panelWrapper">',a+='<div class="item remove">',a+='<i class="far fa-times-circle"></i>',a+="</div>",a+="</div>",a+="</div>",a+="</div>")}),n.el.find(".addedAddressesWrapper").html(a),n.el.find(".addedAddressesWrapper .remove").on("click",n.removeEvent)},n.init=function(e){n.defaultValue=[],n.el=e.find(".adressesInput"),n.addedAddresses(),n.el.find(".addaddress").on("click",n.addDialog)},n.input=function(){return'<div class="adressesInput"><div class="addaddressWrapper"><div class="addaddress"><i class="fas fa-plus"></i></div></div><div class="addedAddressesWrapper"></div></div>'},n}},s=function(){p.signout()},u=function(){p.save()},c=function(){p.cancel()},f=function(){var e=h.app.platform.sdk.address.pnet();topPreloader(30),h.app.platform.sdk.node.account.import(e.address,function(){topPreloader(100),sitemessage("Address "+e.address+" was successfully imported")})},m=null,g=null,v={options:function(a){h.shell({name:"options",el:t.options,data:{tempInfo:i,userOptions:l}},function(e){ParametersLive(_.toArray(l),e.el),l.addresses.init(e.el),a&&a()})},icon:function(a){h.shell({name:"icon",el:t.icon,data:{tempInfo:i,ed:o}},function(e){initUpload({el:e.el.find(".pgroup"),ext:["png","jpeg","jpg"],dropZone:t.c,multiple:!1,action:function(e,a){p.upload(e,function(){n&&n.destroy(),_scrollTo(t.c.find(".nickname input").focus()),a&&a()})}}),o.wizard&&!i.image&&(n=h.app.platform.api.plissing({el:e.el.find(".iconWrapper"),text:"Upload Profile Image"})),a&&a()})},unspent:function(e,a){h.shell({name:"unspent",el:t.unspent,data:{unspent:e}},function(e){a&&a()})},caption:function(e,a){},address:function(){t.c.find(".adr").html(bitcoin.payments[h.app.platform.addressType]({pubkey:h.app.user.key.value}))}},k=function(){};return{primary:a,getdata:function(s,e){d=null,(o=e.settings.essenseData||{}).presave||(o.presave=function(e){e&&e()}),h.app.platform.sdk.user.get(function(){var e,a;_.isEmpty(h.app.platform.sdk.user.storage.me)&&(r=!0,(a=h.app.ref)&&a!=h.app.platform.sdk.address.pnet()&&(d=a)),e=_.map(h.app.platform.nodes,function(e,a){return a.toString()}),a=_.map(h.app.platform.nodes,function(e,a){return e.full}),(m=new Parameter({type:"VALUES",name:"setNode",id:"setNode",possibleValues:e,possibleValuesLabels:a,defaultValue:"1"})).value=h.app.platform.nodeid,m._onChange=function(e){h.app.platform.nodeid=e,h.app.platform.state.save()},(g=new Parameter({type:"VALUES",name:"setAddressType",id:"setAddressType",possibleValues:h.app.platform.addressTypes,possibleValuesLabels:["P2PKH","P2SH"],defaultValue:"p2sh"})).value=h.app.platform.addressType,g._onChange=function(e){h.app.platform.addressType=e,h.app.platform.state.save(),h.user.address.set(h.app.platform.sdk.address.pnet().address),h.app.reload()},p.userOptions();var n={};n.p2pkh=h.app.platform.sdk.address.pnet(),n.setNode=m,n.setAddressType=g,n.userOptions=l,n.tempInfo=i,n.firstTime=r,n.ref=d,n.caption=o.caption,d?h.sdk.users.get(d,function(){var e=d;(d=h.sdk.users.storage[e]||null)&&(d.address=e),n.ref=d,s(n)}):s(n)})},destroy:function(){return t={},h.app.platform.sdk.user.storage.me&&!p.equal(i,h.app.platform.sdk.user.storage.me)?function(e){function a(){delete h.app.platform.ws.messages.transaction.clbks.utemp,e()}dialog({html:h.app.localization.e("usavechanges"),btn1text:h.app.localization.e("dyes"),btn2text:h.app.localization.e("dno"),success:function(){p.save(a)},fail:function(){i=_.clone(h.app.platform.sdk.user.storage.me),a()}})}:null},init:function(e){k(),(t={}).c=e.el.find("#"+h.map.id),t.transaction=e.el.find(".transactionInfo"),t.unspent=e.el.find(".unspentlist"),t.showhidetestpanel=e.el.find(".showhidetestpanel"),t.import=e.el.find(".import"),t.caption=t.c.find(".bgCaption"),t.icon=t.c.find(".pgroupIconWrapper"),t.usericon=t.c.find(".usericon"),t.options=t.c.find(".optionsParameters"),t.upanel=o.panel||t.c.find(".upanel"),t.signout=t.c.find(".signout"),t.import.on("click",f),t.showhidetestpanel.on("click",function(){$(this).closest(".testPanel").toggleClass("active")}),t.upanel.find(".cancel").on("click",c),t.upanel.find(".save").on("click",u),ParametersLive([m,g],t.c),t.signout.on("click",s),t.c.find(".refRemove").on("click",function(){d=null,delete localStorage.ref,t.c.find(".referalMaketWrapper").remove()}),p.upanel(),v.caption(),v.icon(),v.options(),h.sdk.node.transactions.get.unspent(function(e){v.unspent(e)}),h.app.platform.ws.messages.transaction.clbks.utemp=function(e){e.temp&&"userInfo"==e.temp.type&&p.upanel()},e.clbk(null,e)},wnd:{class:"withoutButtons allscreen testwindow"}}}var h=new nModule,y=h,s={};return h.run=function(e){var a=h.addEssense(s,n,e);h.init(a,e)},h.stop=function(){var a=null;if(_.each(s,function(e){e=e.destroy();e&&(a=e)}),a)return{action:a}},h}();"undefined"!=typeof module?module.exports=test:(app.modules.test={},app.modules.test.module=test);
 /*_____*/ 
var tagcloud=function(){function a(n){var a,n=deep(n,"history"),o=function(n,t){n.length?(a.c.removeClass("hidden"),d.shell({name:"tags",el:a.tags,data:{tags:n}},function(n){n.el.find(".showhidealltags").on("click",function(){a.c.toggleClass("showedalltags")}),t&&t()})):a.c.addClass("hidden")},t=function(){},e=function(){var a;a=function(n,t){t&&(d.iclbks.main=e),o(n)},d.app.platform.sdk.tags.cloud(function(n,t){n=d.app.platform.sdk.tags.filterEx(n),a&&a(n,t)})};return{primary:n,getdata:function(n){n({})},destroy:function(){delete d.iclbks.main,a={}},init:function(n){t(),(a={}).c=n.el.find("#"+d.map.id),a.tags=a.c.find(".tags"),e(),n.clbk(null,n)}}}var d=new nModule,o={};return d.run=function(n){var t=d.addEssense(o,a,n);d.init(t,n)},d.stop=function(){_.each(o,function(n){n.destroy()})},d}();"undefined"!=typeof module?module.exports=tagcloud:(app.modules.tagcloud={},app.modules.tagcloud.module=tagcloud);
 /*_____*/ 
var accounts=function(){function n(e){var s,o,t,d,e=deep(e,"history"),a=function(t){k.app.platform.sdk.pool.expand(o,function(e){var a,n,s=_.indexOf(e.addresses,t);-1<s&&(a=e.private[s],n=k.app.user.stay,k.app.user.signout(function(){k.app.user.stay=n,k.user.signin(a,function(e){k.app.reloadLight(function(){var e="userpage?id=accounts&s="+makeid(),a=!1;k.app.user.validate()||(e="filluser",a=!0),k.app.nav.api.load({open:!0,href:e,history:a})})})}))})},i=function(n){k.app.platform.sdk.pool.expand(o,function(e){var a=_.indexOf(e.addresses,n);-1<a&&(a=e.private[a],f.dumpkey(n,a))})},n=function(e){k.app.platform.sdk.pool.remove(o,e),k.app.platform.sdk.pool.save(),f.addresses()},p=function(){5<=deep(o,"addresses.length")?sitemessage("You have reached a maximum of 5 accounts. No more can be added "):k.app.nav.api.load({open:!0,id:"addaccount",inWnd:!0,essenseData:{success:function(a){k.app.platform.sdk.pool.expand(o,function(e){k.app.platform.sdk.pool.add(e,a,function(e,a){a?dialog({html:k.app.localization.e("aused"),class:"one"}):k.app.platform.sdk.pool.export(e,function(e){k.app.platform.sdk.pool.current.packs[t]=e,k.app.platform.sdk.pool.save(),o=e,k.app.platform.sdk.pool.info(e,function(){f.addresses()})})})})}}})},c=function(){s.dumpkey.html(""),s.c.find(".dumpaddress").html(""),s.c.removeClass("privatedump")},r=function(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to see your private key?",btn1text:"See Private Key",btn2text:"Cancel",class:"zindex",success:function(){i(e)}})},l=function(){var e=$(this).closest(".addressTable").attr("address");dialog({html:"Do you really want to remove this address from this device?",btn1text:"Remove",btn2text:"Cancel",class:"zindex",success:function(){n(e)}})},u=function(){var e=$(this).closest(".addressTable").attr("address");a(e)},f={qrcode:function(e,a){new QRCode(e[0],{text:a,width:256,height:256})},dumpkeyabout:function(){},dumpkey:function(e,a){var n="";s.c.addClass("privatedump"),s.c.find(".dumpaddress").html(e);try{n=bitcoin.ECPair.fromPrivateKey(Buffer.from(a,"hex")).toWIF().toString("hex")}catch(e){}k.shell({name:"dumpkey",el:s.dumpkey,data:{private:a,address:e,privateWif:n},animation:"fadeIn"},function(e){f.qrcode(e.el.find(".code"),a),e.el.find(".copyvalue").on("click",function(){var e=$(this).closest(".infotable").find(".value");copyText(e),sitemessage("Value was successfully copied")})})},addresses:function(a){k.shell({name:"addresses",el:s.addresses,data:{current:k.app.platform.sdk.address.pnet().address,pack:o},animation:"fadeIn"},function(e){e.el.find(".remove").on("click",l),e.el.find(".dumpkey").on("click",r),e.el.find(".ncurrent .label").on("click",u),a&&a()})}},m=function(){};return{primary:e,getdata:function(e,a){d=deep(a,"settings.essenseData")||{},t=o=null;e({})},destroy:function(){s={}},init:function(e){var a,n;m(),(s={}).c=e.el.find("#"+k.map.id),s.addresses=s.c.find(".addresses"),s.dumpkey=s.c.find(".dumpkey"),s.c.find(".add").on("click",p),s.c.find(".back").on("click",c),a=k.app.platform.sdk.address.pnet().address,(n=k.app.platform.sdk.pool.getPack(a))?(o=n[0],t=n[1],k.app.platform.sdk.pool.info(o,function(){f.addresses(function(){d.dumpkey&&i(a)})})):sitemessage("ERROR"),e.clbk(null,e)}}}var k=new nModule,s={};return k.run=function(e){var a=k.addEssense(s,n,e);k.init(a,e)},k.stop=function(){_.each(s,function(e){e.destroy()})},k}();"undefined"!=typeof module?module.exports=accounts:(app.modules.accounts={},app.modules.accounts.module=accounts);
 /*_____*/ 
var filluserfast=function(){function t(e){function i(n){return _.findIndex(l,function(e){return e==n})}var s,t,a,e=deep(e,"history"),o={},r=null,c={settings:{id:"settings",nextindex:"captcha",prev:function(e){e()},render:"settings",after:function(e,n){},next:!0},captcha:{id:"captcha",render:"captcha",nextindex:"welcome",prev:function(t){var e=m.sdk.address.pnet().address;m.app.settings.get(e,"request")||""?p.next():d.check(function(e){e?p.next():m.sdk.captcha.get(function(e,n){n?p.to("network"):e.done?d.request(function(e){e&&p.next()}):(c.captcha.current=e,t())},!0)},!0)},after:function(e,n){var t,a=e.find(".ucaptchainput"),o=e.find(".redo"),i=e.find(".addCaptcha");a.focus();function s(e){return!!/^[a-zA-Z0-9]{4,}$/.test(e)}a.on("keyup",function(){t=$(this).val(),s(t)?i.removeClass("disabled"):i.addClass("disabled")}),i.on("click",function(){var e=a.val();s(e)&&m.sdk.captcha.make(e,function(e,n){return"captchashots"==e?(sitemessage(m.app.localization.e("e13118")),void p.redo()):void(e?sitemessage(m.app.localization.e("e13118")):n.done&&d.request(function(e){e&&p.next()}))},!0)}),o.one("click",function(){p.redo()})}},welcome:{id:"welcome",prev:function(e){m.app.platform.sdk.theme.set("black"),t.welcomepart&&t.welcomepart(),e()},render:"welcome",after:function(e){function n(){var e;"_this"==deep(t,"successHref")?((e=deep(a,"container.close"))&&e(),t.signInClbk&&t.signInClbk()):m.nav.api.go({href:"index?r=recommended",history:!0,open:!0}),m.app.platform.ui.showmykeyfast()}setTimeout(function(){n()},1500),e.find(".welcome").on("click",function(){n()})}},network:{id:"network",prev:function(e){e()},render:"network",after:function(e){m.app.errors.clbks.filluserfast=function(){app.errors.state.proxy||app.errors.state.proxymain||("network"!=r||m.app.platform.loadingWithErrors||p.to("captcha"),delete m.app.errors.clbks.filluserfast)}}},moneyfail:{id:"moneyfail",prev:function(e){e()},render:"moneyfail",after:function(n){function t(){m.app.platform.sdk.node.transactions.get.allBalance(function(e){n.find(".balance").html("Balance: "+m.app.platform.mp.coin(e)+" PKOIN")})}t(),n.find(".check").on("click",function(){topPreloader(20),m.app.platform.sdk.node.transactions.get.allBalance(function(e){topPreloader(100),0<e&&("moneyfail"==r&&p.to("settings"),delete m.app.platform.sdk.node.transactions.clbks.moneyfail),t()}),m.app.platform.sdk.node.transactions.clbks.moneyfail=function(){m.app.platform.sdk.node.transactions.get.allBalance(function(e){0<e&&("moneyfail"==r&&p.to("welcome"),delete m.app.platform.sdk.node.transactions.clbks.moneyfail)})}})}}},l=_.map(c,function(e,n){return n}),d={request:function(o){m.sdk.users.requestFreeMoney(function(e,n){var t=m.sdk.address.pnet().address,a=m.app.settings.get(t,"request")||"";e||a?(m.app.settings.set(t,"request","true"),m.sdk.registrations.add(t,3),o&&o(!0)):("captcha"==n&&("money"!=r&&"captcha"!=r||p.to("captcha")),"error"==n&&("money"!=r&&"captcha"!=r||p.to("moneyfail")),o&&o(!1,"err"))})},check:function(n,e){m.app.platform.sdk.node.transactions.get.allBalance(function(e){n&&n(0<e)},e)},follow:function(){m.app.platform.sdk.node.transactions.clbks.filluser||(m.app.platform.sdk.node.transactions.clbks.filluser=function(){delete m.app.platform.sdk.node.transactions.clbks.filluser,d.check(function(e){e?"money"==r&&p.next():d.follow()})})}},p={preloader:function(e){e?s.c.addClass("loading"):s.c.removeClass("loading")},signin:function(n){m.user.signin(o.mnemonicKey,function(e){n&&n()})},to:function(e,n){r=e,p.makeStep(n)},redo:function(e){p.makeStep(function(){})},next:function(e){var n;(r=r?c[r].nextindex:((n=deep(app,"platform.sdk.user.storage.me"))&&n.relay?c.captcha:c.settings).id)&&p.makeStep(function(){})},makeStep:function(e){var t=c[r];t&&(p.preloader(!0),t.prev(function(){s.c&&(s.c.attr("step",t.id),f.panel(t,function(n){f.step(t,function(e){p.preloader(!1),_scrollTop(e,scrollel),n.find(".elpanel").addClass("active"),t.after(e,n)})}))}))},testqrcodeandkey:function(e,n){e=m.app.user.keysFromMnemo(trim(e)).privateKey.toString("hex"),e=f.qrcode(s.c.find(".hiddenqrcode"),e)._oDrawing._oContext.canvas.toDataURL("image/jpeg");grayscaleImage(e,function(e){qrscanner.q.callback=function(e){"error decoding QR Code"==e?n&&n(!1):n&&n(!0)},qrscanner.q.decode(e)})},generate:function(n){var t;o.mnemonicKey?n&&n():(t=bitcoin.bip39.generateMnemonic(),p.testqrcodeandkey(t,function(e){e?(o.mnemonicKey=t,o.mnemonicMask=_.shuffle(indexArray(o.mnemonicKey.length)),o.mnemonicContent=o.mnemonicKey.split(" "),e=m.app.user.keysFromMnemo(o.mnemonicKey),o.mainAddress=app.platform.sdk.address.pnetsimple(e.publicKey).address,o.mk=e.privateKey.toString("hex"),n&&n()):p.generate()}))},waitgeneration:function(e){retry(function(){if(o.mnemonicKey)return!0},e,40)}},n=function(){var e,n;r&&(e=c[r],n=s.c.find('.step[step="'+e.id+'"] .stepBody').closest(".step"),e=s.c.find(".stepsWrapperLine"),n=n.closest(".stepsWrapper").width(),s.c.find(".step").width(n),e.css("margin-left","-"+i(r)*n+"px"),e.width(n*_.toArray(c).length))},f={qrcode:function(e,n){return new QRCode(e[0],{text:n,width:256,height:256})},step:function(e,t){s.c.find(".step").removeClass("active");var n=s.c.find('.step[step="'+e.id+'"] .stepBody'),a=n.closest(".step"),o=s.c.find(".stepsWrapperLine");f[e.render](n,function(e){var n=a.closest(".stepsWrapper").width();s.c.find(".step").width(n),o.width(n*_.toArray(c).length);n="-"+i(r)*n+"px";o.css("margin-left",n),a.closest(".step").addClass("active"),t&&t(e)})},panel:function(e,n){m.shell({name:"panel",el:s.panel,turi:"filluser",data:{step:e}},function(e){n&&n(e.el)})},captcha:function(e,n){m.shell({name:"captcha",el:e,turi:"filluser",data:{captcha:c.captcha.current}},function(e){n&&n(e.el)})},email:function(e,n){m.shell({name:"email",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},welcome:function(e,n){m.shell({name:"welcome",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},moneyfail:function(e,n){m.shell({name:"moneyfail",turi:"filluser",el:e,data:{}},function(e){n&&n(e.el)})},network:function(e,n){m.shell({name:"network",el:e,turi:"filluser",data:{}},function(e){n&&n(e.el)})},money:function(e,n){m.shell({name:"money",el:e,data:{}},function(e){n&&n(e.el)})},settings:function(t,a,e){m.nav.api.load({open:!0,id:"test",el:t,essenseData:{wizard:!0,panel:s.panel,presave:function(e){p.waitgeneration(function(){p.signin(function(){m.sdk.registrations.add(o.mainAddress,1),e&&e()})})},relay:function(){return o.mainAddress},success:function(e){o.info=e,m.sdk.registrations.add(o.mainAddress,2),u.save(),p.next()}},clbk:function(e,n){ext=n,a&&a(t)}})}},u={save:function(){},load:function(){}};return{primary:e,getdata:function(e,n){n.state&&"fuf"!=m.user.validateVay()?m.app.nav.api.load({open:!0,href:"index",history:!0}):(0,t=deep(n,"settings.essenseData")||{},r=null,e({steps:c,inauth:deep(n,"settings.essenseData.inauth")||!1}))},destroy:function(){window.removeEventListener("resize",n),delete m.app.platform.sdk.node.transactions.clbks.moneyfail,delete m.app.errors.clbks.filluserfast,delete m.app.platform.sdk.node.transactions.clbks.filluser,s={}},init:function(e){u.load(),(s={}).c=e.el.find("#"+m.map.id),s.panel=s.c.find(".panelWrapper"),a=e,scrollel=s.c.closest(".wndcontent"),scrollel.length||(scrollel=null),window.addEventListener("resize",n),m.app.user.isState(function(e){e?(o={}).mainAddress=m.app.user.address.value:setTimeout(function(){p.generate(function(){})},1e3),p.next()}),e.clbk(null,e)}}}var m=new nModule,a={};return m.run=function(e){var n=m.addEssense(a,t,e);m.init(n,e)},m.stop=function(){_.each(a,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=filluserfast:(app.modules.filluserfast={},app.modules.filluserfast.module=filluserfast);
 /*_____*/ 
var lastcomments=function(){function s(n){var s,n=deep(n,"history"),e=function(n,t,s){l.app.platform.app.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,clbk:function(n,t){app.nav.wnds.post=t},essenseData:{share:n,hr:"index?",reply:{answerid:t,parentid:s||"",noaction:!0}}})},t=function(){var n=$(this).attr("id"),t=$(this).attr("pid"),s=$(this).closest(".commentgroup").attr("share");e(s,n,t)},o=function(n){l.shell({name:"lastcommentslist",el:s.c,data:{comments:n}},function(n){n.el.find(".comment").on("click",t),n.el.find(".image").imagesLoaded({background:!0},function(n){})})},a=function(){},i=function(){var c;c=function(n,t){return t?(l.iclbks.main=i,void s.c.addClass("hidden")):(s.c.removeClass("hidden"),void o(n))},l.app.platform.sdk.comments.last(function(t,o){var a=group(t,function(n){return n.txid}),n=_.map(a,function(n,t){return t});l.app.platform.sdk.node.shares.getbyid(n,function(n,s){var e=[];_.each(t,function(n){var t=app.platform.sdk.node.shares.storage.trx[n.txid];t&&n&&(e.push(t.address),e.push(n.address))}),e=_.uniq(e),l.sdk.users.get(e,function(n,t){c&&c(a,o||s||t)},!0)})})};return{primary:n,getdata:function(n){n({})},destroy:function(){s={},delete l.app.platform.ws.messages.newblocks.clbks.lastcomments,delete l.app.platform.ws.messages["new block"].clbks.lastcomments,delete l.app.platform.clbks._focus.lastcomments},init:function(n){a(),(s={}).c=n.el.find("#"+l.map.id),l.app.platform.ws.messages.newblocks.clbks.lastcomments=l.app.platform.ws.messages["new block"].clbks.lastcomments=function(){i()},l.app.platform.clbks._focus.lastcomments=function(n){120<n&&"undefined"!=typeof _Electron&&i()},i(),n.clbk(null,n)}}}var l=new nModule,e={};return l.run=function(n){var t=l.addEssense(e,s,n);l.init(t,n)},l.stop=function(){_.each(e,function(n){n.destroy()})},l}();"undefined"!=typeof module?module.exports=lastcomments:(app.modules.lastcomments={},app.modules.lastcomments.module=lastcomments);
 /*_____*/ 
var usersettings=function(){function r(e){var t,a,e=deep(e,"history"),s={options:function(){l.shell({name:"options",el:t.options,data:{composed:a.c,themes:l.app.platform.sdk.theme.all,current:l.app.platform.sdk.theme.current}},function(r){ParametersLive(a.o,r.el),r.el.find(".themewrapper").on("click",function(){var e,t=$(this);t.hasClass("active")||(e=t.attr("theme"),r.el.find(".themewrapper").removeClass("active"),t.addClass("active"),l.app.platform.sdk.theme.set(e))});var e=r.el.find(".parameterMaketWrapper[parameter=telegram] input");e.on("blur",function(){s.options()});e=e.val();l.app.platform.sdk.system.get.telegramGetMe(e,!0,n,o)})}},r=function(){},n=function(){s.options()},o=function(e){var t=(e,t)=>{const r=document.createElement("div");r.classList.add("iWrapper");const a=document.createElement("i"),s=document.querySelector("div[parameter='telegram']");r.classList.add("iWrapper"),s&&(s.setAttribute("style","display: flex"),r.setAttribute("style",`color:${t}; display:inline-block; font-size:30px; padding: 5px; margin-left: 1em`),a.classList.add("fa"),a.classList.add(e),r.appendChild(a),s.appendChild(r))};e?t("fa-check-circle","green"):t("fa-times","red")};return{primary:e,getdata:function(e){a=l.app.platform.sdk.usersettings.compose(n);e({})},destroy:function(){t={},l.app.user.features.telegram&&(controller.abort(),controller=new AbortController,l.app.platform.sdk.system.get.telegramUpdates())},init:function(e){r(),(t={}).c=e.el.find("#"+l.map.id),t.options=t.c.find(".options"),controller=l.app.platform.sdk.system.get.telegramUpdateAbort,controller.abort(),l.app.platform.sdk.system.get.telegramUpdateAbort=new AbortController,n(),e.clbk(null,e)}}}var l=new nModule,a={};return l.run=function(e){var t=l.addEssense(a,r,e);l.init(t,e)},l.stop=function(){_.each(a,function(e){e.destroy()})},l}();"undefined"!=typeof module?module.exports=usersettings:(app.modules.usersettings={},app.modules.usersettings.module=usersettings);
 /*_____*/ 
var uploadpeertube=function(){function o(e){var l,e=deep(e,"history"),n={},r=function(){};return{primary:e,getdata:function(e,r){s=r.settings.essenseData,n=s.actions;e({})},destroy:function(){l={}},init:function(e){r(),(l={}).c=e.el.find("#"+d.map.id),l.videoInput=l.c.find(".upload-video-file"),l.videoWallpaper=l.c.find(".upload-video-wallpaper"),l.videoError=l.c.find(".file-type-error"),l.wallpaperError=l.c.find(".wallpaper-type-error"),l.uploadProgress=l.c.find(".upload-progress-container"),l.videoInput.change(function(e){e=e.target.files[0].name;l.videoError.text(e.slice(0,20)+(20<e.length?"...":"")),l.videoError.removeClass("error-message")}),l.videoWallpaper.change(function(e){e=e.target.files[0].name;l.wallpaperError.text(e.slice(0,20)+(20<e.length?"...":"")),l.wallpaperError.removeClass("error-message")}),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fas fa-upload"></i> Upload',fn:function(e,o){var r=l.videoInput.prop("files"),a=l.videoWallpaper.prop("files"),s=e.find(".upload-video-name").val(),i=e.find(".name-type-error");i.text("");e={};if(!r[0])return l.videoError.text("No video selected"),void l.videoError.addClass("error-message");if(!r[0].type.includes("video"))return l.videoError.text("Incorrect video format"),void l.videoError.addClass("error-message");if(e.video=r[0],a[0]){if(console.log(a[0].type),"image/jpeg"!==a[0].type&&"image/jpg"!==a[0].type)return l.wallpaperError.text("Incorrect wallpaper format. Supported: .jpg, .jpeg"),void l.wallpaperError.addClass("error-message");e.image=a[0]}s?(e.name=s,e.uploadFunction=function(e){e=e.toFixed(2);l.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),l.uploadProgress.find(".upload-progress-percentage").text(e+"%")},e.successFunction=function(e){if(e.error){var r=deep(e,"error.responseJSON.errors")||{},r=(Object.values(r)[0]||{}).msg;return sitemessage(r||"Uploading error"),void o.close()}n.added(e),o.close()},o.hide(),l.uploadProgress.removeClass("hidden"),d.app.peertubeHandler.uploadVideo(e)):i.text("Name is empty")}}},close:function(){s.closeClbk&&s.closeClbk()},success:function(e,r){wndObj=r,wnd=e},offScroll:!0,noInnerScroll:!0,class:"uploadpeertube",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var d=new nModule,a={},s={};return d.run=function(e){var r=d.addEssense(a,o,e);d.init(r,e)},d.stop=function(){_.each(a,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=uploadpeertube:(app.modules.uploadpeertube={},app.modules.uploadpeertube.module=uploadpeertube);
 /*_____*/ 
var esystem=function(){function n(e){var o,e=deep(e,"history"),i={nodeControl:function(e){var t,n=null;s.sdk.esystem.tickstate&&(t=deep(s,"sdk.esystem.tickstate.settings.node"),n=s.sdk.esystem.node.settings.compose(t)),i.options(n,o.nodecontrolcnt,function(n){n.el.find('input[pid="Enable"]').on("change",function(e){e.target.checked?dialog({html:s.app.localization.e("nodeEnableNote"),header:s.app.localization.e("nodeEnableNoteHeader"),btn1text:s.app.localization.e("daccept"),btn2text:s.app.localization.e("dcancel"),success:function(){s.sdk.esystem.request("node.enable",{v:e.target.checked},function(e){})},fail:function(){}}):s.sdk.esystem.request("node.enable",{v:e.target.checked},function(e){})}),n.el.find('button[pid="binPath_Selector"]').on("click",function(e){s.sdk.esystem.request("node.setBinPath",{},function(e,t){n.el.find('input[pid="binPath"]').prop("value",t)})}),n.el.find('button[pid="dataPath_Selector"]').on("click",function(e){s.sdk.esystem.request("node.setDataPath",{},function(e,t){n.el.find('input[pid="dataPath"]').prop("value",t)})}),n.el.find('button[pid="confPath_Selector"]').on("click",function(e){s.sdk.esystem.request("node.setConfPath",{},function(e,t){n.el.find('input[pid="confPath"]').prop("value",t)})}),n.el.find('button[pid="setPrivateKey"]').on("click",function(e){e.preventDefault(),dialog({html:s.app.localization.e("nodeWalletAdd"),btn1text:s.app.localization.e("dyes"),btn2text:s.app.localization.e("dno"),success:function(){var e=bitcoin.ECPair.fromPrivateKey(s.app.user.private.value).toWIF();s.sdk.esystem.request("node.setWallet",{private:e},function(e,t){e&&dialog({html:t,header:s.app.localization.e("error"),btn1text:s.app.localization.e("daccept"),class:"one"})})},fail:function(){}})})})},proxyOptions:function(e){var t=null;s.sdk.esystem.tickstate&&(t=s.sdk.esystem.proxy.settings.compose(deep(s,"sdk.esystem.tickstate.settings"))),i.options(t,o.proxyoptions,e)},options:function(t,e,n){s.shell({name:"options",el:e,data:{composed:t}},function(e){ParametersLive(t.o,e.el),n&&n(e)})},download:function(){o.downloadElectron.length&&s.nav.api.load({open:!0,id:"applications",el:o.downloadElectron,eid:"applications_ui",essenseData:{},clbk:function(e,t){o.c}})}},t=function(){};return{primary:e,getdata:function(e){e({})},destroy:function(){delete s.sdk.esystem.clbks.tick.esystem,o={}},init:function(e){t(),(o={}).c=e.el.find("#"+s.map.id),o.downloadElectron=o.c.find(".downloadApplication.ui"),o.proxyoptions=o.c.find(".proxyoptions"),o.nodecontrolcnt=o.c.find(".nodecontrolcnt"),s.sdk.esystem.clbks.tick.esystem=function(e,t){t&&i.proxyOptions()},i.download(),i.proxyOptions(),i.nodeControl(),e.clbk(null,e)}}}var s=new nModule,o={};return s.run=function(e){var t=s.addEssense(o,n,e);s.init(t,e)},s.stop=function(){_.each(o,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=esystem:(app.modules.esystem={},app.modules.esystem.module=esystem);
 /*_____*/ 
var article=function(){function t(e){var s,o,c,t,a,n=deep(e,"history"),i=/[,.!?;:()<> \n\r]/g,r={message:g.app.localization.e("emptymessage")},p={newart:function(){return g.app.platform.sdk.articles.empty()},complete:function(){c.save&&c.save(o),d.close(),c.complete&&c.complete(o)},change:function(e){o.content=e,o.time=Math.floor((new Date).getTime()/1e3),c.save&&c.save(o)},changecaption:function(e){o.caption.value=e,o.time=Math.floor((new Date).getTime()/1e3),c.save&&c.save(o)},trx:function(n,i){s.c&&s.c.addClass("loading"),c.share&&(n.aliasid=c.share.aliasid),g.sdk.node.transactions.create.commonFromUnspent(n,function(e,a){if(topPreloader(100),s.c&&s.c.removeClass("loading"),e)try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,n.aliasid&&(t.edit="true"),g.app.platform.sdk.node.shares.add(t),o.txid=t.txid,o.ptime=Math.floor((new Date).getTime()/1e3),g.app.platform.sdk.user.survey(),p.complete()}catch(e){console.log(e)}else i?i(!1,r[a]):(a=g.app.platform.errorHandler(a,!0))&&sitemessage(a)},e)},fromShare:function(e){var a=g.app.platform.sdk.articles.empty();return a.caption.value=e.caption.v,a.content=[{value:e.message.v}],a},add:function(){var e=new Share,a=g.app.platform.sdk.articles.echo(o);(new Date).getTime();e.message.set(a),e.caption.set(o.caption.value),e.images.set(g.app.platform.sdk.articles.getImages(a));var t=p.tagsFromText(a);e.tags.set(t),e.settings.v="a",e.settings.videos=g.app.platform.sdk.articles.getVideos(a);t=e.validation();t?r[t]&&sitemessage(r[t]):(t="Do you really want to publish this article?",c.share&&(t="Do you really want to change and publish this article?"),dialog({html:t,btn1text:g.app.localization.e("dyes"),btn2text:g.app.localization.e("dno"),class:"zindex",success:function(){a=filterXSS(a,{stripIgnoreTag:!0,whiteList:{a:["href","title","target"],br:["style"],b:["style"],span:["style"],figure:["style"],figcaption:["style","class"],i:["style"],img:["src","width","height"],div:["class","data-plyr-provider","data-plyr-embed-id"],p:[],ul:[],ol:[],li:[],h2:[],h1:[],h3:[],h4:[],h5:[],em:[],u:[],blockquote:[],strong:[],picture:["img-type"],source:["srcset","type"],strike:[]}}),e.message.set(a),p.trx(e)}}))},tagsFromText:function(e){var e=e.split(i),t=_.filter(e,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))});return _.each(t,function(e,a){t[a]=e.replace(/\#/g,"")}),t}},d={authorclose:function(){g.nav.api.load({open:!0,href:"author?address="+g.app.user.address.value.toString("hex"),history:!0}),g.closeContainer(),c.closeContainer&&c.closeContainer()},changecaption:function(){var e=$(this).val();p.changecaption(e)},change:function(){a=slowMade(function(){var e=g.app.platform.sdk.articles.lightVideo(t.serialize());p.change(e)},a,300)},close:function(){c.close&&c.close(),g.closeContainer()},add:function(){p.add()},goto:function(){o.txid&&(g.closeContainer(),c.closeContainer&&c.closeContainer(),g.nav.api.load({open:!0,href:"index?s="+o.txid,history:!0}))}},f=function(e,a){s.caption.val(e.caption.value)},u=function(){};return{primary:n,getdata:function(e,a){c=a.settings.essenseData||{},o=c.art||p.newart(parameters().aid),e({art:o=c.share?p.fromShare(c.share):o,ed:c})},destroy:function(){g.app.nav.api.history.removeParameters(["aid"]),s={}},init:function(e){var a;u(),(s={}).c=e.el.find("#"+g.map.id),s.caption=s.c.find(".caption"),s.content=s.c.find(".content"),s.back=s.c.find(".back"),s.add=s.c.find(".add"),s.goto=s.c.find(".goto"),s.back.on("click",d.close),s.caption.on("keyup",d.changecaption),s.add.on("click",d.add),s.goto.on("click",d.goto),s.c.find(".uic").on("click",d.authorclose),s.c.find(".username").on("click",d.authorclose),t=new MediumEditor(".edt",{delay:500,targetBlank:!0,toolbar:{buttons:["bold","italic","underline","anchor","quote"],diffLeft:25,diffTop:10},anchor:{placeholderText:"Type a link",customClassOption:"btn",customClassOptionText:"Create Button"},paste:{cleanPastedHTML:!0,cleanAttrs:["style","dir"],cleanTags:["label","meta"]},anchorPreview:{hideDelay:300},placeholder:{text:"Text",hideOnClick:!1}}),$(function(){$(".edt").mediumInsert({editor:t,addons:{images:{label:'<span class="fas fa-camera"></span>',deleteScript:function(e,a){g.sdk.imagesH.delete(e)},fileDeleteOptions:{},preview:!0,captions:!0,captionPlaceholder:g.app.localization.e("e13013"),autoGrid:3,formData:{},upload:function(e,t){resize(e,1080,1080,function(e){e=e.split(",");e[1]&&g.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:e[1]},success:function(e){var a=deep(e,"data.link");a?(e=deep(e,"data.deletehash"))&&g.sdk.imagesH.add(a,e):a="https://bastyon.com/img/imagenotuploaded.jpg",t&&t(a)},fail:function(){l="bastyon.com/img/imagenotuploaded.jpg",t&&t(l)}})})},fileUploadOptions:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}},messages:{acceptFileTypesError:g.app.localization.e("e13014")+" ",maxFileSizeError:g.app.localization.e("e13015")+" "},uploadCompleted:function(e,a){d.change()},uploadFailed:function(e,a){}},embeds:{label:'<span class="fas fa-play"></span>',placeholder:g.app.localization.e("e13016"),styles:{wide:{label:'<span class="fa fa-align-justify"></span>',added:function(e){},removed:function(e){}},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(e){var a=$.Event("keydown");a.which=8,$(document).trigger(a)}}}}}}),t.subscribe("editableKeyup",function(){d.change()}),t.subscribe("editablePaste",function(){d.change()}),t.subscribe("editableBlur",function(){d.change()}),f(o),Plyr.setup(".js-player",function(e){}),a&&a()}),e.clbk(null,e)},wnd:{class:"allscreen a100 article articlebtn"}}}var g=new nModule,n={};return g.run=function(e){var a=g.addEssense(n,t,e);g.init(a,e)},g.stop=function(){_.each(n,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=article:(app.modules.article={},app.modules.article.module=article);
 /*_____*/ 
var video=function(){function i(e){var t,l,e=deep(e,"history"),r=[{key:"gMrKZfHJSxA",width:560,height:315,source:"youtube",loc:{en:{title:"Pocketnet - Decentralized Social Network on the Blockchain",id:"gMrKZfHJSxA",description:"Pocketnet is a fully decentralized publishing and social platform. Based on the blockchain technology, it runs on a set of computers around the world, not controlled by any single entity.No corporation behind it to take fruits of your labor. All advertising revenue is split equally between node operators and those who publish highly rated content. Your subscribers always see your content, unless they decide to unsubscribe. Pocketnet is self-policed by the platform participants with good reputation. Nobody records your keystrokes, viewing habits or searches. Join The New Peer-To-Peer Internet: Go to https://bastyon.com and join for free now"}}}],a={validateEmail:function(e){return!!/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e)},saveEmail:function(e,n,i,o){o=o||"4";n={Email:e,Name:n};n.Action||(n.Action="ADDTOMAILLIST"),n.TemplateID||(n.TemplateID=o),$.ajax({type:"POST",url:"https://bastyon.com/Shop/AJAXMain.aspx",data:n,dataType:"json",success:function(){i&&i()}})},joinSuccess:function(e){s.fastTemplate("joinSuccess",function(e){dialog({html:e,class:"one joinbeta",btn1text:"Okay"})},{email:e})},join:function(e){s.fastTemplate("join",function(e){dialog({html:e,wrap:!0,success:function(e){var n=e.el.find(".email"),e=e.el.find(".name"),n=n.val(),e=e.val();if(a.validateEmail(n)&&e)return a.saveEmail(n,e),a.joinSuccess(n,e),!0},clbk:function(e){function n(){var e=o.val(),n=i.val();return a.validateEmail(e)&&n?(t.removeClass("disabled"),!0):(t.addClass("disabled"),!1)}var i=e.find(".name"),o=e.find(".email"),t=e.find(".btn1");t.addClass("disabled"),t.on("click",function(){}),i.focus(),i.on("change",n),i.on("keyup",n),o.on("change",n),o.on("keyup",n)},class:"one joinbeta"})},{action:e})}},n=function(){a.join()},c=function(){var e='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+l.id+'?rel=0&amp;autoplay=1" frameborder="0" allow="autoplay;" allowfullscreen></iframe>';"vimeo"==l.source&&(e='<iframe src="https://player.vimeo.com/video/'+l.id+'?title=0&byline=0&portrait=0" width="560" height="315" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),"bitchute"==l.source&&(e='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://www.bitchute.com/embed/'+l.id+'/"></iframe>'),"peertube"==l.source&&(e='<iframe width="560" height="315" scrolling="no" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen src="https://pocketnetpeertube1.nohost.me/videos/embed/'+l.id+'/"></iframe>'),t.c.find(".container").html(e),l.description&&t.c.find(".description").html(l.description)};return{primary:e,getdata:function(e,n){var i=parameters();i.v||(i.v="gMrKZfHJSxA");function o(){s.nav.api.load({open:!0,href:"page404",history:!0})}var t,a=_.find(r,function(e){return e.key==i.v});a?(s.app.el.menu.addClass("logoview").addClass("landing"),l=_.clone(a),t=l,(a=deep(t,"loc.en")||null)&&(t=_.extend(t,a)),l.id?e(l):o()):o()},destroy:function(){t={},s.app.el.menu.removeClass("logoview").removeClass("landing"),s.app.el.app.removeClass("videoActive")},init:function(o){(t={}).c=o.el.find("#"+s.map.id),t.container=t.c.find(".container"),t.c.click&&t.c.click(),s.app.el.app.addClass("videoActive"),t.c.find(".joinbeta").on("click",n),setTimeout(function(){var e,n,i;c(),e=l,n=t.container,i=n.width(),e=i/(e.width/e.height),n.find("iframe").width(i),n.find("iframe").height(e),t.container.find("iframe").fadeIn(200),t.c.find(".description").fadeIn(200),o.clbk(null,o)},100)},animation:!1}}var s=new nModule,o={};return s.run=function(e){var n=s.addEssense(o,i,e);s.init(n,e)},s.stop=function(){_.each(o,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=video:(app.modules.video={},app.modules.video.module=video);
 /*_____*/ 
var articles=function(){function n(a){var t,a=deep(a,"history"),n=function(){p.nav.api.load({open:!0,href:"article?aid="+makeid(),inWnd:!0,history:!0,essenseData:{save:function(t){p.app.platform.sdk.articles.storage||(p.app.platform.sdk.articles.storage=[]),_.find(p.app.platform.sdk.articles.storage,function(a){if(t.id==a.id)return!0})||p.app.platform.sdk.articles.storage.unshift(t),p.app.platform.sdk.articles.save()},close:function(){l.articles()},complete:function(){p.closeContainer()},closeContainer:function(){p.closeContainer()}}})},e=function(a){p.nav.api.load({open:!0,href:"article?aid="+a.id,inWnd:!0,history:!0,essenseData:{art:a,save:function(a){p.app.platform.sdk.articles.save()},close:function(){l.articles()},complete:function(){p.closeContainer()},closeContainer:function(){p.closeContainer()}}})},i=function(a){removeEqual(p.app.platform.sdk.articles.storage,{id:a}),t.c.find('.art[art="'+a+'"]').remove(),p.app.platform.sdk.articles.save(),l.ini()},o=function(){var a=$(this).closest(".art").attr("art");dialog({html:p.app.localization.e("e13018"),btn1text:p.app.localization.e("dyes"),btn2text:p.app.localization.e("dno"),class:"zindex",success:function(){i(a)}})},r=function(){n()},s=function(){var t=$(this).closest(".art").attr("art"),a=_.find(p.app.platform.sdk.articles.storage,function(a){return a.id==t});e(a)},c=function(){p.nav.api.load({open:!0,href:"author?address="+p.app.user.address.value.toString("hex"),history:!0}),p.closeContainer()},l={ini:function(){p.app.platform.sdk.articles.storage.length?t.c.removeClass("initial"):t.c.addClass("initial")},articles:function(){l.ini(),p.shell({name:"articles",el:t.articles.find(".artwrapper"),data:{articles:p.app.platform.sdk.articles.storage}},function(a){a.el.find(".artcnt").on("click",s),a.el.find(".remove").on("click",o)})}},d=function(){};return{primary:a,auto:function(){var t=parameters(),a=null;t.marticle&&!p.app.nav.wnds.article&&((a=t.aid?_.find(p.app.platform.sdk.articles.storage,function(a){return a.id==t.aid}):a)?e(a):n())},getdata:function(a){a({})},destroy:function(){t={}},init:function(a){d(),(t={}).c=a.el.find("#"+p.map.id),t.articles=t.c.find(".articles"),t.add=t.c.find(".add"),t.add.on("click",r),t.c.find(".top").on("click",c),l.articles(),a.clbk(null,a)},wnd:{class:"allscreen a100 article "}}}var p=new nModule,e={};return p.run=function(a){var t=p.addEssense(e,n,a);p.init(t,a)},p.stop=function(){_.each(e,function(a){a.destroy()})},p}();"undefined"!=typeof module?module.exports=articles:(app.modules.articles={},app.modules.articles.module=articles);
 /*_____*/ 
var streampeertube=function(){function s(e){var i,e=deep(e,"history"),d={},s=function(){};return{primary:e,getdata:function(s,e){r=e.settings.essenseData,d=r.actions,r.currentLink.includes(p.app.peertubeHandler.peertubeId)?(e=r.currentLink.split("/").pop())?p.app.peertubeHandler.getLiveInfo(e,{successFunction:e=>{var r;e.error?(r=deep(e,"error.responseJSON.errors")||{},r=(Object.values(r)[0]||{}).msg,sitemessage(r||"Server error")):(c=!0,a={rtmpUrl:e.rtmpUrl,streamKey:e.streamKey});s({})}}):s({}):(a=null,c=!1,s({}))},destroy:function(){i={}},init:function(e){var r;s(),(i={}).c=e.el.find("#"+p.map.id),i.videoInput=i.c.find(".upload-video-file"),i.videoWallpaper=i.c.find(".upload-video-wallpaper"),i.videoError=i.c.find(".file-type-error"),i.wallpaperError=i.c.find(".wallpaper-type-error"),i.uploadProgress=i.c.find(".upload-progress-container"),i.contentSection=i.c.find(".content-section"),i.resultSection=i.c.find(".result-section"),a&&(c=!0,i.contentSection.addClass("hidden"),i.resultSection.removeClass("hidden"),i.resultSection.find(".result-video-rtmp").val(a.rtmpUrl),i.resultSection.find(".result-video-streamKey").val(a.streamKey),r=e.el.find(".button.close"),console.log("Close",r),r.html('<i class="fas fa-check"></i> Stream Created'),r.addClass("successButton")),i.videoWallpaper.change(function(e){e=e.target.files[0].name;i.wallpaperError.text(e.slice(0,20)+(20<e.length?"...":"")),i.wallpaperError.removeClass("error-message")}),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fas fa-broadcast-tower"></i> Go live',fn:function(t,e){if(c)return c=!1,e.close();var a=t.find(".button.close"),o=t.find(".content-section"),n=t.find(".preloader-section");a.addClass("disabledButton"),a.text("Starting..."),o.addClass("hidden"),n.removeClass("hidden");var r=i.videoWallpaper.prop("files"),s=t.find(".upload-video-name").val(),l=t.find(".name-type-error");l.text("");e={};if(r[0]){if("image/jpeg"!==r[0].type&&"image/jpg"!==r[0].type)return i.wallpaperError.text("Incorrect wallpaper format. Supported: .jpg, .jpeg"),void i.wallpaperError.addClass("error-message");e.image=r[0]}s?(e.name=s,e.uploadFunction=function(e){e=e.toFixed(2);i.uploadProgress.find(".upload-progress-bar").css("width",e+"%"),i.uploadProgress.find(".upload-progress-percentage").text(e+"%")},e.successFunction=function(e){var r=t.find(".result-section");if(n.addClass("hidden"),e.error){var s=deep(e,"error.responseJSON.errors")||{},s=(Object.values(s)[0]||{}).msg;return sitemessage(s||"Uploading error"),o.removeClass("hidden"),a.removeClass("disabledButton"),void a.html('<i class="fas fa-broadcast-tower"></i> Go Live')}c=!0,r.removeClass("hidden"),a.html('<i class="fas fa-check"></i> Stream Created'),a.removeClass("disabledButton"),a.addClass("successButton");s=r.find(".result-video-rtmp"),r=r.find(".result-video-streamKey");s.val(e.rtmpUrl),r.val(e.streamKey),d.added(e.video)},p.app.peertubeHandler.startLive(e)):l.text("Name is empty")}}},close:function(){r.closeClbk&&r.closeClbk()},success:function(e,r){wndObj=r,wnd=e},offScroll:!0,noInnerScroll:!0,class:"streampeertube",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var p=new nModule,t={},r={},c=!1,a=null;return p.run=function(e){var r=p.addEssense(t,s,e);p.init(r,e)},p.stop=function(){_.each(t,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=streampeertube:(app.modules.streampeertube={},app.modules.streampeertube.module=streampeertube);
 /*_____*/ 
var help=function(){function a(e){var a,n,t,e=deep(e,"history"),i={roadmap:[{d:"February 2019",n:"Social Network Beta Test Starts",r:!0},{d:"March 2019",n:"Windows Desktop App",r:!0},{d:"March 2019",n:"Search users, posts",r:!1},{d:"July 2019",n:"Linux Desktop App",r:!1},{d:"July 2019",n:"Android App",r:!1},{d:"August 2019",n:"Search by tags, recommended users, poll transactions",r:!1},{d:"August 2019",n:"Personal link bastyon.com/username plus history of personal posts and ability to search users’ posts (decentralized free blog hosting on Pocketnet blockchain)",r:!1},{d:"September 2019",n:"WebTorrent hosting of videos/images",r:!1},{d:"October 2019",n:"Boost posts for Pocketcoin",r:!1},{d:"June 2019",n:"Chinese, French, German, Russian, Spanish versions",r:!1},{d:"July 2020",n:"Peer-to-peer encrypted chat, including group chat",r:!1},{d:"August 2020",n:"Decentralized Internet!!! Ability for any user to create sidechains that hold sites/groups by locking POS in the main chain, with nodes having ability to merge stake them with the main chain optionally",r:!1},{d:"October 2020",n:"Decentralized reputation platform and crypto store",r:!1}]},o=function(e){t&&(t.destroy(),t=null),a.menuitem.removeClass("active"),a.c.find('.tipitem[page="'+e+'"]').addClass("active"),n=e,d.save(),r[e]?r[e](e):r.page(e)},c=function(){var e=$(this).attr("page");o(e)},r={application:function(e){this.page(e,function(e){})},faq:function(e){this.page(e,function(e){s.nav.api.load({open:!0,id:"faq",el:e.find(".faqWrapper"),clbk:function(e,n){t=n}})})},node:function(e){this.page(e,function(e){s.app.platform.papi.post("fe88f86430a018803921b338a7e629f9c9a52a2b4e3a36056d2adc0f0c74b5b4",e.find(".lenta"),function(e,n){t=n})})},videos:function(e){this.page(e,function(e){s.nav.api.load({open:!0,id:"lenta",el:e.find(".lenta"),animation:!1,mid:"videos",essenseData:{byauthor:!0,notscrollloading:!0,nocomments:!0,txids:["9f73a1efbfb4b0feb88c134740afa0ab293f8072a80ecbe9fe65ed85591910e6","ad9067c72a7be97c1752a00566940f372e5b526291278cf9bc203b99f81bbaf0","df4064b9e2c8b311fd097804f36802ceb68337dca396bfdea732c0f94c977a3a","986a6acba795482894876ac87440124e176cc02cff40558a3ec3d423850e2e93"]},clbk:function(e,n){t=n}})})},page:function(e,n){s.shell({name:e,el:a.page,data:{c:i}},function(e){n&&n(e.el)})}},d={save:function(){s.app.nav.api.history.addParameters({page:n})},load:function(){n=parameters().page||"faq"}};return{primary:e,getdata:function(e){d.load();var n=null;e({version:n="undefined"!=typeof _Electron?require("electron").remote.app.getVersion():n})},destroy:function(){t&&(t.destroy(),t=null),a={}},init:function(e){d.load(),(a={}).c=e.el.find("#"+s.map.id),a.page=a.c.find(".page"),a.menuitem=a.c.find(".tipitem"),a.caption=a.c.find(".bgCaption"),a.menuitem.on("click",c),a.caption.find(".checkversion").on("click",function(){var e;"undefined"!=typeof _Electron&&(a.caption.find(".checking").addClass("active"),e=require("electron"),setTimeout(function(){e.ipcRenderer.send("electron-checkForUpdates"),e.ipcRenderer.on("updater-message",function(e,n){("update-downloaded"==n.msg||"update-not-available"==n.msg||n.linux&&"update-available"==n.msg)&&a.caption.find(".checking").removeClass("active")})},100))}),o(n),e.clbk(null,e)}}}var s=new nModule,t={};return s.run=function(e){var n=s.addEssense(t,a,e);s.init(n,e)},s.stop=function(){_.each(t,function(e){e.destroy()})},s}();"undefined"!=typeof module?module.exports=help:(app.modules.help={},app.modules.help.module=help);
 /*_____*/ 
var donations=function(){function t(n){var s,n=deep(n,"history"),e=["PHdW4pwWbFdoofVhSEfPSHgradmrvZdbE5","PTziv8ym7eJRUfyfAFBejJgEYemTdUgFzH","PBE1MLbsFoY3o1YW6t3Goi6spS1y9GY1vj","PRV1eoYkhA5PGkASm2tyD12xwdQnigbpkp","PRCeHituQ5WN2EXRZz4t9qTYyCBqTc4g4M","P9V67HjuApdEhj4DZxNnibxEqSnmCPbxvB","PA57U1QmmowNzSaz6ThG2EPs34QCsLyksL","PL7RNWypccYBPsDAygW3H4aKfzGBwMeWyt","PDUGAwFmRRSnSVTtcAuyVrTLAREm6HN2BC","PPvPW1sUAA1KPxcwbVKVk2EEp3uWkAKn2U","PWkUgSod6FEyVq8Ve1dWChWMC8HcXJcLro"],a={amount:new Parameter({name:r.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:r.app.localization.e("wsamountof"),format:{Precision:6}})},t=[{id:"btc",name:"Bitcoin",action:function(n){u.ways.ltcbtc(n)},qrname:"bitcoin"},{id:"ltc",name:"Litecoin",qrname:"litecoin",action:function(n){u.ways.ltcbtc(n)}},{id:"xmr",name:"Monero",qrname:"monero",action:function(n){u.ways.xmr(n)}}],i={},c=null,u={checkFunds:function(n,e,t){u.status(n,e,function(n,e){t&&t(e)})},waitfunds:function(e,t,a,o){i[e]=t,l.save(),d.address(e,t,o,a,function(n){c=setInterval(function(){u.checkFunds(e,t,function(n){"AWAITINGFUNDS"!=n.Status&&"AWAITINGDONATION"!=n.Status&&(clearInterval(c),c=null),"AWAITINGFUNDS"==n.Status||"AWAITINGDONATION"==n.Status||"EXPIREDAWAITINGFUNDS"==n.Status?d.address(e,t,o,n):d.thankyou(o,!1,a)})},6e4)})},ways:{ltcbtc:function(t){var a=t.id;i[a]?u.status(a,i[a],function(n,e){"AWAITINGFUNDS"==e.Status||"AWAITINGDONATION"==e.Status?u.waitfunds(a,i[a],e,t):"EXPIREDAWAITINGFUNDS"==e.Status?u.address(a,function(n,e){u.waitfunds(a,n,e,t)}):(delete i[a],l.save(),d.thankyou(t,!0,e))}):u.address(a,function(n,e){u.waitfunds(a,n,e,t)})},xmr:function(n){d.xmraddress(n,function(n){})},paypal:function(n){window.open("https://www.paypal.me/pocketnet","_blank").focus(),d.thankyou(n)}},donate:function(){u.hidepage(function(){d.ways()})},hidepage:function(n){s.c.find(".hideprocess").fadeOut(200,n)},showpage:function(n){s.c.find(".hideprocess").fadeIn(200,n)},status:function(n,e,t){r.app.platform.sdk.exchanges.status(n,e,t)},address:function(n,t){r.app.ajax.run({data:{Action:"GETADDRESSFORDONATION",Currency:n.toUpperCase()},success:function(n){var e=deep(n,"Address.Address");e?t&&t(e,n.Address):sitemessage(r.app.localization.e("e13094"))},fail:function(){sitemessage(r.app.localization.e("e13094"))}})}},o=function(){u.donate()},d={thankyou:function(e,t,n){_scrollTop(0),a.amount.value=deep(n,"Amount")||0,r.shell({name:"thankyou",inner:html,el:s.process.find(".step"),data:{second:t,curobj:e,info:n,parameters:a}},function(n){ParametersLive(_.toArray(a),n.el),n.el.find(".send").on("click",function(){0<a.amount.value?$.ajax({type:"POST",url:"https://bastyon.com/Shop/AJAXMain.aspx",data:{Action:"ADDTOMAILLIST",TemplateID:100,Email:r.app.platform.sdk.address.pnet().address,Name:(e.name||"NAN0")+", "+(a.amount.value||0)},dataType:"json",success:function(){n.el.html(""),setTimeout(function(){u.showpage()},100),dialog({html:r.app.localization.e("e13095"),class:"one"})}}):sitemessage(r.app.localization.e("e13096"))}),n.el.find(".back").on("click",function(){t?(n.el.html(""),setTimeout(function(){e.action(e)},100)):(n.el.html(""),setTimeout(function(){u.showpage()},100))})})},xmraddress:function(e,t){_scrollTop(0),r.shell({name:"xmraddress",inner:html,el:s.process.find(".step"),data:{curobj:e}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){d.ways()},100)}),n.el.find(".next").on("click",function(){d.thankyou(e,!0)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(r.app.localization.e("waddresswascop"))}),t&&t(n.el)})},address:function(t,a,o,i,e){r.shell({name:"address",inner:html,el:s.process.find(".step"),data:{curobj:o,address:a,currency:t,info:i}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){d.ways()},100),c&&(clearInterval(c),c=null)}),n.el.on("click",".copyaddress",function(){copyText(n.el.find(".aw")),sitemessage(r.app.localization.e("waddresswascop"))}),n.el.find(".reactivate").on("click",function(){r.app.platform.sdk.exchanges.reactivate({address:a,currency:t},function(n,e){n?sitemessage(r.app.localization.e("e13097")):u.waitfunds(t,a,i,o)})}),n.el.find(".next").on("click",function(){d.thankyou(o,!0),c&&(clearInterval(c),c=null)}),e&&e(n.el)})},ways:function(e){_scrollTop(0),r.shell({name:"ways",inner:html,el:s.process.find(".step"),data:{ways:t}},function(n){n.el.find(".back").on("click",function(){n.el.html(""),setTimeout(function(){u.showpage()},100)}),n.el.find(".way").on("click",function(){var e=$(this).attr("way"),n=_.find(t,function(n){return n.id==e});n&&n.action(n)}),e&&e()})}},l={save:function(){r.app.settings.set(r.map.uri,"storage",JSON.stringify(i))},load:function(){i=JSON.parse(r.app.settings.get(r.map.uri,"storage")||"{}")}};return{primary:n,getdata:function(n){l.load(),r.sdk.users.get(e,function(){n({donated:e})},!0)},destroy:function(){c&&(clearInterval(c),c=null),s={}},init:function(n){(s={}).c=n.el.find("#"+r.map.id),s.process=s.c.find(".process"),s.donate=s.c.find(".donate"),s.donate.on("click",o),n.clbk(null,n)}}}var r=new nModule,a={};return r.run=function(n){var e=r.addEssense(a,t,n);r.init(e,n)},r.stop=function(){_.each(a,function(n){n.destroy()})},r}();"undefined"!=typeof module?module.exports=donations:(app.modules.donations={},app.modules.donations.module=donations);
 /*_____*/ 
var system16=function(){function n(e){var l,e=deep(e,"history"),d=null,o=null,i=null,s=[],a=null,r={},c=["#F0810F","#011A27","#4897D8","#E6DF44","#063852","#486824"],p={server:{}},u={charts:{nodes:{type:"rating"},server:{type:"connections"},wallets:{type:"distribution"}}},f={unableProxyConnect:{icon:'<i class="fas fa-wifi"></i>',text:"Unable to Connect to Proxy"},undefinedError:{icon:'<i class="fas fa-exclamation-triangle"></i>',text:"Undefined Error"}},t={firebase:function(){var e=p.server.firebase||a.firebase;inputDialogNew({caption:"Proxy Firebase Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Upload New Firebase Admin SDK",placeholder:"Upload file with .json extension",upload:{ext:["json"]}},{defValue:e.id,validate:"empty",label:"Application Id",placeholder:"Application Id"}],success:function(e){return ch.key=deep(e,"0.base64"),ch.id=e[1],ch.key||ch.id?(p.server.firebase=ch,x.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},certificate:function(){p.server.ssl;var t={};inputDialogNew({caption:"Proxy SSL Parameters",wrap:!0,values:[{defValue:"",validate:"empty",label:"Certificate",placeholder:"Upload file with .pem extension",upload:{ext:["pem"]}},{defValue:"",validate:"empty",placeholder:"Upload file with .pem extension",label:"Certificate Key",upload:{ext:["pem"]}},{defValue:"",validate:"empty",label:"Password",placeholder:"Certificate Password"}],success:function(e){return t.cert=deep(e,"0.base64"),t.key=deep(e,"1.base64"),t.passphrase=e[2],t.name=deep(e,"0.file.name"),t.cert&&t.key&&t.passphrase&&t.name?(p.server.ssl=t,x.webserveradmin(l.c),!0):(sitemessage("Please Upload All files"),!1)}})},serverenabled:function(e){p.server.enabled=!JSON.parse(e.attr("value")),p.server.enabled==a.server.enabled&&delete p.server.enabled,x.webserveradmin(l.c)},nodeenabled:function(){if(!a.node.enabled)return o.system.request("set.node.enabled",{enabled:!0}).then(e=>{m.refresh()});menuDialog({items:[{text:"Disable Pocketnet Node",action:function(t){return o.system.request("set.node.enabled",{enabled:!1}).then(e=>{t(),m.refresh()})}}]})}},m={convertTime:function(e){_.each(e,function(e){e.time=fromutc(new Date(e.time))})},admin:function(){var e=C.app.platform.sdk.address.pnet();if(o&&i)return o.direct||-1<_.indexOf(i.admins,e.address)},removeAdmin:function(e){topPreloader(30),o.fetch("manage",{action:"set.admins.remove",data:{address:e}}).then(e=>{m.refresh(),topPreloader(100)}).catch(e=>{sitemessage(C.app.localization.e("e13293")),topPreloader(100)})},dust:function(e,t,n,a){C.app.platform.sdk.wallet.sendmanyoutputs(e,t,n,2,function(e,t){console.log("ERR",e),e&&C.app.platform.errorHandler(e,!0),a(e)})},ticksettings:function(e,t,n){n&&(a=e,x.allsettings())},refresh:function(){o.get.info().then(e=>{this.tick(e.info)})},tick:function(e){i=e;e=s[s.length-1];(!e||new Date(e.time).addSeconds(10)<new Date)&&(s.push({info:i,time:new Date}),s=lastelements(s,1e3)),l.c&&(x.nodecontentstate(l.c),x.nodescontenttable(l.c),x.webadminscontent(l.c),x.webdistributionwallets(l.c),x.webserverstatus(l.c)),setTimeout(function(){P.stats(!0)},200)},addnode:function(s,e){var i=!1,t="create",n=C.app.localization.e("e13044"),a=C.app.localization.e("add");s&&(i=!0,t="update",n=C.app.localization.e("e13062"),a=C.app.localization.e("save")),s=s||{};var r={host:new Parameter({type:"STRING",name:C.app.localization.e("nodehost"),id:"host",defaultValue:s.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:C.app.localization.e("e13063"),id:"port",defaultValue:s.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:C.app.localization.e("e13064"),id:"ws",defaultValue:s.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:C.app.localization.e("e13065"),id:"nodename",defaultValue:(s.nodename||(C.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:C.app.localization.e("e13066"),require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> '+C.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(e,n){var a,o=_.clone(s);s.host=r.host.value,s.port=r.port.value,s.ws=r.ws.value,s.nodename=r.nodename.value,s.rpcuser="",s.rpcpwd="","locally"==r.saveto.value?(s.rpcuser=r.rpcuser.value||"",s.rpcpwd=r.rpcpwd.value||"",s.locally=!0):(delete s.rpcuser,delete s.rpcpwd),s.host&&s.port&&s.ws&&s.nodename?(delete(a=_.clone(s)).addedby,delete a.date,a.locally||delete a.locally,C.app.platform.sdk.node.sys[t+r.saveto.value](a,function(e,t){e?(s=_.clone(o),sitemessage(e)):(i?(l.list.html(""),x.nodes(C.app.platform.nodes)):(C.app.platform.nodes||(C.app.platform.nodes=[]),C.app.platform.nodes.push(t),x.nodes([t])),C.app.platform.nodeid&&C.app.platform.nodeid.host!=a.host?n.close():m.connectnode(a,function(){n.close()}),x.active())})):sitemessage(C.app.localization.e("e13071"))}}};i&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+C.app.localization.e("delete"),fn:function(e,n){dialog({class:"zindex",html:C.app.localization.e("e13072"),success:function(){var e="revoke",e=s.locally?"revokelocally":"revokeproxy";C.app.platform.sdk.node.sys[e]({host:s.host},function(e,t){e?sitemessage(e):(l.list.find('.node[host="'+s.host+'"]').closest(".nodewrapepr").remove(),x.empty(),s.host==C.app.platform.nodeid.host?m.connectnode(null,function(){n.close()}):n.close())})}})}}),C.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:r},wnd:{header:n,buttons:a,noInnerScroll:!0,class:"addnodewnd"}},function(e){ParametersLive(_.toArray(r),e.el)})},settings:function(e){e.find("[sys]").on("click",function(){var e=$(this).attr("sys");!e||(e=deep(t,e))&&e($(this))})},node:{test:function(n){var e=_.map([{name:"Pageload",key:"pageload"}],function(t){return{text:"Pageload",action:function(e){o.fetch("nodes/test",{scenario:t.key,node:n.key}).catch(e=>{sitemessage(e)}),e()}}});menuDialog({items:e})}},proxy:{selectWatch:function(){topPreloader(70),b.proxieslist(o,"Watch Proxy",function(e){topPreloader(100),z(e)})},selectUsing:function(){var e=d.get.current();topPreloader(70),b.proxieslist(e,"Select Proxy that using Interface",function(e){topPreloader(100),d.set.current(e.id),z(d.get.current())})},add:function(t){b.addproxy(null,function(e){t&&t()})},edit:function(e,t){b.addproxy(e,function(e){t&&t()})}}},h={nodes:{responsetime:{caption:"Nodes Response Time",series:[{name:"Median Response Time",path:"statistic.time",id:"ct"}]},rate:{caption:"Nodes Rate",series:[{name:"Requestes per seconds",path:"statistic.rate",id:"cr"}]},probability:{caption:"Probability",series:[{name:"Probability to select",path:"probability",id:"spr"}]},difference:{caption:"Block Height Difference",series:[{name:"Difference",path:"status.difference",id:"cd"}]},rating:{caption:"Nodes Rating",series:[{name:"Rating",path:"rating",id:"cr"}]},allcount:{caption:"Count of requestes to nodes",series:[{name:"Count of requestes",path:"statistic.allcount",type:"spline",id:"cr"},{name:"Success Count",path:"statistic.success",type:"areaspline",id:"cp"}]}},server:{connections:{caption:"Connections",series:[{path:"wss.users",name:"Websocket Connections",id:"wss"},{path:"server.middle.requestsIp",name:"Https requests IP",id:"requests"}]},cache:{caption:"Cache Size",objects:"server.cache.meta",series:[{path:"size",name:"Size",id:"size"}]}},wallets:{distribution:{caption:"Registration Address Distribution",series:[{path:"wallet.registration.queue",name:"Users Queue Size",id:"queue"},{path:"wallet.registration.unspents",name:"Unspents Count",id:"unspents"}]},balance:{caption:"Registration Address Balance",series:[{path:"wallet.registration.balance",name:"Address Balance",id:"balance"}]}}},n={server:function(e){var t=u.charts.server.type,a=h.server[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},s=0,t=[i];return a.objects&&(t=deep(i,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:c[s%c.length],type:e.type},s++})}),{meta:n,series:o}},nodes:function(e){var t=u.charts.nodes.type,n=h.nodes[t],t={type:"spline",xtype:"datetime",caption:n.caption},a={},o=0;return i.nodeManager&&_.each(i.nodeManager.nodes,function(e,t){_.each(n.series,function(e){a[e.id+t]={name:e.name+": "+t,path:"nodeManager.nodes.'"+t+"'."+e.path,color:c[o%c.length],type:e.type},o++})}),{meta:t,series:a}},wallets:function(e){var t=u.charts.wallets.type,a=h.wallets[t],n={type:"spline",xtype:"datetime",caption:a.caption},o={},s=0,t=[i];return a.objects&&(t=deep(i,a.objects)),_.each(t,function(e,t){var n=t?t+".":"";a.objects&&(n=a.objects+"."+n),_.each(a.series,function(e){o[e.id+t]={name:e.name+": "+t,path:n+e.path,color:c[s%c.length],type:e.type},s++})}),{meta:n,series:o}}},y=function(e,t){return"function"==typeof n[e]?n[e](t):n[e]},v=function(e){return _.clone(e.meta)},g=function(e,t){var o=[],n=e.series;return _.each(n,function(n){var a={color:n.color,data:[],name:n.name,type:n.type||e.meta.type};_.each(t,function(e){var t=deep(e.info,n.path)||0;a.data.push({y:t,x:new Date(e.time)})}),o.push(a)}),o},w={prepare:function(e,t,n){var a=y(e,t),e=v(a),t=g(a,t),e=new C.app.platform.objects.graph({el:n,shell:C.shell,chart:e});return e.series=t,e},graph:function(a,e,t,n){var o=w.prepare(a,e,t);y(a,e);o.render({height:250,maxPointsCount:50},function(){u.charts[a].showed&&t.find(".graphWrapper").addClass("showed"),t.find(".showgraphwrapper").on("click",function(){t.find(".graphWrapper").toggleClass("showed"),u.charts[a].showed=t.find(".graphWrapper").hasClass("showed"),o.chart.reflow()}),t.find(".subcaptiongraph").on("click",function(){var n=[];_.each(h[a],function(e,t){n.push({text:t,action:function(e){u.charts[a].type=t,w.make(a,s),e()}})}),menuDialog({items:n})}),n&&n(o,t)})},make:function(t,e,n,a){var o,s;r[t]&&a?(o=y(t,e),s=g(o,e),s=r[t].rarefied(s,50),r[t].chart.update({series:s})):(o=l.c.find("."+t+"chart"),s=$("<div></div>",{class:"chartWrapper"}),o.html(s),w.graph(t,e,s,function(e){r[t]=e,n&&n()},a))}},b={addproxy:function(i,r){var l=!1,e=C.app.localization.e("e13054"),t=C.app.localization.e("add");i&&(l=i.id,e=C.app.localization.e("e13055"),t=C.app.localization.e("save")),i=i||{};var c={host:new Parameter({type:"STRING",name:C.app.localization.e("e13056"),id:"host",defaultValue:i.host||"bastyon.com",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:i.port||"8899",placeholder:"8888",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"wss",defaultValue:i.wss||"8099",placeholder:"8088",require:!0})},t={close:{class:"close",html:'<i class="fas fa-times"></i> '+C.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+t,fn:function(n,a){var o,t={},s=!0;_.each(c,function(e){t[e.id]=e.value||i[e.id],e.value||(s=!1)}),s?(t.user=!0,console.log("meta",t),o=new Proxy16(t,C.app),C.app.api.get.byid(o.id)?sitemessage(C.app.localization.e("e13058")):(n.find(".addproxy").addClass("loading"),console.log("newproxy",o),o.api.ping().then(e=>{var t=null;(t=l?C.app.api.editproxy(l,o.export()):C.app.api.addproxy(o.export()))?(r&&r(t),a.close()):sitemessage("Unable to add Proxy"),n.find(".addproxy").removeClass("loading")}).catch(e=>{console.log("ERROR",e),n.find(".addproxy").removeClass("loading"),sitemessage("Unable to connect")}))):sitemessage(C.app.localization.e("e13057"))}}};l&&(t.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+C.app.localization.e("delete"),fn:function(e,t){dialog({class:"zindex",html:C.app.localization.e("e13059"),success:function(){var e=l.id==d.get.current().id;C.app.api.removeproxy(i.id),r&&r(null,e),t.close()}})}}),C.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:c},wnd:{header:e,buttons:t,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(c),e.el),e.el.find(".host input").focus()})},proxieslist:function(o,s,i){o=o||{};var e=C.app.api.get.proxies(),t={close:{class:"close",html:'<i class="fas fa-times"></i> '+C.app.localization.e("close"),fn:function(e,t){t.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+C.app.localization.e("e13054"),fn:function(e,t){m.proxy.add(function(e){t.close(),b.proxieslist(o,s,i)})}}},e={destroy:function(){},name:"proxieslist",data:{proxies:e,proxy:o},wnd:{header:s,noInnerScroll:!0,class:"proxieslistwnd",buttons:t},insert:"wnd"};C.fastTemplate("proxieslist",function(e){new wnd({content:e,app:C.app,header:s,noInnerScroll:!0,class:"proxieslistwnd",buttons:t,clbk:function(a){a.el.find(".proxy").length?a.el.find(".proxieslist").removeClass("empty"):a.el.find(".proxieslist").addClass("empty"),a.el.find(".name").on("click",function(){var e=$(this).closest(".proxy").hasClass("active"),t=$(this).closest(".proxy").attr("pid");e||((t=C.app.api.get.byid(t))?i&&(i(t),a.close()):sitemessage("Error"))}),a.el.find(".delete").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=C.app.api.get.byid(e),n=d.get.current().id==e;t&&dialog({class:"zindex",html:C.app.localization.e("e13059"),success:function(){C.app.api.removeproxy(t.id),n&&z(d.get.current()),a.close(),b.proxieslist(o,s,i)}})}),a.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),t=C.app.api.get.byid(e),n=d.get.current().id==e;t&&m.proxy.edit(t,function(e){n&&z(d.get.current()),a.close(),b.proxieslist(o,s,i)})})}})},e.data)},addadmin:function(){var a=inputDialogNew({caption:"Add Admin to Proxy",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Pocketnet Address",label:"Admin address"}],success:function(e){var t=e[0];if(t){var n=!0;try{bitcoin.address.fromBase58Check(t)}catch(e){n=!1}}if(!n)return sitemessage("Address is not valid"),!1;topPreloader(30),o.fetch("manage",{action:"set.admins.add",data:{address:t}}).then(e=>{m.refresh(),a.destroy(),topPreloader(100)}).catch(e=>{sitemessage(C.app.localization.e("e13293")),topPreloader(100)})}})}},x={allsettings:function(){l.c&&x.nodecontentmanage(l.c)},proxycurrent:function(t){var e=d.get.current();C.shell({inner:html,name:"proxycurrent",data:{proxies:d.get.proxies(),current:o,using:e,admin:m.admin()},el:l.proxycurrent},function(e){e.el.find(".current").on("click",m.proxy.selectWatch),e.el.find(".selectusing").on("click",m.proxy.selectUsing),t&&t()})},error:function(e,t,n){C.shell({inner:html,name:"error",data:{error:f[e]||f.undefinedError},el:t},function(e){n&&n()})},proxycontent:function(t){i?C.shell({inner:html,name:"proxycontent",data:{info:i,proxy:o,admin:m.admin()},el:l.proxycontent},function(e){x.servercontent(e.el),x.nodescontent(e.el),x.nodecontent(e.el),t&&t()}):x.error("unableProxyConnect",l.proxycontent)},servercontent:function(e,t){i?C.shell({inner:html,name:"servercontent",data:{info:i,proxy:o,admin:m.admin()},el:e.find(".serverWrapper")},function(){x.webservercontent(e),x.webadminscontent(e),x.webdistributioncontent(e),t&&t()}):t&&t()},webserverstatus:function(e,t){i?C.shell({inner:html,name:"webserverstatus",data:{info:i,proxy:o,admin:m.admin()},el:e.find(".webserverstatusWrapper")},function(e){t&&t()}):t&&t()},webservercontent:function(e,t){i?C.shell({inner:html,name:"webservercontent",data:{info:i,proxy:o,admin:m.admin()},el:e.find(".webServerWrapper")},function(e){x.webserverstatus(e.el),x.webserveradmin(e.el),t&&t()}):t&&t()},webserveradmin:function(t,n){m.admin()&&a?C.shell({inner:html,name:"webserveradmin",data:{admin:m.admin(),system:a,proxy:o,changes:p.server},el:t.find(".adminPanelWrapper")},function(e){m.settings(e.el),e.el.find(".todefaultcert").on("click",function(){dialog({class:"zindex",html:"Do you really want to cancel Certificate changes and set Default self-signed Certificate?",btn1text:C.app.localization.e("dyes"),btn2text:C.app.localization.e("dno"),success:function(){o.fetch("manage",{action:"set.server.defaultssl",data:{}}).catch(e=>Promise.resolve()).then(e=>{z(o||d.get.current()),topPreloader(100)})}})}),e.el.find(".save").on("click",function(){(p.server.https||p.server.wss)&&(p.server.ports={https:p.server.https,wss:p.server.wss});function e(){o.fetch("manage",{action:"set.server.settings",data:{settings:p.server}}).catch(e=>Promise.resolve()).then(e=>{p.server={},z(o||d.get.current()),topPreloader(100)})}void 0!==p.server.enabled||p.server.https||p.server.wss||p.server.ssl?dialog({class:"zindex",html:"Do you really want to change this settings?",btn1text:C.app.localization.e("dyes"),btn2text:C.app.localization.e("dno"),success:function(){e()}}):e()}),e.el.find("[remove]").on("click",function(){var e=$(this).attr("remove");e&&delete p.server[e],x.webserveradmin(t)}),e.el.find(".discard").on("click",function(){p.server={},x.webserveradmin(t)}),e.el.find(".httpsport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==a.server.https?delete p.server.https:p.server.https=e,x.webserveradmin(t)}),e.el.find(".wsssport").on("change",function(){var e=$(this).val();9999<(e=e<0?0:e)&&(e=9999),$(this).val(e),e==a.server.wss?delete p.server.wss:p.server.wss=e,x.webserveradmin(t)}),n&&n()}):n&&n()},webadminscontent:function(e,t){C.app.platform.sdk.users.get(i.admins,function(){C.shell({inner:html,name:"webadminscontent",data:{admins:i.admins,info:i,proxy:o,admin:m.admin()},el:e.find(".webAdminsWrapper")},function(e){e.el.find(".addadmin").on("click",b.addadmin),e.el.find(".remove").on("click",function(){var e,t=$(this).attr("address");t&&(e="Do you really want to remove selected admin from Proxy server admin list?",t==C.app.platform.sdk.address.pnet().address&&(e="Do you really want to remove Your account from Proxy server admin list?"),dialog({class:"zindex",html:e,btn1text:C.app.localization.e("dyes"),btn2text:C.app.localization.e("dno"),success:function(){m.removeAdmin(t)}}))}),t&&t()})})},webdistributionwallets:function(e,t){C.shell({inner:html,name:"webdistributionwallets",data:{wallets:i.wallet,info:i,proxy:o,admin:m.admin()},el:e.find(".webdistributionwalletsWrapper")},function(e){e.el.find(".coins").on("click",function(){var t,e=$(this).closest(".wallet").attr("key");!e||(t=deep(i.wallet,e+".address"))&&(console.log("address",t),dialog({class:"zindex",html:"Do you really want to send 1 PKOIN to this coin distribution address?",btn1text:C.app.localization.e("dyes"),btn2text:C.app.localization.e("dno"),success:function(){topPreloader(30);var e=C.app.user.private.value.toString("hex");m.dust(e,t,2,function(e){m.refresh(),topPreloader(100),e||dialog({class:"one",html:"Pocketcoins sent to address. They will be available in several minutes"})})}}))}),e.el.find(".settings").on("click",function(){var t,n=$(this).closest(".wallet").attr("key");n&&(t=inputDialogNew({caption:"Add Private Key To Coins Distribution",class:"addressdialog",wrap:!0,values:[{defValue:"",validate:"empty",placeholder:"Private Key (WIF Format)",label:"Private Key"}],success:function(e){e=e[0];topPreloader(30),o.fetch("manage",{action:"set.wallet.setkey",data:{key:n,privatekey:e}}).then(e=>{m.refresh(),t.destroy(),topPreloader(100)}).catch(e=>{sitemessage(C.app.localization.e("e13293")),topPreloader(100)})}}))}),e.el.find(".remove").on("click",function(){var e=$(this).closest(".wallet").attr("key");e&&dialog({class:"zindex",html:"Do you really want to remove this private key from coins distribution process?",btn1text:C.app.localization.e("dyes"),btn2text:C.app.localization.e("dno"),success:function(){topPreloader(30),o.fetch("manage",{action:"set.wallet.removeKey",data:{key:e}}).then(e=>{m.refresh(),topPreloader(100)}).catch(e=>{sitemessage(C.app.localization.e("e13293")),topPreloader(100)})}})}),t&&t()})},webdistributioncontent:function(e,t){C.shell({inner:html,name:"webdistributioncontent",data:{wallets:i.wallet,info:i,proxy:o,admin:m.admin()},el:e.find(".webDistributionWrapper")},function(e){x.webdistributionwallets(e.el),t&&t()})},nodescontent:function(e,t){i?C.shell({inner:html,name:"nodescontent",data:{info:i,manager:i.nodeManager,proxy:o,admin:m.admin()},el:e.find(".nodesWrapper")},function(){e.find(".addnode").on("click",function(){m.addnode()}),x.nodescontenttable(e),t&&t()}):t&&t()},nodescontenttable:function(e,t){var n=null;d.get.current().id==o.id&&o.current&&(n=o.current.key),C.shell({inner:html,name:"nodescontenttable",data:{info:i,manager:i.nodeManager,proxy:o,admin:m.admin(),currentnode:n},el:e.find(".nodesWrapper .nodes")},function(e){function n(t){return _.find(i.nodeManager.nodes,function(e){return e.node.key==t})}e.el.find(".name").on("click",function(){var t,e=$(this).closest(".node").attr("node");e&&n(e)?(t=n(e),menuDialog({items:[{text:"Test",action:function(e){m.node.test(t.node),e()}}]})):sitemessage("Unable to find node")}),t&&t()})},nodecontent:function(e,t){m.admin()?C.shell({inner:html,name:"nodecontent",data:{info:i,manager:i.nodeManager,nodestate:i.nodeControl.state,proxy:o,admin:m.admin()},el:e.find(".localnodeWrapper")},function(){x.nodecontentstate(e),t&&t()}):t&&t()},nodecontentmanage:function(e,t){m.admin()&&C.shell({inner:html,name:"nodecontentmanage",data:{info:i,manager:i.nodeManager,nodestate:i.nodeControl.state,proxy:o,admin:m.admin(),system:a},el:e.find(".localnodeWrapper .manage")},function(e){m.settings(e.el),t&&t()})},nodecontentstate:function(e,t){m.admin()&&C.shell({inner:html,name:"nodecontentstate",data:{info:i,manager:i.nodeManager,nodestate:i.nodeControl.state,proxy:o,admin:m.admin()},el:e.find(".localnodeWrapper .state")},function(){t&&t()})}},k=function(){},P={stats:function(e){s&&(w.make("server",s,null,e),w.make("nodes",s,null,e),w.make("wallets",s,null,e),x.nodecontentstate(l.c),x.nodescontenttable(l.c),x.webadminscontent(l.c),x.webdistributionwallets(l.c),x.webserveradmin(l.c))},proxycurrent:function(){x.proxycurrent(function(){P.proxycontent()})},proxycontent:function(){x.proxycontent(function(){})}},z=function(e){o&&(delete o.clbks.changed.components,delete o.clbks.tick.components,delete o.system.clbks.tick.components),i=null,s=[],r={},(o=e)?(o.clbks.changed.components=()=>{z(d.get.current())},o.clbks.tick.components=m.tick,o.system.clbks.tick.components=m.ticksettings,o.get.info().then(e=>((i=e.info).server.listening&&i.wss.listening&&(u.charts.server.showed=!0),m.admin()&&(u.charts.nodes.showed=!0),s=[{info:i,time:utcnow()}],P.proxycurrent(),o.get.stats())).then(e=>{if(s=e.stats,s=lastelements(s,1e3),m.convertTime(s),setTimeout(function(){P.stats()},500),m.admin())return o.system.request("get.settings").then(e=>{a=e,x.allsettings()})}).catch(e=>{P.proxycurrent()})):x.proxycurrent()};return{primary:e,getdata:function(e){d=C.app.api;e({})},destroy:function(){l={}},init:function(e){k(),(l={}).c=e.el.find("#"+C.map.id),l.proxycurrent=l.c.find(".proxycurrentWrapper"),l.proxycontent=l.c.find(".proxycontentWrapper"),z(d.get.current()),e.clbk(null,e)}}}var C=new nModule,a={};return C.run=function(e){var t=C.addEssense(a,n,e);C.init(t,e)},C.stop=function(){_.each(a,function(e){e.destroy()})},C}();"undefined"!=typeof module?module.exports=system16:(app.modules.system16={},app.modules.system16.module=system16);
 /*_____*/ 
var chat=function(){function n(e){var m,e=deep(e,"history"),t=makeid(),d={},l=null,f=null,n=null,u=null,a=null,p=null,h={},g={},w={preloader:function(e){e?m.c.addClass("loading"):m.c.removeClass("loading")},close:function(){b.removeEssense(i,t),d.closeClbk&&d.closeClbk()},sendClbk:function(e,t,n){var a=m.messages.find("#"+e.EncryptedMessageID);t?(e.EncryptedMessageID=t,e.result="success",e.Message=n.note||"",e.Attachment=n.attachment||"",e.AttachmentName=n.attachmentName||"",e.AttachmentPreview=n.attachmentPreview||"",a.attr("id",e.EncryptedMessageID)):e.result="fail",a.removeClass("sending"),a.addClass(e.result)},mobileBuildHeight:function(){var e,t,n;"buildin"==d.view&&isMobile()&&(e=m.c.find(".chatwindow").height(),t=$(window).height(),n=m.c.find(".chatmessages").height(),e<=t-175&&n<e?m.c.find(".chatwindow").height(t-175):m.c.find(".chatwindow").css("height","auto"))},spacer:function(){var e;w.mobileBuildHeight(),!isTablet()||(e=0)<m.messages.find(".chatmessage").length&&(m.c.find(".spacer").height(0),(e=m.c.find(".chatwindow").height()-m.c.find(".chatmessages").height()-10)<0&&(e=0),m.spacer.height(e+"px"))},send:function(e){e&&u.rtc.send(e)},sendAttachment:function(e,n){b.app.platform.sdk.chats.send({attachment:e.attachment,attachmentName:e.attachmentName,attachmentPreview:e.attachmentPreview,temp:n},u.ThreadID,function(e,t){w.sendClbk(n,e,t)})},addTempMessage:function(e){var t=new Date;b.app.platform.timeDifference&&(t=t.addSeconds(b.app.platform.timeDifference/1e3));e={Created:dateToStrUtcS(t),ThreadID:u.ThreadID,EncryptedMessageID:makeid(!0),temp:!0,UserID:b.app.user.data.id,decrypted:{Message:e.note,AttachmentName:e.attachmentName,AttachmentPreview:e.attachmentPreview}};return u.messages.push(e),o.messages(null,[e],!0),e},clearTempMessages:function(){m.messages.find(".temp").remove()},scrollToPx:function(e,t){if(!w.checkState())return!1;var n,a,s,i;null!==t&&(i=n=null,a="position","buildin"==d.view?(n=$(window),i=$("html"),a="offset"):(n=m.c.find(".chatwindow"),i=m.c.find(".chatmessages")),"toLast"==e||"toLast"==t?(s=m.messages.find(".chatmessage:nth-last-child(1)"))[a]()&&(e=70,isMobile()&&(e=115),t=s[a]().top+s.height()+e-n.height(),n.scrollTop(t,200)):(i=i.height(),n.scrollTop(i-t,200)))},scrollPx:function(e){if(m.c){var t,n=null,a=null,s=null,a="buildin"==d.view?(n=$(window),$("html")):(n=m.c.find(".chatwindow"),m.c.find(".chatmessages"));return"toLast"==e?s="toLast":(t=m.messages.find(".chatmessage:nth-last-child(1)"),e="position","buildin"==d.view&&(e="offset"),inView(t,{inel:n,offset:-20,mode:"partall"}),t&&t[e]()&&(e=a.height(),a=n.scrollTop(),s=e-t.height()-150,s=a+n.height()>s?"toLast":null)),s}},saveAttachment:function(e){topPreloader(30);var t=c.findEl(e);t&&t.addClass("saveAttachment"),b.app.platform.sdk.chats.getAttachment(e,function(e){topPreloader(100),t&&t.removeClass("saveAttachment"),e?e.ChatMessageAttach&&saveAs({download:e.decrypted.AttachmentName,file:e.ChatMessageAttach,noA:!0}):console.log("ERROR")})},openGallery:function(e){e={idName:"EncryptedMessageID",initialValue:e.EncryptedMessageID,getImages:function(){return _.filter(u.messages,function(e){e=deep(e,"decrypted.AttachmentName");if(e&&(-1<e.indexOf(".jpg")||-1<e.indexOf(".png")||-1<e.indexOf(".jpeg")))return!0})},getImage:function(e,t){e.ChatMessageAttach?t&&t({src:e.ChatMessageAttach,name:e.decrypted.AttachmentName}):b.app.platform.sdk.chats.getAttachment(e,function(e){e={src:e.ChatMessageAttach,name:e.decrypted.AttachmentName};t&&t(e)})}};o.gallery(e)},getPreview:function(e){b.app.platform.sdk.chats.getPreview(e,function(e){_.each(e,function(e){var t=c.findEl(e);o.messages(null,[e],!0,t)})})},read:function(){},countUnread:function(){m.countUnread&&m.countUnread.html("")},checkState:function(){if(m.c&&!m.c.hasClass("minimized"))return!0}},v={minimize:function(){m.c.addClass("minimized"),d.minimizeClbk&&d.minimizeClbk(),l.clear(),f.clear(),m.type.blur()},expand:function(){m.c.removeClass("minimized"),d.expandClbk&&d.expandClbk(),isTablet()||m.type.focus(),w.spacer(),setTimeout(function(){w.scrollToPx("toLast","toLast")},100)},out:function(){b.app.modules.chats.module.api.add(u.ThreadID)},close:function(){w.close()},type:function(e,t){var n=this.getText();if(13==t.which||13==t.keyCode)return n&&(this.setText(""),w.send(n),$(this).val("")),!1},resizeWindow:function(){l&&l.setOffset([0,0]),f&&f.setOffset([50,100])},getAttachment:function(){var e=$(this).closest(".chatmessage"),t=e.attr("id");e.hasClass("sending")||(e=c.findMessage(t)).decrypted&&e.decrypted.AttachmentName&&(-1<(t=e.decrypted.AttachmentName.toLowerCase()).indexOf(".jpg")||-1<t.indexOf(".png")||-1<t.indexOf(".jpeg")?w.openGallery(e):w.saveAttachment(e))},messagesInView:function(){n=slowMade(function(){if(!w.checkState())return!1;var e=m.messages.find(".chatmessage"),t=m.messages.find(".chatmessage:nth-last-child(1)");"buildin"==d.view&&(n=$(window)),"fixedin"==d.view&&(n=m.c.find(".chatwindow"));var e=inView(e,{inel:n}),n=inView(t,{inel:n});0<e.length&&_.map(e,function(e){e=$(e).attr("id");return c.findMessage(e)}),0<n.length&&w.read()},n,100)}},c={findMessage:function(t){return _.find(u.messages,function(e){return e.EncryptedMessageID==t})},findEl:function(e){return m.c.find("#"+(e.tm+e.f))}},o={gallery:function(e){e=e||{},b.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:e})},safemessages:function(e,t){var s=_.map(g,function(e,t){return{m:e,t:t}}),s=_.sortBy(s,function(e){return Number(e.t)}),i=[];_.each(s,function(t,n){var a={newmessages:[],oldmessage:t};_.each(e,function(e){(Number(e.tm)<Number(t.t)||n==s.length-1)&&(!n||Number(s[n-1].t)>Number(e.tm))&&a.newmessages.push(e)}),a.newmessages.length&&(a.newmessages.push(a.oldmessage.m),a.newmessages=_.sortBy(a.newmessages,function(e){return Number(t.t)}),i.push(a))}),i.length?lazyEach({array:i,action:function(e){var t=e.item,n=c.findEl(t.oldmessage);o.messages(e.success,t.newmessages,null,n)},all:{success:t}}):o.messages(t,e)},messages:function(t,a,n,e){var s,i,c,o,r;m.c&&(a=_.filter(a,function(e,t){var n=e.tm;if(17==e.tm.length&&(e.tm=n+"0"),!(p&&p.tm>e.tm))return!(a.length-50>t)}),s=a?"fixed":"toLast",i=w.scrollPx(s),a=a||[],a=_.filter(a,function(e){var t=e.tm+e.f;return!!e.tm&&(h[t]?void 0:(h[t]=!0,g[e.tm]=e,!0))}),c=_.sortBy(a,function(e){var t=e.tm;return 17==e.tm.length&&(e.tm=t+"0"),Number(e.tm)}),n||w.clearTempMessages(),o=append,r=m.messages,e&&(o=replaceWith,r=e),a.length?(p=c[c.length-1],b.shell({name:"messages",el:r,data:{chat:u,messages:c},inner:o},function(e){d.messagesClbk&&d.messagesClbk(),m.messages.find(".attachment").off("click"),m.messages.find(".attachment").on("click",v.getAttachment),v.messagesInView(),0<m.messages.find(".chatmessage").length?m.c.find(".other").fadeOut(1):m.c.find(".other").fadeIn(1),n&&(i="toLast"),w.spacer(),setTimeout(function(){w.scrollToPx(s,i)},20),l&&l.action(),f&&f.action(),w.countUnread(),t&&t()})):t&&t())}},s=function(){};return{primary:e,getdata:function(t,e){var n,a={},s=deep(e,"settings.essenseData.chat");s||(n=parameters().chatid,s=b.app.platform.sdk.discussions.fromChatId(n));deep(e,"settings.essenseData");s&&(u=s.chat,b.app.platform.sdk.chats.info([s.chat],function(e){a.chat=s,b.app.platform.sdk.tempmessenger.getChat(s.chat),a.canEnc=!0,b.app.platform.sdk.ustate.me(function(e){a.mestate=e,t(a)})}))},destroy:function(){m.type&&m.type.blur(),$("html").off("mousemove",v.messagesInView),window.removeEventListener("scroll",v.messagesInView),window.removeEventListener("resize",v.resizeWindow),b.app.platform.ws,$(window).off("focus",w.read),$(window).off("mousemove",w.read),delete u.rtc.clbks.receive.message.messenger,delete u.rtc.clbks.receive.messages.messenger,delete u.rtc.clbks.send.message.messenger,n&&clearTimeout(n),m={},l&&l.destroy(),f&&f.destroy(),l=f=null,u&&(u.rtc.leave(),u=null),clearInterval(a),$("#tawkchat-container").fadeIn(),d.destroyClbk&&d.destroyClbk()},init:function(e){var t,n;h={},g={},(d=e.essenseData||{}).view||(d.view="buildin"),s(),(m={}).c=e.el.find("#"+b.map.id),m.messages=m.c.find(".chatmessages"),m.type=m.c.find(".type"),m.attachement=m.c.find(".attachement"),m.countUnread=m.c.find(".countUnread"),m.spacer=m.c.find(".spacer"),m.c.addClass(d.view),"buildin"==d.view&&(isMobile()||(l=new Caption({container:m.c.find(".chatWrapper"),caption:m.c.find(".captionfwrapper"),offset:[0,0]}).init()),t=0,isMobile()&&(t=50),f=new Caption({container:m.c.find(".chatWrapper"),caption:m.c.find(".bcaptionfwrapper"),offset:[t,2*t],pos:"bottom"}).init(),m.c.find(".out").on("click",v.out),window.addEventListener("scroll",v.messagesInView),window.addEventListener("resize",v.resizeWindow),$("html").on("mousemove",v.messagesInView)),"fixedin"==d.view&&(m.c.find(".close").on("click",v.close),m.c.find(".chatwindow").on("scroll",v.messagesInView),$("html").on("mousemove",v.messagesInView)),m.c.find(".minimize").on("click",v.minimize),m.c.find(".expand").on("click",v.expand),m.countUnread.on("click",function(){v.expand()}),m.type.emojioneArea({pickerPosition:"top",search:!1,tones:!1,attributes:{spellcheck:!0,autocomplete:"on"},events:{keyup:v.type,onLoad:function(e,t){}}}),initUpload({el:m.attachement,ext:["png","jpeg","jpg","pdf"],multiple:!0,maxFileSize:5,dropZone:m.c.find(".chatWrapper"),beforeUpload:function(e){var t,a=deep(e,"file.name");"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?resize(e.base64,200,200,function(t){var n=w.addTempMessage({attachmentName:a,attachmentPreview:t});resize(e.base64,1600,1600,function(e){w.sendAttachment({attachment:e,attachmentName:a,attachmentPreview:t},n)})}):(t=w.addTempMessage({attachmentName:a}),w.sendAttachment({attachment:e.base64,attachmentName:a},t))}}),u.rtc.clbks.receive.message.messenger=function(e){!b.app.platform.focus&&b.app.platform.titleManager&&b.app.platform.titleManager.add("You have new messages"),p=e,b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,[e])})},u.rtc.clbks.receive.messages.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){o.messages(null,e,!0)})},u.rtc.clbks.send.message.messenger=function(e){b.app.platform.sdk.messenger.load.messages(e,function(){p=e,o.messages(null,[e],!0)})},u&&(n=_.toArray(u.rtc.storage._db||{}),b.app.platform.sdk.messenger.load.messages(n,function(){o.messages(null,n,!0)}),u.rtc.connect(function(){})),b.app.platform.ws,$(window).on("focus",w.read),$(window).on("mousemove",w.read),w.countUnread(),e.clbk(null,e)},id:t,api:v}}var b=new nModule,i={};return b.run=function(e){var t=b.addEssense(i,n,e);b.init(t,e)},b.stop=function(){_.each(i,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=chat:(app.modules.chat={},app.modules.chat.module=chat);
 /*_____*/ 
var proxylogs=function(){function s(n){var o,n=deep(n,"history"),s={requests:{ws:{path:"ws",name:"Websocket connections",color:"#006CFF"},requests:{path:"requestsIp",name:"Https requests ip",color:"#FF004E"}},blacklists:{black:{path:"iplimiter.black",name:"Black list ip count",color:"#20C02B"},tblack:{path:"iplimiter.black",name:"Temp Black list ip count",color:"#00C0FF"}}},r=function(n){n.find(".expandall").on("click",function(){$(this).closest(".report").toggleClass("active")})},l=function(n){var t={type:"spline",xtype:"datetime"};return"requests"==n&&(t.caption="Connections"),"blacklists"==n&&(t.caption="Black list"),t},a=function(n,t){var o=[],n=s[n];return _.each(n,function(s){var e={color:s.color,data:[],name:s.name};_.each(t,function(n){var t=deep(n,s.path)||0;e.data.push({y:t,x:new Date(n.time)})}),o.push(e)}),o},i={prepare:function(n,t,s){var e=l(n),o=a(n,t);console.log(n,o,t);e=new p.app.platform.objects.graph({el:s,shell:p.shell,chart:e});return e.series=o,e},make:function(n,t,s,e){var o=i.prepare(n,t,s);o.render({maxPointsCount:100},function(){e&&e(o)})}},c={users:function(n){var t=[],s=n.find(".loadaddress");s.each(function(){var n=$(this).attr("address");n&&t.push(n)}),t.length&&p.shell({name:"user",data:{}},function(n){console.log(n),p.app.platform.sdk.users.get(t,function(n,t){s.each(function(){var n=$(this).attr("address");n&&($(this).removeAttr("address"),p.shell({name:"user",data:{address:n},el:$(this)},function(n){}))})})})},logs:function(e,t){p.shell({name:"logs",data:{logs:e},el:o.logs},function(n){r(n.el),n.el.find(".expand").on("click",function(){var n=$(this).closest(".log"),t=n.attr("ip"),s=_.find(e,function(n){return n.ip==t});n.hasClass("active")?n.toggleClass("active"):c.wslogs(n.find(".wslogswrp"),deep(s,"ws"),function(){n.toggleClass("active")},!0)}),t&&t()})},ws:function(t,s){p.shell({name:"ws",data:{ws:t},el:o.ws},function(n){r(n.el),c.wslogs(n.el.find(".wslogswrp"),t),s&&s()})},block:function(n,t){p.shell({name:"block",data:{block:n},el:o.block},function(n){r(n.el),t&&t()})},wslogs:function(n,t,s,e){p.shell({name:"wslogs",data:{ws:t,users:e},el:n},function(n){e&&c.users(n.el),n.el.find(".clickload").on("click",function(){c.users($(this).closest(".address"))}),s&&s()})},error:function(t){p.shell({name:"error",data:{},el:o.error},function(n){t&&t()})},stats:function(t,s){p.shell({name:"stats",data:{stats:t},el:o.stats},function(n){c.statsChart("requests",t,n.el.find(".chartswrapper")),c.statsChart("blacklists",t,n.el.find(".chartswrapper")),s&&s()})},statsChart:function(n,t,s,e){var o=$("<div></div>",{class:"chartWrapperbs"});s.append(o),i.make(n,t,o,e)}},e=function(s){p.app.platform.sdk.system.get.info(function(n,l){var a,t;console.log(n),l?(a=[],t={},n=group(l.logs,function(n){return n.ip}),_.each(n,function(n,s){var t=_.filter(l.ws,function(n){if(n.ip==s)return n.using=!0}),t=_.sortBy(t,function(n){return-(n.ws_clients+n.ws_nodes)}),e=_.find(l.iplimiter,function(n,t){if(t==s)return n.using=!0}),o={},r=group(n,function(n){return n.s});_.each(r,function(n,t){o[t]=group(n,function(n){return deep(n,"p.method")||deep(n,"pn")||"others"})}),a.push({ws:t,requests:o,ip:s,block:e,count:n.length})}),a=_.sortBy(a,function(n){return-(n.count+10*n.ws.length)}),t.logs=a,t.ws=_.filter(l.ws,function(n){return!n.using}),t.ws=_.sortBy(t.ws,function(n){return-(n.ws_clients+n.ws_nodes)}),t.blocks=_.filter(l.iplimiter,function(n,t){return n.ip=t,!n.using}),s&&s(t)):s&&s(null)})},t=function(s){p.app.platform.sdk.system.get.stats(function(n,t){n?s&&s(null):s&&s(t)})},u=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){o={}},init:function(n){u(),(o={}).c=n.el.find("#"+p.map.id),o.logs=n.el.find(".logsWrapper"),o.ws=n.el.find(".wsWrapper"),o.block=n.el.find(".blockWrapper"),o.stats=n.el.find(".statsWrapper"),o.error=n.el.find(".errorWrapper"),t(function(t){t&&c.stats(t),e(function(n){n&&(c.logs(n.logs),c.ws(n.ws),c.block(n.blocks)),t||n||c.error()})}),n.clbk(null,n)}}}var p=new nModule,e={};return p.run=function(n){var t=p.addEssense(e,s,n);p.init(t,n)},p.stop=function(){_.each(e,function(n){n.destroy()})},p}();"undefined"!=typeof module?module.exports=proxylogs:(app.modules.proxylogs={},app.modules.proxylogs.module=proxylogs);
 /*_____*/ 
var connection=function(){function o(e){var i,e=deep(e,"history"),o=function(e,o){var a=m.app.platform.apiproxy;m.app.platform.apiproxy=e,m.app.platform.sdk.proxy.info(function(e,a){o&&o(!a)}),m.app.platform.nodeid=a},l=function(e,o){var a=m.app.platform.nodeid;m.app.platform.nodeid=e,m.app.platform.sdk.node.get.time(function(e,a){o&&o(!a)}),m.app.platform.nodeid=a},c=function(e,a){o(e,function(e){e?a&&a(!0):(dialog({html:m.app.localization.e("e13052"),class:"one zindex"}),a&&a(!1))})},n=function(e,a){l(e,function(e){e?a&&a(!0):(dialog({html:m.app.localization.e("e13053"),class:"one zindex"}),a&&a(!1))})},r={preloader:function(e){e?i.c.addClass("loading"):i.c.removeClass("loading")},addproxy:function(t,p){var s=!1,i="create",e=m.app.localization.e("e13054"),a=m.app.localization.e("add");t&&(s=!0,i="update",e=m.app.localization.e("e13055"),a=m.app.localization.e("save")),t=t||{};var r={host:new Parameter({type:"STRING",name:m.app.localization.e("e13056"),id:"host",defaultValue:t.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:"RPC Port",id:"port",defaultValue:t.port||"8888",placeholder:"8888",require:!0}),ws:new Parameter({type:"STRING",name:"WS Port",id:"ws",defaultValue:t.ws||"8088",placeholder:"8088",require:!0})},a={close:{class:"close",html:'<i class="fas fa-times"></i> '+m.app.localization.e("close"),fn:function(e,a){a.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+a,fn:function(a,o){var e,l={},n=!0;_.each(r,function(e){l[e.id]=e.value||t[e.id],e.value||(n=!1)}),n?(l.user=!0,l.id=m.app.platform.sdk.proxy.makeid(l),e=m.app.platform.sdk.proxy.all(),_.find(e,function(e){return e.id==l.id})?sitemessage(m.app.localization.e("e13058")):(a.find(".addproxy").addClass("loading"),c(l,function(e){a.find(".addproxy").removeClass("loading"),e&&(e=m.app.platform.sdk.proxy[i](l,t.id),s||(m.app.platform.apiproxy=l,e=!0),p&&p(l,e),o.close())}))):sitemessage(m.app.localization.e("e13057"))}}};s&&(a.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+m.app.localization.e("delete"),fn:function(e,a){dialog({class:"zindex",html:m.app.localization.e("e13059"),success:function(){var e=m.app.platform.sdk.proxy.remove(t.id);p&&p(null,e),a.close()}})}}),m.shell({destroy:function(){},insert:"wnd",name:"addproxy",data:{parameters:r},wnd:{header:e,buttons:a,noInnerScroll:!0,class:"addproxywnd"}},function(e){ParametersLive(_.toArray(r),e.el),e.el.find(".host input").focus()})},proxieslist:function(e,n){function t(e){e.close(),r.connectproxy()}var a=m.app.platform.sdk.proxy.all(),o={close:{class:"close",html:'<i class="fas fa-times"></i> '+m.app.localization.e("close"),fn:function(e,a){console.log("close"),a.close()}},success:{class:"success",html:'<i class="fas fa-plus"></i> '+m.app.localization.e("e13054"),fn:function(o,l){r.addproxy(null,function(e,a){a?t(l):f.proxieslist(o,l)})}}},p={destroy:function(){},name:"proxieslist",data:{proxies:a,proxy:m.app.platform.apiproxy,ele:r.ele()},wnd:{header:m.app.localization.e("e13060"),noInnerScroll:!0,class:"proxieslistwnd",buttons:o}};e?p.el=e:p.insert="wnd",m.shell(p,function(l){l.el.find(".proxy").length?l.el.find(".proxieslist").removeClass("empty"):l.el.find(".proxieslist").addClass("empty"),l.el.find(".name").on("click",function(){var a,e=$(this).closest(".proxy").hasClass("active"),o=$(this).closest(".proxy").attr("pid");e||("none"==o?dialog({html:m.app.localization.e("e13061"),class:"zindex",success:function(){r.using(!0),f.active(),(l.container||n).close()}}):(a=m.app.platform.sdk.proxy.find(o),l.el.find(".proxieslist").addClass("loading"),c(a,function(e){l.el.find(".proxieslist").removeClass("loading"),e&&m.app.platform.sdk.proxy.changeWithDialog(a,function(){(l.container||n).close(),f.proxy(),f.active()})})))}),l.el.find(".edit").on("click",function(){var e=$(this).closest(".proxy").attr("pid"),e=m.app.platform.sdk.proxy.find(e);e&&r.addproxy(e,function(e,a){a?t(l.container||n):r.proxieslist(p.el)})})})},addnode:function(t,e){var p=!1,a="create",o=m.app.localization.e("e13044"),l=m.app.localization.e("add");t&&(p=!0,a="update",o=m.app.localization.e("e13062"),l=m.app.localization.e("save")),t=t||{};var s={saveto:new Parameter({type:"VALUES",name:m.app.localization.e("save"),id:"saveto",defaultValue:"proxy",possibleValues:["proxy","locally"],possibleValuesLabels:[m.app.localization.e("onproxy"),m.app.localization.e("locally")],require:!0}),host:new Parameter({type:"STRING",name:m.app.localization.e("nodehost"),id:"host",defaultValue:t.host||"",placeholder:"0.0.0.0",require:!0}),port:new Parameter({type:"STRING",name:m.app.localization.e("e13063"),id:"port",defaultValue:t.port||"38081",placeholder:"38081",require:!0}),ws:new Parameter({type:"STRING",name:m.app.localization.e("e13064"),id:"ws",defaultValue:t.ws||"8087",placeholder:"8087",require:!0}),nodename:new Parameter({type:"STRING",name:m.app.localization.e("e13065"),id:"nodename",defaultValue:(t.nodename||(m.app.platform.api.clearname(deep(app,"platform.sdk.user.storage.me.name"))||"New")+" node").replace(/\+/g," "),placeholder:m.app.localization.e("e13066"),require:!0}),rpcuser:new Parameter({type:"STRING",name:m.app.localization.e("e13067"),id:"rpcuser",placeholder:m.app.localization.e("e13068"),defaultValue:t.rpcuser||"",require:!0}),rpcpwd:new Parameter({type:"STRING",name:m.app.localization.e("e13069"),id:"rpcpwd",defaultValue:t.rpcpwd||"",placeholder:m.app.localization.e("e13070"),require:!0})};!m.app.platform.dontuseapiproxy&&m.app.platform.apiproxy||(s.saveto=new Parameter({type:"VALUES",name:m.app.localization.e("save"),id:"saveto",defaultValue:"locally",possibleValues:["locally"],possibleValuesLabels:[m.app.localization.e("locally")],require:!0})),console.log("ap",s);l={close:{class:"close",html:'<i class="fas fa-times"></i> '+m.app.localization.e("close"),fn:function(e,a){a.close()}},success:{class:"success",html:'<i class="fas fa-check"></i> '+l,fn:function(e,o){var l,n=_.clone(t);t.host=s.host.value,t.port=s.port.value,t.ws=s.ws.value,t.nodename=s.nodename.value,t.rpcuser="",t.rpcpwd="","locally"==s.saveto.value?(t.rpcuser=s.rpcuser.value||"",t.rpcpwd=s.rpcpwd.value||"",t.locally=!0):(delete t.rpcuser,delete t.rpcpwd),t.host&&t.port&&t.ws&&t.nodename?(delete(l=_.clone(t)).addedby,delete l.date,l.locally||delete l.locally,m.app.platform.sdk.node.sys[a+s.saveto.value](l,function(e,a){e?(t=_.clone(n),sitemessage(e)):(p?(i.list.html(""),f.nodes(m.app.platform.nodes)):(m.app.platform.nodes||(m.app.platform.nodes=[]),m.app.platform.nodes.push(a),f.nodes([a])),m.app.platform.nodeid&&m.app.platform.nodeid.host!=l.host?o.close():r.connectnode(l,function(){o.close()}),f.active())})):sitemessage(m.app.localization.e("e13071"))}}};p&&(s.host.disabled=!0,s.saveto.hidden=!0,t.locally?s.saveto.value="locally":s.saveto.value="proxy",l.delete={class:"delete ghost",html:'<i class="fas fa-trash"></i> '+m.app.localization.e("delete"),fn:function(e,o){dialog({class:"zindex",html:m.app.localization.e("e13072"),success:function(){var e="revoke",e=t.locally?"revokelocally":"revokeproxy";m.app.platform.sdk.node.sys[e]({host:t.host},function(e,a){e?sitemessage(e):(i.list.find('.node[host="'+t.host+'"]').closest(".nodewrapepr").remove(),f.empty(),t.host==m.app.platform.nodeid.host?r.connectnode(null,function(){o.close()}):o.close())})}})}}),m.shell({destroy:function(){},insert:"wnd",name:"addnode",data:{parameters:s},wnd:{header:o,buttons:l,noInnerScroll:!0,class:"addnodewnd"}},function(e){ParametersLive(_.toArray(s),e.el);function a(){e.el.find(".addnode").attr("saveto",s.saveto.value)}a(),s.saveto._onChange=function(){a()}})},connectproxy:function(e){m.app.platform.nodeid=null,m.app.platform.nodes=null,m.app.errors.clear(),m.app.platform.state.save(),m.app.platform.restart(function(){app.reload(function(){}),e&&e()})},connectnode:function(a,o){r.preloader(!0),n(a,function(e){e?(m.app.platform.nodeid=a,m.app.platform.state.save(),f.active(),m.app.errors.clear(),m.app.platform.restart(function(){r.preloader(!1),app.reload(function(){}),o&&o()})):r.preloader(!1)})},ele:function(){return"undefined"!=typeof _Electron},using:function(e){m.app.platform.dontuseapiproxy=e,m.app.platform.sdk.proxy.save(),f.proxy(),r.connectproxy()}},a=function(){m.app.platform.dontuseapiproxy?r.using(!m.app.platform.dontuseapiproxy):dialog({html:m.app.localization.e("e13073"),class:"zindex",success:function(){r.using(!m.app.platform.dontuseapiproxy)}})},t=function(){r.proxieslist()},p=function(){r.addnode()},s=function(){var a=$(this).closest(".node").attr("host"),o="true"==(o=$(this).closest(".node").attr("locally")),e=_.find(m.app.platform.nodes,function(e){return e.host==a&&e.locally==o});e&&r.addnode(e)},d=function(){var a,o,e=$(this).closest(".node");e.hasClass("active")||(a=e.attr("host"),o="true"==(o=e.attr("locally")),e=_.find(m.app.platform.nodes,function(e){return e.host==a&&e.locally==o}),r.connectnode(e))},f={nodes:function(e,a){m.shell({inner:append,name:"nodes",data:{nodes:e},el:i.list},function(){f.empty(),f.active(),a&&a()})},empty:function(){i.list.find(".node").length?i.nodes.removeClass("empty"):i.nodes.addClass("empty")},active:function(){i.list.find(".node").removeClass("active"),m.app.platform.nodeid&&i.list.find('.node[host="'+m.app.platform.nodeid.host+'"][locally="'+(m.app.platform.nodeid.locally||"false")+'"]').addClass("active")},proxy:function(){m.app.platform.dontuseapiproxy?(i.cc.removeClass("useproxy"),i.cc.addClass("shownodes"),i.currentproxy.html(m.app.localization.e("e13051"))):(i.cc.addClass("useproxy"),m.app.platform.apiproxy?(i.cc.addClass("shownodes"),i.currentproxy.html("https://"+app.platform.apiproxy.host+":"+app.platform.apiproxy.port+"; wss:"+app.platform.apiproxy.ws)):(i.cc.removeClass("shownodes"),i.currentproxy.html(m.app.localization.e("notselected"))))}},u=function(){};return{primary:e,getdata:function(e){var a={ele:r.ele()};window.cordova,e(a)},destroy:function(){i={}},init:function(e){u(),(i={}).c=e.el.find("#"+m.map.id),i.list=i.c.find(".list"),i.add=i.c.find(".addnewNode"),i.nodes=i.c.find(".nodespart"),i.cc=i.c.find(".connection"),i.currentproxy=i.c.find(".current"),i.add.on("click",p),i.c.on("click",".edit",s),i.c.on("click",".connectnode",d),i.c.find(".openproxielist").on("click",t),i.c.find(".usingproxy").on("click",a),f.proxy(),i.nodes.addClass("loading"),m.app.platform.sdk.system.get.nodes(!0,function(){i.nodes.removeClass("loading"),f.nodes(m.app.platform.nodes)}),e.clbk(null,e)}}}var m=new nModule,l={};return m.run=function(e){var a=m.addEssense(l,o,e);m.init(a,e)},m.stop=function(){_.each(l,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=connection:(app.modules.connection={},app.modules.connection.module=connection);
 /*_____*/ 
var share=function(){function t(o){var r,i,e,n=/[,.!?;:() \n\r]/g,a=deep(o,"history"),l=null,c=!1,s=null,p=!1,t=v.app.localization.e("e13160"),d={language:function(n){var e=[];_.each(v.app.localization.available,function(t){e.push({text:t.name,action:function(e){var a=app.localization.findByName(t.name);a&&a.key!=l.language.v&&l.language.set(a.key),e(),g.postline(),n&&n()}})}),menuDialog({items:e})},toggleTimesDisplay:function(){var e=l.message.v||l.caption.v||l.repost.v||l.url.v||l.images.v.length||l.tags.v.length;r.times&&(e&&r.times.removeClass("hide"),e||r.times.addClass("hide"))},tooltips:function(){d.tooltip||e&&e.destroy()},tooltip:function(){if(p&&l.message.v)return l.tags.length?void 0:(e=v.app.platform.api.plissing({el:r.tagSearch,text:v.app.localization.e("e13161")}),!0)},unfocus:function(){r.c&&r.c.addClass("unfocus").removeClass("focus")},waitActions:function(){v.app.platform.sdk.user.waitActions(function(e){r.c&&(e&&"inf"!=e?r.c.addClass("waitActions"):r.c.removeClass("waitActions"))})},autoFilled:function(){console.log("current",l),d.filled("i",0!=l.images.v.length),d.filled("u",l.url.v),d.filled("t",0!=l.tags.v.length),d.filled("cm",l.message.v||l.caption.v),d.filled("p",l.poll.v.list)},filled:function(e,a){e=r.c.find('.draggablepart[part="'+e+'"]');a?e.addClass("filled"):e.removeClass("filled")},checkUrlForImage:function(a){if(a=a.split("?")[0].toLowerCase(),_.find([".jpg",".gif",".png",".jpeg"],function(e){if(-1<a.indexOf(e))return!0}))return!0},embeding20:function(e){var a=l.export(!0);v.nav.api.load({open:!0,id:"embeding20",inWnd:!0,essenseData:{storage:a,value:e,on:{added:function(e){"url"==type&&e&&d.checkUrlForImage(e)&&(type="images"),l[type].set(e),g[type]&&g[type]()}}}})},embeding:function(n,a){var t=l.export(!0);"addVideo"===n&&(r.peertube.addClass("disabledShare"),r.peertubeLiveStream.addClass("disabledShare"),v.app.peertubeHandler.authentificateUser(function(e){return(e=e||{}).error?(r.peertube.removeClass("disabledShare"),r.peertubeLiveStream.removeClass("disabledShare"),sitemessage(e.error)):(v.nav.api.load({open:!0,id:"uploadpeertube",inWnd:!0,history:!0,essenseData:{storage:t,value:a,actions:{added:function(e){var a="url";console.log("Finished!",e,new Date);e=l[a].set(e);i.share||f.save(),!e&&m[a]&&sitemessage(m[a]),g[a]&&g[a]()}},closeClbk:function(){l.url.v.includes(v.app.peertubeHandler.peertubeId)||(r.peertube.removeClass("disabledShare"),r.peertubeLiveStream.removeClass("disabledShare"))}},clbk:function(e){s=e}}),!0)})),"addStream"===n&&(r.peertubeLiveStream.addClass("disabledShare"),r.peertube.addClass("disabledShare"),v.app.peertubeHandler.authentificateUser(function(e){return(e=e||{}).error?(r.peertubeLiveStream.removeClass("disabledShare"),r.peertube.removeClass("disabledShare"),sitemessage(e.error)):(v.nav.api.load({open:!0,id:"streampeertube",inWnd:!0,history:!1,essenseData:{storage:t,value:a,currentLink:l.url?l.url.v:"",actions:{added:function(e){var a="url";console.log("Finished!",e,new Date);e=l[a].set(e);i.share||f.save(),!e&&m[a]&&sitemessage(m[a]),g[a]&&g[a]()}},closeClbk:function(){r.peertubeLiveStream.removeClass("disabledShare"),l.url.v.includes(v.app.peertubeHandler.peertubeId)||r.peertube.removeClass("disabledShare")}},clbk:function(e){s=e}}),!0)})),"article"!=n?"times"!=n?"url"!=n&&"images"!=n||(c=!0,v.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:n,storage:t,value:a,on:{added:function(e){var t=!0;"url"==n&&e&&d.checkUrlForImage(e)&&(n="images"),_.isArray(e)||(e=[e]),_.each(e,function(e,a){t=l[n].set(e),i.share||f.save()}),!t&&m[n]&&sitemessage(m[n]),g[n]&&g[n]()}}},clbk:function(e,a){s=a}})):dialog({html:v.app.localization.e("e14002"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),success:function(){l.clear(),l.language.set(v.app.localization.key),h()},fail:function(){}}):v.nav.api.load({open:!0,id:"articles",inWnd:!0,history:!0,essenseData:{storage:t,value:a,on:{added:function(e){}}},clbk:function(e){s=e}})},addTag:function(e){l.tags.set(e)?(r.error.html(""),i.share||f.save()):r.error.html(v.app.localization.e("e13162"))},editImage:function(e){var a=_.map(l.images.v,function(e,a){return{original:e,index:a}}),n=_.filter(a,function(e){if(-1<e.original.indexOf("data:image"))return!0});c=!0,v.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:n,close:function(){setTimeout(function(){c=!1},200)},success:function(e,a){_.each(l.images.v,function(e,a){var t=_.find(n,function(e){if(e.index==a)return!0});t&&(l.images.v[a]=t.original)}),i.share||f.save(),g.images(a)}}})},removeImage:function(t){var e=l.images.v.splice(t,1)[0];r.c.find(".imageContainer").each(function(){var e=$(this),a=e.attr("value");t<a&&e.attr("value",a-1),a==t&&e.remove()}),r.c.find(".imagesEmbWr").isotope();var a=(a=r.eMessage[0].emojioneArea.getText()).split(e).join("");r.eMessage[0].emojioneArea.setText(a),i.share||f.save()},removePoll:function(){l.poll.set(),i.share||f.save()},removelink:function(){var e=l.url.v;e.includes(v.app.peertubeHandler.peertubeId)&&(v.app.peertubeHandler.removeVideo(e),r.peertube.removeClass("disabledShare"),r.peertubeLiveStream.removeClass("disabledShare")),l.url.set();var a=(a=r.eMessage[0].emojioneArea.getText()).split(e).join("");r.eMessage[0].emojioneArea.setText(a),i.share||f.save()},removeTag:function(e){l.tags.remove(e);var a=(a=r.eMessage[0].emojioneArea.getText()).split("#"+e).join(e);r.eMessage[0].emojioneArea.setText(a),i.share||f.save()},applyText:function(e){l.message.set(e)},caption:function(e){l.caption.set(e)},linksFromText:function(e){l.url.v||(e=e.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%|_\+.~#/?&//=]*)?/gi))&&0<e.length&&_.each(e,function(e){d.checkUrlForImage(e)?-1==l.images.v.indexOf(e)&&(l.images.set(e),g.images()):l.url.v||(l.url.set(e),g.url())})},tagsFromText:function(e){e=e.split(n),e=_.filter(e,function(e){if("#"==e[0])return!!(e=e.replace(/#/g,""))&&!l.tags.have(e)});e.length&&(_.each(e,function(e){e=e.replace(/\#/g,""),l.tags.set(e)}),g.tags())},post:function(n,e){if(r.postWrapper.removeClass("showError"),i.hash==l.shash())return r.postWrapper.addClass("showError"),void r.error.html(v.app.localization.e("e13163"));r.c.addClass("loading"),topPreloader(50),l.uploadImages(v.app,function(){v.sdk.node.transactions.create.commonFromUnspent(l,function(e,a){if(topPreloader(100),r.c.removeClass("loading"),e){try{var t=new pShare;t._import(e,!0),t.temp=!0,t.address=e.address,l.aliasid&&(t.edit="true"),l.time&&(t.time=l.time),v.app.platform.sdk.node.shares.add(t),i.notClear||(l.clear(),v.app.nav.api.history.removeParameters(["repost"]),i.share||f.save(),h())}catch(e){console.log(e)}v.app.platform.sdk.user.get(function(e){e.postcnt++}),p=!1,i.post?i.post():isMobile()?v.app.nav.api.load({open:!0,href:"index",history:!0}):_scrollTop(0),n&&n(!0),d.unfocus(),successCheck()}else n?n(!1,m[a]):(r.postWrapper.addClass("showError"),(a=v.app.platform.errorHandler(a,!0))&&r.error.html(a))},e)})},error:function(e){var a=l.validation();return d.toggleTimesDisplay(),a&&!e?(r.postWrapper&&r.postWrapper.addClass("showError"),r.error.html(m[a]),"message"==a&&r.c.find(".emojionearea-editor").focus(),"tags"==a&&r.c.find(".tgs input").focus(),!0):(r.postWrapper&&r.postWrapper.removeClass("showError"),r.error.html(""),!1)},eTextChange:function(e){e=e.getText();d.tagsFromText(e),d.applyText(e),d.linksFromText(e),g.caption(),i.share||f.save()}},m={message:v.app.localization.e("emptymessage"),tags:v.app.localization.e("emptytags"),images:v.app.localization.e("maximages"),url:v.app.localization.e("e13164"),error_video:v.app.localization.e("e13165")},u={unfocus:function(e){r.c.hasClass("focus")&&!c&&0===r.c.has(e.target).length&&d.unfocus()},selectTime:function(){var e=new Date,e={day:null,hour:(e=e.addMinutes(10)).getHours(),minutes:e.getMinutes()};i.time&&(e.day=i.time.yyyymmdd(),e.hour=i.time.getHours(),e.minutes=i.time.getMinutes()),v.fastTemplate("sharedate",function(e){dialog({html:e,btn1text:v.app.localization.e("daccept"),class:"one sharedate",clbk:function(e){},wrap:!0,success:function(e){var a=e.el.find(".day").val(),t=e.el.find(".hours").val(),e=e.el.find(".minutes").val(),a=strToDateSmall(a);return a=(a=a.addHours(t)).addMinutes(e),new Date<a?(i.time=a,r.selectTime.find(".selectedTime").html(convertDate(dateToStr(a))),i.selectTime&&i.selectTime(a),!0):(sitemessage(v.app.localization.e("pastdate")),!1)}})},{date:e})},changePostTime:function(){var e=$(this),a=$(this).val();"p"!=a?("t"==a&&(d.error()?e.val("w"):i.time&&i.time<new Date&&(i.time=null,r.selectTime.find(".selectedTime").html(v.app.localization.e("timenotselected")),i.selectTime&&i.selectTime(null))),a=$(this).val(),i.type&&i.type(a)):dialog({html:v.app.localization.e("sharenow"),btn1text:v.app.localization.e("dyes"),btn2text:v.app.localization.e("dno"),success:function(){i.type&&i.type(a)},fail:function(){e.val("w")}})},changeAddress:function(){var e=$(this).val(),a=r.c.find(".usericon"),t=deep(app,"platform.sdk.users.storage."+e+".image")||"";t?(a.html(""),a.attr("image",t),bgImages(r.c.find(".icon"))):(a.html('<svg width="30" height="30" data-jdenticon-value="'+e+'"></svg>'),a.attr("image",""),a.css("background","#F9F6F6"),a.css("background-image",""),a.css("background-size",""),a.css("background-position",""),a.css("background-repeat",""),r.c.find("[data-jdenticon-value]").each(function(){var e=$(this),a=e.data("jdenticon-value");e.html(jdenticon.toSvg(a,e.width()))})),i.address&&i.address(e)},change:function(){d.error(!0),d.autoFilled()},post:function(){d.error()||d.post()},embeding:function(){var e=$(this).attr("embeding");"language"!=e?"poll"!=e?"embeding20"==e?d.embeding20():d.embeding(e):dialog({header:"Create new poll",class:"one joinbeta",poll:!0,btn1text:"Create",success:function(){var e=$(".dialog .poll"),a=e.find(".title .input").val(),e=e.find(".poll-item .input").map(function(e,a){return $(a).val()}).filter(function(e,a){return a}),a={title:a,list:e=Array.from(e)};l.poll.set(a),g.poll(),console.log("create!!!",e,l)}}):d.language()},addTag:function(e){d.addTag(e),g.tags()},caption:function(){var e=$(this).val();d.caption(e)},eTextChange:function(e,a){d.eTextChange(this)},textChange:function(){var e=$(this).val();d.tagsFromText(e),d.applyText(e),d.linksFromText(e),g.caption()},eText:function(e,a){var t=String.fromCharCode(a.keyCode||a.which),a=this.getText();n.test(t)&&(d.tagsFromText(a),d.linksFromText(a)),d.applyText(a),g.caption(),i.share||f.save()},text:function(e){var a=String.fromCharCode(e.keyCode||e.which),e=$(this).val();n.test(a)&&(d.tagsFromText(e),d.linksFromText(e)),d.applyText(e),g.caption()},removeTag:function(){var e=$(this).closest(".tag").attr("tag");d.removeTag(e),$(this).closest(".tag").remove()},removelink:function(){d.removelink(),g.url()},removePoll:function(){d.removePoll(),g.poll()}},g={postline:function(a){v.shell({name:"postline",el:r.postline,data:{share:l,essenseData:i,lkey:v.app.localization.key}},function(e){r.panel=r.c.find(".panel .item"),r.postWrapper=r.c.find(".postWrapper"),r.changePostTime=r.c.find(".postTime"),r.selectTime=r.c.find(".selectedTimeWrapper"),r.post=r.c.find(".post"),r.times=r.c.find(".panel .times"),r.changePostTime.on("change",u.changePostTime),r.selectTime.on("click",u.selectTime),r.panel.on("click",u.embeding),r.post.on("click",u.post),r.peertube=r.c.find(".peertube"),r.peertubeLiveStream=r.c.find(".peertubeLiveStream"),r.peertube.on("click",async function(){console.log(">>>>>>>>usertoken",v.app.peertubeHandler.userName,v.app.peertubeHandler.password)}),l.url.v.includes(v.app.peertubeHandler.peertubeId)&&(r.peertube.addClass("disabledShare"),r.peertubeLiveStream.addClass("disabledShare")),e.el.find(".cancelediting").on("click",function(){v.closeContainer(),i.close&&i.close()}),d.toggleTimesDisplay(),a&&a()})},tgs:function(a){v.shell({name:"tgs",el:r.tgsWrapperMain,data:{share:l}},function(e){r.tags=r.c.find(".tagsCont"),r.tagSearch=r.c.find(".searchWrapper"),search(r.tagSearch,{placeholder:v.app.localization.e("addtags"),clbk:function(e){},time:0,events:{fastsearch:function(e,a,t){if(t){t=String.fromCharCode(t.keyCode||t.which);if(/[,.!?;:() ]/.test(t))return u.addTag(e.replace(/#/g,"").replace(/ /g,"")),r.tagSearch.find("input").val("").focus(),void a(null)}v.app.platform.sdk.tags.search(e,function(e){g.tagsResults(e,function(e){a(e,function(e,a){e.find(".result").on("click",function(){var e=$(this).attr("result");a.closeResults(),a.clear(),u.addTag(e)}),e.find(".empty").on("click",function(){var e=trim(r.tagSearch.find("input").val());e&&(a.closeResults(),a.clear(),u.addTag(e))})})})})},search:function(e,a,t){e=(e=e.replace(/#/g," ")).split(" "),1==(e=_.filter(e,function(e){return e})).length&&(e=e[0]),u.addTag(e),t.clear(),a&&a()}},last:{get:function(){return[v.app.localization.e("tnews"),v.app.localization.e("timages"),v.app.localization.e("tvideos"),v.app.localization.e("tmarket"),v.app.localization.e("tsport")]},tpl:function(e,a){g.tagsResults(e,function(e){a(e,function(e,a){e.find(".result").on("click",function(){var e=$(this).attr("result");a.closeResults(),a.clear(),u.addTag(e)})})})}}}),a&&a()})},tags:function(a){r.tags&&(r.tags.find(".tag").remove(),v.shell({name:"tags",inner:append,el:r.tags,data:{tags:l.tags.get(),share:l}},function(e){e.el&&e.el.find(".remove").on("click",u.removeTag),a&&a()}))},tagsResults:function(e,a){v.shell({name:"tagsResult",data:{results:e}},function(e){a&&a(e.rendered)})},all:function(){r.eMessage[0].emojioneArea.setText(l.message.v),r.cpt.find("input").val(l.caption.v||""),r.cpt.val(),g.tgs(g.tags),g.url(),g.caption(),g.images(),g.poll(),g.repost(),g.postline()},caption:function(){l.caption.v?r.cpt.hasClass("active")||r.cpt.addClass("active"):r.cpt.removeClass("active")},url:function(e){var a=l.url.v,i=v.app.platform.parseUrl(a),s=v.app.platform.sdk.remote.storage[a];v.shell({name:"url",inner:html,el:r.urlWrapper,data:{url:l.url.v,og:s,remove:!0,share:l}},function(t){var n;l.url.v&&!s?"youtube"==i.type||"vimeo"==i.type||"bitchute"==i.type||"peertube"==i.type?Plyr.setup(".js-player",function(e){e.muted=!1}):v.app.platform.sdk.remote.get(i.url,function(e){e&&g.url()}):s&&(n=t.el.find("img"),t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,a){e.isLoaded?($(n[a]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(n[a]).closest(".image").css("display","none")})}),t.el.find(".removeImage").on("click",function(){c=!0,l.settings.image="r",g.url(),f.save(),setTimeout(function(){c=!1},200)})),t.el.find(".removelink").on("click",u.removelink),e&&e()})},images:function(t){v.shell({name:"images",turi:"embeding",inner:html,el:r.images,data:{images:_.map(l.images.v||[],function(e,a){return{src:e,id:a}})}},function(e){e.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");d.removeImage(e)}),e.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");d.editImage(e)}),e.el.find(".image").on("click",function(){var e,a=$(this).attr("i");a&&(e=_.map(l.images,function(e){return{src:e}}),v.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:a,idName:"src",images:e}}))}),e.el.find(".image").imagesLoaded({background:!0},function(e){var a;isMobile()?(t&&t(),r.images.addClass("active")):((a=r.images.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:20},initLayout:!1}),a.on("arrangeComplete",function(){t&&t(),r.images.addClass("active")}),a.isotope())})})},repost:function(a){var t=l.repost.v;v.app.platform.sdk.node.shares.getbyid([t],function(){var e=v.app.platform.sdk.node.shares.storage.trx[t];v.shell({name:"repost",inner:html,el:r.repostWrapper,data:{repost:e,share:l,level:0}},function(e){t&&(v.app.platform.papi.post(t,e.el.find(".repostShare"),function(){},{repost:!0,eid:"share"}),e.el.find(".repostCaption").on("click",function(){l.repost.set(),f.save(),v.app.nav.api.history.removeParameters(["repost"]),g.repost(function(){g.tgs(g.tags),g.postline()})})),a&&a()})})},poll:function(e){var a=l.poll.get();console.log("poll",a,r);var t,n=o.el.find(".pollWrapper"),i="",s=a.title;s&&(i+=`<div class="title"><b>${s}</b></div>`),a.list&&a.list.length&&(t='<div class="list">',a.list.forEach(function(e){t+=`<div class="list-item">${e}</div>`}),i+=t+="</div>");i=i?'<div class="poll">'+i+'<div class="removeWrapper"><div class="removelink"><i class="fas fa-times"></i></div></div></div>':"";n.html(i),o.el.find(".pollWrapper").on("click",function(){u.removePoll()})}},f={save:function(){var e;l?((e=l.export(!0)).message==t&&(e.message=""),v.app.settings.set(v.map.id,"currentShare",e)):v.app.settings.set(v.map.id,"currentShare","")},load:function(){var e=v.app.settings.get(v.map.id,"currentShare");return e&&l.import(e),e}},h=function(){g.all()};return{primary:a,post:d.post,make:function(){f.load(),h()},auto:function(){parameters().marticles&&!v.app.nav.wnds.articles&&d.embeding("article",null)},getdata:function(a,e){p=!1,s=null,l=deep(e,"settings.essenseData.share")||new Share(v.app.localization.key),i=deep(e,"settings.essenseData")||{},v.app.platform.sdk.user.get(function(e){i.share||(f.load(),0===e.postcnt&&!l.message.v&&i.hello&&(l.message.v=t,p=!0)),parameters().repost&&l.repost.set(parameters().repost);e={essenseData:i,share:l,postcnt:e.postcnt};a(e)})},destroy:function(){s&&s.module.closeContainer(),s=null,$("html").off("click",u.unfocus),delete v.app.platform.ws.messages.transaction.clbks.share,r.c&&r.c.find(".emojionearea-editor").off("pasteImage"),r={},Sortable&&Sortable.destroy&&Sortable.destroy()},init:function(e){(r={}).c=e.el.find("#"+v.map.id),r.tgsWrapperMain=r.c.find(".tgsWrapperMain"),r.message=r.c.find(".message"),r.eMessage=r.c.find("#emjcontainer"),r.error=r.c.find(".error"),r.urlWrapper=r.c.find(".urlWrapper"),r.caption=r.c.find(".captionshare"),r.cpt=r.c.find(".cpt"),r.images=r.c.find(".imagesWrapper"),r.poll=r.c.find(".pollWrapper"),r.changeAddress=r.c.find(".changeAddress"),r.repostWrapper=r.c.find(".repostWrapper"),r.postline=r.c.find(".postlineWrapper"),function(){r.changeAddress.on("change",u.changeAddress),r.eMessage.emojioneArea({pickerPosition:"bottom",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{change:u.eTextChange,click:u.eTextChange,keyup:u.eText,onLoad:function(e,a){parameters().newshare&&r.c.find(".emojionearea-editor").focus(),r.c.find(".emojionearea-editor").pastableContenteditable(),r.c.find(".emojionearea-editor").on("pasteImage",function(e,a){topPreloader(100),l.images.set(a.dataURL)?g.images&&g.images():sitemessage(m.images)}).on("pasteImageStart",function(){topPreloader(30)}).on("pasteImageError",function(e,a){topPreloader(100)}).on("pasteText",function(e,a){d.eTextChange(r.eMessage[0].emojioneArea)})}}}),r.caption.on("keyup",u.caption),l.on.change.edit=u.change,isMobile()||r.c.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20});var e={animation:150,swapThreshold:.5,draggable:".draggablepart",onUpdate:function(e){var a=[],t=$(n).find(".draggablepart");$.each(t,function(){a.push($(this).attr("part"))}),console.log("na",a),i.share||f.save(),i.changeArrange&&i.changeArrange()},forceFallback:!0,handle:".marker"},n=document.getElementById("sortableBody");n&&!isMobile()&&Sortable.create(n,e),d.autoFilled(),v.app.platform.ws.messages.transaction.clbks.share=d.waitActions,r.c.on("click",function(){r.c.addClass("focus").removeClass("unfocus")}),$("html").on("click",u.unfocus),d.toggleTimesDisplay()}(),h(),e.clbk(null,e),d.waitActions()},wnd:{close:function(){i.close&&i.close()},class:"smallWnd withoutButtons wndsharepost"},id:o._id}}var v=new nModule,n={};return v.run=function(e){var a=v.addEssense(n,t,e);v.init(a,e)},v.stop=function(){_.each(n,function(e){e.destroy()})},v}();"undefined"!=typeof module?module.exports=share:(app.modules.share={},app.modules.share.module=share);
 /*_____*/ 
var embeding20=function(){function a(e){var l,e=deep(e,"history"),i={},t={url:m.app.localization.e("e13103"),imagesLength:m.app.localization.e("e13104")},n=function(e,n){l.c&&(e=l.c.find("."+e+"Part .partPreloader"),n?e.fadeIn(200):e.fadeOut(200))},a=function(e,n){var a={};5<i.images.value.length?sitemessage(t.imagesLength):(a.id=makeid(),a.src=e,i.images.value.push(a),s.images()),n&&n()},o=function(e,n){var a={};resize(e,1080,1080,function(e){e.split(",")[1]&&(5<i.images.value.length?sitemessage(t.imagesLength):(a.id=makeid(),a.base64=e,i.images.value.push(a),s.images())),n&&n()})},u=function(e){removeEqual(i.images.value,{id:e}),s.images()},r=function(){var e=$(this).closest(".imageContainer").attr("value");u(e)},s={url:function(n,a){var i=m.app.platform.parseUrl(n),t=m.app.platform.sdk.remote.storage[n];m.shell({name:"url",inner:html,el:l.url,data:{url:n,og:t,remove:!0},turi:"share"},function(e){n&&!t&&("youtube"==i.type||"vimeo"==i.type||"bitchute"==i.type||"peertube"==i.type?Plyr.setup(".js-player",function(e){}):m.app.platform.sdk.remote.get(i.url,function(e){e&&s.url(n)})),a&&a()})},images:function(e,n){(e=e||i.images.value).length&&m.shell({name:"images",el:l.images,data:{images:e}},function(e){e.el.find(".remove").on("click",r),e.el.find(".image").each(function(){}),n&&n()})}},c=function(){};return{primary:e,getdata:function(e){(i={url:new Parameter({type:"URL",id:"url",placeholder:m.app.localization.e("e13102"),value:""}),images:{isValid:function(){return!0},value:[]}}).url._onChange=function(e){n("left",!0),checkUrlForImage(e)?a(e,function(){n("left",!1),i.url.value="",i.url.el.val("")}):s.url(e,function(){n("left",!1)})},i.images.value=[],i.url.value="",e({options:i})},destroy:function(){l={}},init:function(e){c(),(l={}).c=e.el.find("#"+m.map.id),l.upload=l.c.find(".upload"),l.images=l.c.find(".images"),l.error=l.c.find(".error"),l.url=l.c.find(".url"),ParametersLive([i.url],l.c),initUpload({el:l.upload,ext:["png","jpeg","jpg"],dropZone:l.c.closest(".wnd"),multiple:!0,action:function(e,n){o(e.base64,n)},onSuccess:function(){l.c.addClass("right"),l.c.removeClass("left")}}),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-times"></i> '+m.app.localization.e("close"),fn:function(e,n){}}},close:function(){},success:function(e,n){wndObj=n,wnd=e},noInnerScroll:!0,class:"embeding20"}}}var m=new nModule,i={};return m.run=function(e){var n=m.addEssense(i,a,e);m.init(n,e)},m.stop=function(){_.each(i,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=embeding20:(app.modules.embeding20={},app.modules.embeding20.module=embeding20);
 /*_____*/ 
var lenta=function(){function n(e){function t(){var n,s,a,e;function t(e){var t,n;W||"recommended"==l||d.author||d.search||(n=0,(t=_.toArray(pe.sdk.node.transactions.temp.share||{})).length&&!l&&(n-=t.length),0<(e||0)+n&&(E=E+(e||0)+n,c.c.addClass("showprev"),c.c.find(".countnew").html("("+E+")")))}isMobile()&&m&&(n=c.c.find(".circularprogress"),(s=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),c.c.find(".circularprogressWrapper").html(s.el),a=c.c.find(".loadprev"),e=new SwipeParallax({el:c.c.find(".shares"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var t=Math.abs(e)/200;0<=e&&(s.options.text={value:""},s.update(100*t),n.height(220*t+"px"),a.css("opacity",1-4*t))},constraints:function(){if(0==r.scrollTop()&&!I)return!0},restrict:!0,trueshold:200,clbk:function(){pe.app.platform.sdk.notifications.getNotifications(),M.loadprev(function(){e.renew()})}}}}).init()),window.addEventListener("scroll",O),window.addEventListener("scroll",B),window.addEventListener("resize",N),d.notscrollloading||window.addEventListener("scroll",F),c.c.on("click",".wholikesTable",U),c.c.on("click",".stars i",j),c.c.on("click",".complain",q),c.c.on("click",".imageOpen",J),c.c.on("click",".txid",G),isMobile()||(c.c.on("click",".sharecaption",te),c.c.on("click",".message",te)),c.c.on("click",".showMore",te),c.c.on("click",".forrepost",H),c.c.on("click",".videoTips",ee),c.c.on("click",".videoOpen",ee),c.c.on("click",".exitFull",Y),c.c.on("click",".additional",Z),c.c.on("click",".asubscribe",Q),c.c.on("click",".aunsubscribe",X),c.c.on("click",".notificationturn",K),c.c.on("click",".donate",se),c.c.on("click",".sharesocial",ne),c.c.on("click",".discussion",ae),c.c.on("click",".metmenu",D),c.c.find(".loadmore button").on("click",ie),c.c.find(".loadprev button").on("click",oe),c.c.on("click",".showmorebyauthor",z),c.c.on("click",".commentsAction",R),d.txids||(pe.app.platform.sdk.node.shares.clbks.added.lenta=function(e){console.log("share",e),e.txidEdit?(delete f[e.txidEdit],delete v[e.txidEdit],delete g[e.txidEdit],replaceEqual(w,{txid:e.txidEdit},e)&&re.shares([e],function(){re.sharesInview([e],function(){})},{inner:replaceWith,el:c.shares.find("#"+e.txidEdit),ignoresw:!0})):re.shares([e],function(){re.sharesInview([e],function(){})},{inner:prepend})},pe.app.platform.ws.messages.transaction.clbks.temp=function(t){var e;!t.temp||(e=_.find(w,function(e){if(e.txid==t.temp.txid)return!0}))&&(e.temp=!1,e.scnt="0",e.score="0",e.myVal=0,e.time=new Date,v[e.txid]=!1,re.sharesInview([e],function(){}))},pe.app.platform.ws.messages.event.clbks.lenta=function(t){var e;"upvoteShare"!=t.mesType||!t.share||(e=_.find(w,function(e){if(e.txid==t.share.txid)return!0}))&&re.stars(e,function(){})}),pe.app.platform.clbks._focus.lenta=function(e){window.cordova&&!d.txids&&!o&&120<e&&(M.loadprev(),_scrollTop(0))},pe.app.platform.ws.messages.newblocks.clbks.newsharesLenta=function(e){o||W||d.author||d.txids||t("sub"==l?e.cntsubscr:e.cntposts)},pe.app.platform.ws.messages["new block"].clbks.newsharesLenta=function(e){o||W||d.author||d.txids||t("sub"==l?e.sharesSubscr:deep(e,"sharesLang."+pe.app.localization.key))},pe.app.platform.ws.messages.comment.clbks.lenta=function(e){v[e.posttxid]&&(e=c.c.find("#"+e.posttxid+" .commentsAction .count span")).html(Number(e.html()||"0")+1)},pe.app.platform.clbks.api.actions.subscribe.lenta=function(e){e=c.c.find('.shareTable[address="'+e+'"]');e.addClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},pe.app.platform.clbks.api.actions.subscribePrivate.lenta=function(e){var t=c.c.find('.shareTable[address="'+e+'"]'),n=deep(pe.app,"platform.sdk.users.storage."+pe.user.address.value.toString("hex"));n&&(!(e=n.relation(e,"subscribes"))||"true"!=e.private&&!0!==e.private?t.find(".notificationturn").removeClass("turnon"):t.find(".notificationturn").addClass("turnon")),t.addClass("subscribed")},pe.app.platform.clbks.api.actions.unsubscribe.lenta=function(e){e=c.c.find('.shareTable[address="'+e+'"]');e.removeClass("subscribed"),e.find(".notificationturn").removeClass("turnon")},pe.app.platform.clbks.api.actions.blocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").addClass("blocking")},pe.app.platform.clbks.api.actions.unblocking.lenta=function(e){c.c.find('.shareTable[address="'+e+'"]').closest(".share").removeClass("blocking")}}var c,r,d,l,a,n,s,i=deep(e,"history"),e=e.mid,o=!1,p=!1,u=[],f={},m=!1,v={},g={},b=!1,k=!1,x={},w=[],y=!1,C=0,T=null,E=0,S={},V={},I=!1,P=0,W=null,L=!1,A=!1,M={authclbk:function(){A=!0;var e=_.map(v,function(e,t){return t});pe.app.platform.sdk.node.shares.getbyid(e,function(e){_.each(e,function(e){delete e.myVal}),re.mystars(e,function(){A=!1}),M.subscribeLabels()})},subscribeLabels:function(){_.each(v,function(e,t){t=pe.app.platform.sdk.node.shares.storage.trx[t];t&&M.subscribeLabel(t)})},subscribeLabel:function(e){var t=pe.app.user,n=!1;t.address.value&&e.address==t.address.value||!t.address.value||(t=deep(pe.app,"platform.sdk.users.storage."+t.address.value))&&t.relation(e.address,"subscribes")&&(n=!0),c.c&&(e=c.c.find("#"+e.txid+" .shareTable"),n?e.addClass("subscribed"):e.removeClass("subscribed"))},repost:function(t){M.stateAction("_this",function(){var e="index";isMobile()&&(e="share"),pe.nav.api.load({open:!0,href:e+"?repost="+t,history:!0,handler:!0,essenseData:{}})})},loadprev:function(e){c.c.find(".shares").html('<div class="bspacer"></div>'),c.c.removeClass("showprev"),c.c.removeClass("loading"),c.c.removeClass("sharesEnded"),c.c.removeClass("sharesZero"),M.clear(),de(e)},clear:function(){_.each(v,function(e,t){delete pe.app.platform.sdk.node.shares.storage.trx[t]}),_.each(x,function(e){e.p.destroy()}),_.each(f,function(e){e&&e.destroy()}),_.each(V,function(e){e&&e.destroy()}),V={},A=!(u=[]),v={},g={},S={},k=b=I=!(f={}),W=T=n=null,loaded=k=L=y=!(w=[]),o=!(x={}),E=C=P=0},next:function(t,n){var e=nextElH(w,function(e){if(e.txid==t)return!0});e?n&&n(e.txid):k?n&&n(null):M.loadmore(function(e){n&&n(deep(e,"0.txid")||null)})},loadmore:function(n){le.shares(function(e,t){return t?(o=!1,pe.app.errors.connection()&&c.c.addClass("networkError"),void(pe.app.errors.connectionRs()&&(pe.iclbks.lenta=M.loadmore))):(c.c.removeClass("networkError"),e?re.shares(e,function(){re.sharesInview(e,function(){})},{index:w.length}):console.log("IM HERE"),void(n&&n(e)))})},removeAdditionalByScroll:function(){var e;T&&(e=$(window).scrollTop(),150<Math.abs(e-C)&&M.additional(T,!1))},additional:function(e,t){t?(e.addClass("showAdditional"),e.find(".subscribeWrapper").fadeIn(),C=$(window).scrollTop(),T=e,window.addEventListener("scroll",M.removeAdditionalByScroll)):(e.removeClass("showAdditional"),e.find(".subscribeWrapper").fadeOut(),window.removeEventListener("scroll",M.removeAdditionalByScroll))},applyheight:function(e,t,n){var s=r.scrollTop(),a=s+Number(t-e);s==a||e<t||r.scrollTop(a)},applyheightEl:function(e,t,n){if(c&&c.shares&&e&&t.length){var s=t[0].offsetHeight;return t.length&&r.scrollTop()>t.offset().top&&M.applyheight(e,s,n),s}},stateAction:function(t,n){pe.app.user.isState(function(e){e?n():pe.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:pe.app.localization.e("llogin"),successHref:t,signInClbk:function(){retry(function(){return!A},function(){n&&n()})}}})})},initVideo:function(e,t){var n,s;pe.app.platform.sdk.usersettings.meta.embedvideo&&!pe.app.platform.sdk.usersettings.meta.embedvideo.value||(n=e.find(".js-player"),s=e.find(".videoWrapper"),n.length&&(e={muted:!0,resetOnEnd:!0,controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],speed:{selected:1,options:[1]}},"a"==t.settings.v&&(e.muted=!1,e.autoplay=!1),isMobile()&&(e.controls=["play","progress","current-time","fullscreen"]),PlyrEx(n[0],e,function(e){x[t.txid]||(x[t.txid]={}),x[t.txid].p=e,x[t.txid].initing=!0,x[t.txid].el=s,x[t.txid].id=s.attr("pid"),e.on("ready",function(){x[t.txid]&&(n.find("iframe").attr("disable-x-frame-options","disable-x-frame-options"),x[t.txid].inited=!0)})})))},openPost:function(n,s){var e;isMobile()?(e=pe.app.platform.sdk.node.shares.storage.trx[n],delete f[n],re.share(e,null,!0)):pe.app.user.isState(function(e){var t={share:n,hr:d.hr,like:function(e){re.stars(e)},next:M.next,close:function(){d.renderclbk&&d.renderclbk()}};pe.nav.api.load({open:!0,href:"post?s="+n,inWnd:!0,history:!0,clbk:function(){d.renderclbk&&d.renderclbk(),s&&s()},essenseData:t})})},sharesocial:function(e,t){var n,s,a,i=pe.app.platform.sdk.node.shares.storage.trx[e];i&&(s="",pe.app.platform.sdk.address.pnet()&&(s="&ref="+pe.app.platform.sdk.address.pnet().address),n="https://bastyon.com/"+(d.hr||"index?")+"s="+e+"&mpost=true"+s,parameters().address&&(n+="&address="+(parameters().address||"")),e=i.message,s=trimHtml(e,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),(e=i.images[0])||!i.url||(a=videoImage(i.url))&&(e=a),a="Post","a"==i.settings.v&&(a="Article"),pe.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:n,caption:pe.app.localization.e("e13133")+" "+a,image:e||deep(app,"platform.sdk.usersl.storage."+i.address+".image"),title:i.caption||deep(app,"platform.sdk.usersl.storage."+i.address+".name"),text:s}}))},donate:function(e,t){var n,s=pe.app.platform.sdk.node.shares.storage.trx[e];s&&(e=deep(app,"platform.sdk.usersl.storage."+s.address)||{address:s.address,addresses:[]},n="send?address="+s.address+"&amount=1&message="+hexEncode(pe.app.localization.e("postlabel")+" &mdash; "+(s.caption||s.message).substr(0,20)+"...")+"&label="+(e.name||e.address)+"&setammount=true",pe.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:pe.app.localization.e("dcancel"),clbk:function(e,t){e.find(".pnetdnt").on("click",function(){pe.nav.api.load({open:!0,href:n,history:!0}),t.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(pe.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:e}))},videoPosition:function(e){var t=e.find(".work");e.hasClass("fullScreenVideo")&&0<(e=($(window).height()-(e.find(".videoWrapper").height()+100))/2)?t.css("margin-top",e+"px"):t.css("margin-top","0px")},fullScreenVideoMobile:function(e){x[e]&&(x[e].p.fullscreen.enter(),x[e].p.playing||x[e].p.play(),x[e].p.muted=!1)},fullScreenVideo:function(e,t){var n;x[e]&&((n=c.c.find("#"+e)).addClass("fullScreenVideo"),M.videoPosition(n),pe.app.nav.api.history.addParameters({v:e}),(n=x[e]).p.playing||n.p.play(),n.p.muted=!1,p=!pe.app.actions.offScroll(),f[e]&&f[e].changein(c.c.find("#"+e),0),re.comments(e,!1,!0),I=!0,t&&t())},exitFullScreenVideo:function(e){var t=c.c.find("#"+e);t.removeClass("fullScreenVideo"),M.videoPosition(t),x[e].p.muted=!0,pe.app.nav.api.history.removeParameters(["v"]),pe.app.actions.onScroll(),I=!1,f[e]&&(f[e].changein(null),f[e].hideall(!0))},postscores:function(e,t){pe.app.nav.api.load({open:!0,href:"postscores?p="+e,inWnd:!0,history:!0,essenseData:{share:e,like:function(e){re.stars(e)}},clbk:function(){t&&t()}})},like:function(n,e,s){var a=n.upvote(e);if(!a)return pe.app.platform.errorHandler("4",!0),void(s&&s(!1));pe.sdk.node.transactions.create.commonFromUnspent(a,function(e,t){topPreloader(100),e?s&&s(!0):(a.myVal=null,n.myVal=0,pe.app.platform.errorHandler(t,!0),s&&s(!1))})},block:function(e,t){},complain:function(e){pe.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:pe.app.platform.sdk.node.shares.storage.trx[e],success:function(){}},clbk:function(){}})},openGalleryRec:function(n,s,a){var i=[],o=function(e,t){_.each(e.images,function(e){i.push(e)}),e.repost?pe.app.platform.sdk.node.shares.getbyid(e.repost,function(e){e=e[0];e?o(e,t):t&&t()}):t&&t()};o(n,function(){var e=_.map(i,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==s)return!0});(1<e.length||n.url&&e.length&&parseVideo(n.url).type||!isMobile())&&pe.app.nav.api.load({open:!0,href:"imagegallery?i="+n.txid+"&num="+(t||0),inWnd:!0,history:!0,essenseData:{initialValue:s,idName:"src",images:e,gid:n.txid},clbk:function(){a&&a()}})})},openGallery:function(e,t,n){var s=_.map(e.images,function(e){return{src:e}}),a=findIndex(s,function(e){if(e.src==t)return!0});(1<s.length||e.url&&s.length&&parseVideo(e.url).type||!isMobile())&&pe.app.nav.api.load({open:!0,href:"imagegallery?i="+e.txid+"&num="+(a||0),inWnd:!0,history:!0,essenseData:{initialValue:t,idName:"src",images:s,gid:e.txid},clbk:function(){n&&n()}})},videosInview:function(e,a,i){var o=_.filter(e,function(e){if(e.inited&&!e.playing&&!e.stopped&&e.el)return!0});o.length&&(n=slowMade(function(){o=_.filter(o,function(e){return e.el});_.map(o,function(e){return e.el[0]});var e=inView(c.c.find(".videoWrapper"),{offset:$(window).height()/10,mode:"all"}),t=null;if(0<e.length){var n=$(e[0]),t=n.attr("pid"),s=_.find(o,function(e){return e.id==t});if(!t||!s)return;s&&setTimeout(function(){inView(n,{offset:-100,mode:"all"}).length&&a(s,n)},320)}e=_.filter(o,function(e){return e.id!=t});e.length&&i(e)},n,30))},scrollToPost:function(e){_scrollTo($("#"+e))},sharesInview:function(a,i,o){r.scrollTop();a.length&&!y&&(s=slowMade(function(){var n,e=c.c.find(".share"),t=r,s=$(window).height()/4,t=inView(e,{inel:t,offsetTop:s,offsetBottom:s});0<t.length&&(n={},s=_.map(t,function(e){var t=$(e).attr("id");return n[t]=!0,_.find(a,function(e){return e.txid==t})}),s=_.filter(s,function(e){if(e&&!e.temp)return!0}),i(s,t,function(){var e;o&&(e=_.filter(a,function(e){if(!n[e.txid])return!0}),o(e))}))},s,30))}},H=function(){var e=$(this).closest(".share").attr("id");M.repost(e)},z=function(){$(this).closest(".authorgroup").find(".share").removeClass("hidden"),$(this).remove(),re.sharesInview(w,function(e){},function(){})},D=function(){var e=$(this),t=$(this).closest(".share").attr("id");pe.app.platform.api.metmenu(e,t,M)},N=function(){var e=c.c.find(".fullScreenVideo");0<e.length&&M.videoPosition(e)},F=function(){$(window).scrollTop()+$(window).height()>c.c.height()-400&&!b&&!k&&"recommended"!=l&&M.loadmore()},O=function(e){M.sharesInview(w,function(e,t,n){var s=_.filter(e,function(e){return!v[e.txid]});d.contents&&0<s.length&&(d.beginmaterial=e[0].txid,le.shares(function(e){re.sharesInview(e,function(){})})),_.each(e,function(e){c.c.find("#"+e.txid).addClass("vstars")}),n&&n()},function(e){_.each(e,function(e){c.c.find("#"+e.txid).removeClass("vstars")})})},B=function(e){M.videosInview(x,function(e,t,n){pe.app.platform.sdk.usersettings.meta.videoautoplay&&!pe.app.platform.sdk.usersettings.meta.videoautoplay.value||t.closest(".share").hasClass("showAdditional")||e.p.play()},function(e){_.each(e,function(e){e.p.muted=!0,e.p.playing&&e.p.stop()})})},R=function(){var e=$(this).closest(".share").attr("id");re.comments(e,!0)},G=function(){var e=$(this).closest(".share").attr("id");pe.app.platform.sdk.node.transactions.get.tx(e)},U=function(){var e=$(this).closest(".share").attr("id");M.postscores(e)},j=function(){var e,n,s=$(this).closest(".stars");s.attr("value")||(e=$(this).closest(".share").attr("id"),n=$(this).attr("value"),M.stateAction("_this",function(){pe.app.platform.sdk.node.shares.getbyid(e,function(){var t=pe.app.platform.sdk.node.shares.storage.trx[e];pe.app.platform.sdk.address.pnet()&&t.address==pe.app.platform.sdk.address.pnet().address||(s.attr("value",n),s.addClass("liked"),M.like(t,n,function(e){e?(t.scnt||(t.scnt=0),t.score||(t.score=0),t.scnt++,t.score=Number(t.score||0)+Number(n),e=Number(t.score)/Number(t.scnt),s.find(".tstarsov").css("width",e/5*100+"%"),s.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),re.stars(t)):(s.removeAttr("value"),s.removeClass("liked"))}))})}))},q=function(){var e=$(this).closest(".share").attr("id");M.complain(e)},Z=function(){var e=$(this).closest(".share");M.additional(e,!e.hasClass("showAdditional"))},J=function(){var e,t=$(this).closest(".shareinlenta").attr("id"),n=$(this).attr("i"),s=pe.app.platform.sdk.node.shares.storage.trx[t];s||(e=_.find(pe.sdk.node.transactions.temp.share,function(e){return e.txid==t}),(s=new pShare)._import(e),s.temp=!0,s.address=pe.app.platform.sdk.address.pnet().address),M.openGalleryRec(s,n)},K=function(){var e=$(this),t=e.hasClass("turnon"),e=e.closest(".shareTable").attr("address"),t=t?"notificationsTurnOff":"notificationsTurnOn";pe.app.platform.api.actions[t](e,function(e,t){e||pe.app.platform.errorHandler(t,!0)})},Q=function(){var e=$(this).closest(".shareTable").attr("address");$(this).closest(".share");M.stateAction("_this",function(){pe.app.platform.api.actions.subscribeWithDialog(e,function(e,t){e||pe.app.platform.errorHandler(t,!0)})})},X=function(){var e=$(this).closest(".shareTable").attr("address"),n=$(this).closest(".share");dialog({html:pe.app.localization.e("e13022"),btn1text:pe.app.localization.e("unsub"),btn2text:pe.app.localization.e("ucancel"),class:"zindex",success:function(){pe.app.platform.api.actions.unsubscribe(e,function(e,t){e?n.find(".shareTable").removeClass("subscribed"):pe.app.platform.errorHandler(t,!0)})}})},Y=function(){var e=$(this).closest(".share").attr("id");M.exitFullScreenVideo(e)},ee=function(){var e=$(this).closest(".share").attr("id");M.fullScreenVideo(e)},te=function(e){deep(e,"target.href")||(e=$(this).closest(".shareinlenta").attr("id"),M.openPost(e))},ne=function(){var e=$(this).closest(".shareinlenta").attr("id");M.sharesocial(e)},se=function(){var e=$(this).closest(".share").attr("id");M.donate(e)},ae=function(){var e=$(this).closest(".share").attr("id"),t=pe.app.platform.sdk.node.shares.getWithTemp(e);isMobile()?pe.nav.api.load({open:!0,id:"discussions",history:!0,clbk:function(){pe.app.platform.sdk.chats.add(e+"_"+t.address,"share")}}):pe.app.platform.sdk.chats.add(e+"_"+t.address,"share")},ie=function(){M.loadmore()},oe=function(){M.loadprev()},re={comments:function(n,s,a,i){var o,r;d.nocomments||f[n]||c.c&&(o=c.c.find("#"+n+" .commentsWrapper"),r=deep(pe.app.platform,"sdk.node.shares.storage.trx."+n),setTimeout(function(){pe.fastTemplate("commentspreview",function(e){var t;c.c&&(t="",pe.app.platform.sdk.address.pnet()&&(t="&ref="+pe.app.platform.sdk.address.pnet().address),t="https://bastyon.com/"+(d.hr||"index?")+"s="+n+"&mpost=true"+t,parameters().address&&(t+="&address="+(parameters().address||"")),pe.nav.api.load({open:!0,id:"comments",el:o,eid:n+"lenta",essenseData:{close:function(){f[n]&&f[n].hideall(!0),_scrollToTop(o,0,0,-65)},totop:c.c.find("#"+n),caption:e,send:function(){var e=c.c.find("#"+n+" .commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:n,init:s,showall:a,preview:i,lastComment:r.lastComment,count:r.comments,hr:t,renderClbk:function(){d.renderclbk&&d.renderclbk()}},clbk:function(e,t){c.c&&((e=c.c.find("#"+n)).hasClass("fullScreenVideo")&&t.changein(e,0),t&&(f[n]=t),d.renderclbk&&d.renderclbk())}}))},{share:r})},30))},roomsinfo:function(e){_.each(e,function(e){var t=deep(pe.app.platform,"rtc.storage.info."+e+".d.users_count"),e=e.split("_")[0];void 0!==t&&c.c&&c.c.find("#"+e+" .discussion .count").html((t=t)?"<b>"+t+"</b>":"")})},shareSpacers:function(e){_.each(e,function(e){re.shareSpacer(e)})},shareSpacer:function(e){var t,n;v[e.txid]&&!g[e.txid]&&(n=(t=c.shares.find("#"+e.txid)).find(".work").outerHeight(),x[e.txid]&&x[e.txid].inited&&(x[e.txid].p.destroy(),x[e.txid].el=null,x[e.txid].inited=!1),v[e.txid]=!1,c.shares.css("height",c.shares.outerHeight()),t.html('<div class="shareSpacer added"></div>'),t.find(".shareSpacer").outerHeight(n),S[e.txid]=M.applyheightEl(S[e.txid],t,"space"))},share:function(t,n,e){var s=c.shares.find("#"+t.txid);S[t.txid]=0,s[0]&&(S[t.txid]=s[0].offsetHeight);s.find(".added");g[t.txid]=!0,pe.shell({name:"share",el:s,data:{share:t,ed:d,mestate:a,all:e||!1}},function(e){s.find(".work");v[t.txid]=!0,S[t.txid]=M.applyheightEl(S[t.txid],s,"share"),re.stars(t),t.temp||re.comments(t.txid,!1,!1,!0),re.repost(e.el,t.repost,t.txid,t.isEmpty()),re.url(e.el.find(".url"),t.url,t,function(){re.urlContent(t,function(){d.searchValue&&e.el.find(".canmark").mark(d.searchValue),M.initVideo(e.el,t),g[t.txid]=!1,n&&n()})}),re.images(t,function(){})})},mystars:function(e,t){var n=_.filter(e,function(e){if(void 0===e.myVal)return!0}),n=_.map(n,function(e){return e.txid});pe.app.platform.sdk.likes.get(n,function(){_.each(e,function(e){re.stars(e),re.wholike(e)}),t&&t()})},wholike:function(e,t){var n,s;!c.shares||(n=c.shares.find("#"+e.txid)).length&&(s=e.who,pe.shell({name:"wholike",el:n.find(".wholikes"),data:{scores:Number(e.scnt),wholikes:s||[]},bgImages:{}},function(e){t&&t()}))},stars:function(e,t){var n;!c.shares||(n=c.shares.find("#"+e.txid)).length&&pe.shell({name:"stars",el:n.find(".forstars"),data:{share:e}},function(e){fastars(e.el.find(".stars")),t&&t()})},sharesInview:function(e,t){e=_.filter(e,function(e){return!$("#"+e.txid).hasClass("hidden")});var n=_.sortBy(e,function(e){return-e.time});lazyEach({array:n,action:function(e){var t=e.item;v[t.txid]?e.success():(v[t.txid]=!0,re.share(t,e.success))},sync:isMobile(),all:{success:function(){re.mystars(e),t()}}})},shares:function(t,n,e){(e=e||{}).inner||(e.inner=append);var s="groupshares";(d.author||l||d.txids||d.search)&&(s="shares"),"recommended"==l&&(t=_.sortBy(t,function(e){return-e.time})),e.ignoresw||(t=_.filter(t,function(t){return!_.find(w,function(e){return e.txid==t.txid})})),pe.shell({name:s,inner:e.inner,el:e.el||c.shares,data:{shares:t||[],index:e.index||0},animation:!1},function(e){e.inner==append?w=w.concat(t):e.inner!=replaceWith&&(w=t.concat(w)),w=_.uniq(w,function(e){return e.txid}),d.renderclbk&&d.renderclbk(),n&&n()})},videoPreview:function(e,t){var n,s=c.c.find("#"+e.txid);"a"==e.settings.v?(s=s.find("[data-plyr-provider][data-plyr-embed-id]"),n=[],$.each(s,function(){var e=$(this),e={type:e.attr("provider"),id:e.attr("eid")};n.push(videoImage(e))})):t&&t()},images:function(n,s){var a,o,r,l=n;c.c&&(a=c.c.find("#"+n.txid),o=a.find(".image"),!(r=a.find(".images")).hasClass("active")&&o.length&&r.length?o.imagesLoaded({background:!0},function(i){"a"!=n.settings.v&&_.each(i.images,function(e,t){var n=e.img,s=$(i.elements[t]).closest(".imagesWrapper"),a="",e=s.width();s.height();n.width>n.height&&!isMobile()&&(a="w2",(t=e*(n.width/n.height))>r.width()&&(t=r.width(),h=t*(n.height/n.width),s.height(h)),s.width(t)),(n.height>n.width||isMobile())&&(a="h2",s.height(e*(n.height/n.width))),a&&s.addClass(a)}),S[l.txid]=M.applyheightEl(S[l.txid],a);function e(){r.addClass("active"),o.addClass("active"),S[l.txid]=M.applyheightEl(S[l.txid],a),d.renderclbk&&d.renderclbk(),s&&s()}var t;"a"!=n.settings.v&&1<i.images.length?(t=20,isMobile&&(t=5),r.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:t},initLayout:!1}),r.on("arrangeComplete",function(){e()}),r.isotope()):e()}):s&&s())},repost:function(e,t,n,s,a){t&&pe.shell({name:"repost",el:e.find(".repostWrapper"),data:{repost:t,share:deep(pe.app.platform,"sdk.node.shares.storage.trx."+n),level:1}},function(e){e.el&&e.el.length&&pe.app.platform.papi.post(t,e.el.find(".repostShare"),function(e){V[n]=e},{repost:!0,eid:n+"lenta",level:1,fromempty:s})})},url:function(e,t,a,i){var n,o;d.nourlload?i&&i():(n=pe.app.platform.sdk.remote.storage[t],o=e.closest(".share"),pe.shell({turi:"share",name:"url",el:e,data:{url:t,og:n,share:a}},function(n){pe.app.nav.api.links(null,n.el,function(e){e.stopPropagation()}),S[a.txid]=M.applyheightEl(S[a.txid],o,"url");var s=n.el.find("img");d.renderclbk&&d.renderclbk(),n.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,t){e.isLoaded?($(s[t]).addClass("active"),500<e.img.naturalWidth&&n.el.addClass("bigimageinlink")):$(s[t]).closest(".image").css("display","none")}),S[a.txid]=M.applyheightEl(S[a.txid],o,"url"),d.renderclbk&&d.renderclbk()}),i&&i()}))},urlContent:function(t,n){var s,a,e,i;c.c&&((s=t.url)?(a=c.c.find("#"+t.txid+" .url"),e=pe.app.platform.parseUrl(s),i=pe.app.platform.sdk.remote.storage[s],!s||i||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?n&&n():pe.app.platform.sdk.remote.get(s,function(e){e?re.url(a,s,t,n):n&&n()})):n&&n())},urlsContent:function(e){_.each(e,function(e){re.urlContent(e)})},urls:function(e,t){lazyEach({array:e,sync:!0,action:function(e){re.url(e.item.el,e.item.url,e.item.share,e.success)},all:{success:function(){t&&t()}}})},spacers:function(e,t){e=_.map(e,function(e){return{txid:e,author:d.author}});this.shares(e,t,{noview:!0})}},le={recomended:function(t,n){c.loader.fadeIn(),c.c.addClass("loading"),u=[],d.author||W?t&&t(u):pe.app.platform.sdk.node.shares.recomended({},function(e){u=_.filter(e,function(t){if(!_.find(n,function(e){if(e.txid==t)return!0}))return!0}),pe.app.platform.sdk.node.shares.users(e,function(){t&&t(u)})})},txids:function(e,t){L?t([]):pe.app.platform.sdk.node.shares.getbyid(e,function(e){L=!0,t(e)})},begin:function(t){!W||L||l&&"sub"!=l?t([]):pe.app.platform.sdk.node.shares.getbyid(W,function(e){L=!0,t(e)})},sstuff:function(n,s,a,i){var o=d.author;pe.app.platform.sdk.node.shares.users(n,function(e,t){P+=n.length,b=!1,c.c&&(s||t||n&&n.length&&!(n.length<a.count)&&"recommended"!=l||(W||P?(n.length<a.count||"recommended"==l)&&(l||o||d.search)&&setTimeout(function(){c.c&&c.c.addClass("sharesEnded")},1e3):c.c.addClass("sharesZero"),n.length<a.count&&(l||o||d.search)&&(k=!0)),c.loader.fadeOut(),i&&i(n,s||t))})},shares:function(i,o){b||k&&(!d.contents||d.txids.length==_.toArray(v).length)||(c.loader.fadeIn(),c.c.addClass("loading"),b=!0,d.loader?d.loader(function(e,t,n){le.sstuff(e,t,n,i)}):pe.app.user.isState(function(a){le.begin(function(s){var e=d.author,t="common",n=W;if(l)if("recommended"==l)t="recommended";else if("b"==l)t="getbyidsp",n=d.beginmaterial;else if(t="common",e="1",!a)return void le.sstuff([],null,{count:0},i);d.txids&&"b"!=l&&(t="txids"),pe.app.platform.sdk.node.shares[t]({author:e,begin:n||"",txids:d.txids},function(t,e,n){_.each(s,function(e){e&&t.unshift(e)}),d.filter&&(t=_.filter(t,d.filter)),le.sstuff(t,e,n,i),"b"==l&&(W="")},o)})}))}},ce=function(){},de=function(s,a){var e="clear",n=o=!0;d.goback&&(e="cache"),d.contents&&(c.c.find(".shares").html(""),re.spacers(d.txids,function(){M.scrollToPost(d.beginmaterial)}),n=!1),le.shares(function(e,t){return t?(o=!1,pe.app.errors.connection()&&c.c.addClass("networkError"),void(pe.iclbks.lenta=function(){de(null,a)})):(c.c.removeClass("networkError"),void(e?(W&&!l&&c.c.addClass("showprev"),n&&c.c.find(".shares").html(""),re.shares(e,function(){re.sharesInview(e,function(){o=!1,O();var e,t,n=parameters();n.s&&M.openPost(n.s,function(){M.scrollToPost(n.p)}),n.i&&(t=null,(e=deep(pe.app.platform,"sdk.node.shares.storage.trx."+n.i))&&(n.num&&(t=deep(e,"images."+n.num)),M.openGalleryRec(e,t))),n.v&&(M.scrollToPost(n.v),M.fullScreenVideo(n.v,function(){})),n.p&&M.postscores(n.p,function(){M.scrollToPost(n.p)}),s&&s(),d.goback&&a.clbk&&(d.goback=!1,a.clbk(null,a))})})):o=!1))},e)};return{id:e,primary:i,getdata:function(n,e){p=!1,E=0,f={},d=e.settings.essenseData||{},M.clear();e=parameters();W=e.s||e.i||e.v||e.p||null,l=e.r||!1,void 0!==d.r&&null!=d.r&&(l=d.r),d.txids&&"b"!=l&&(l=!1),m=!d.txids||!1,pe.app.platform.sdk.ustate.me(function(e){a=e||{};var t={beginmaterial:W,author:d.author,recommended:l};pe.loadTemplate({name:"share"},function(){pe.loadTemplate({turi:"share",name:"url"},function(){pe.loadTemplate({name:"stars"},function(){n(t)})})})})},destroy:function(){_.each(v,function(e,t){delete pe.app.platform.sdk.node.shares.storage.trx[t]}),_.each(x,function(e){e.p.destroy()}),p&&pe.app.actions.onScroll(),_.each(f,function(e){e.destroy()}),f={},delete pe.iclbks.lenta,delete pe.app.platform.ws.messages.comment.clbks.lenta,delete pe.app.platform.sdk.node.shares.clbks.added.lenta,delete pe.app.platform.ws.messages.transaction.clbks.temp,delete pe.app.platform.ws.messages.event.clbks.lenta,delete pe.app.platform.ws.messages["new block"].clbks.newsharesLenta,delete pe.app.platform.clbks.api.actions.subscribe.lenta,delete pe.app.platform.clbks.api.actions.unsubscribe.lenta,delete pe.app.platform.clbks.api.actions.subscribePrivate.lenta,delete pe.app.platform.clbks.api.actions.blocking.lenta,delete pe.app.platform.clbks.api.actions.unblocking.lenta,delete pe.app.platform.clbks._focus.lenta,pe.app.platform.sdk.chats.removeTemp(),window.removeEventListener("scroll",B),window.removeEventListener("scroll",O),window.removeEventListener("scroll",F),window.removeEventListener("resize",N),c={}},authclbk:function(){void 0!==c&&c.c&&M.authclbk()},init:function(e){r=$(window),ce(),(c={}).c=e.el.find("#"+pe.map.id),c.shares=c.c.find(".shares"),c.loader=c.c.find(".loader"),c.lentacnt=c.c.find(".lentacell .cnt"),t(),de(null,e),d.goback||e.clbk(null,e)}}}var pe=new nModule,s={};return pe.authclbk=function(){_.each(s,function(e){e.authclbk()})},pe.run=function(e){var t=pe.addEssense(s,n,e);pe.init(t,e)},pe.stop=function(){_.each(s,function(e){e.destroy()})},pe}();"undefined"!=typeof module?module.exports=lenta:(app.modules.lenta={},app.modules.lenta.module=lenta);
 /*_____*/ 
var faq=function(){function e(i){var e,i=deep(i,"history"),a=[{name:v.app.localization.e("e14003"),id:"technical",group:[{id:"downloadclient",q:v.app.localization.e("e14004"),a:`<div><a href="https://github.com/pocketnetteam/pocketnet.gui/releases/latest">https://github.com/pocketnetteam/pocketnet.gui/releases/latest</a></div><div>${v.app.localization.e("e14006")}</div>`},{id:"downloadclient",q:v.app.localization.e("e14005"),a:`<div><a href="https://github.com/pocketnetteam/pocketnet.core/releases/latest">https://github.com/pocketnetteam/pocketnet.core/releases/latest</a></div><div>${v.app.localization.e("e14007")}</div>`}]},{name:v.app.localization.e("e14008"),id:"roadmap",group:[{id:"walletaddresses",q:v.app.localization.e("e14009"),a:`<div>${v.app.localization.e("e14010")}</div><div>${v.app.localization.e("e14011")}</div>`},{id:"linktoprofile",q:v.app.localization.e("e14012"),a:`<div>${v.app.localization.e("e14013")}</div>\
							<div>${v.app.localization.e("e14014")}</div>`},{id:"starsystem",q:v.app.localization.e("e14015"),a:`<div>${v.app.localization.e("e14016")}</div>`},{id:"updateprofiletime",q:v.app.localization.e("e14017"),a:`<div>${v.app.localization.e("e14018")}</div>`},{id:"linuxdesktop",q:v.app.localization.e("e14019"),a:`<div>${v.app.localization.e("e14020")}</div>`},{id:"savevideo",q:v.app.localization.e("e14021"),a:`<div>${v.app.localization.e("e14022")}</div>`},{id:"mobileapp",q:v.app.localization.e("e14023"),a:`<div>${v.app.localization.e("e14024")}</div>`},{id:"postinglimit",q:v.app.localization.e("e14025"),a:`<div>${v.app.localization.e("e14026")}</div>`},{id:"reputation",q:v.app.localization.e("e14027"),a:`<div>${v.app.localization.e("e14028")}</div>\
						<div>5=2<br>4=1<br>3=0<br>2=-1<br>1=-2</div><div>${v.app.localization.e("e14029")} 2+2-2=2</div>`},{id:"deletepostoruser",q:v.app.localization.e("e14030"),a:`<div>${v.app.localization.e("e14031")}</div>`},{id:"usersearch",q:v.app.localization.e("e14032"),a:`<div>${v.app.localization.e("e14033")}</div>`},{id:"follow",q:v.app.localization.e("e14034"),a:`<div>${v.app.localization.e("e14035")}</div>`},{id:"otherbrowsers",q:v.app.localization.e("e14036"),a:`<div>${v.app.localization.e("e14037")}</div>`},{id:"replypost",q:v.app.localization.e("e14038"),a:`<div>${v.app.localization.e("e14039")}</div>`},{id:"addtags",q:v.app.localization.e("e14040"),a:`<div>${v.app.localization.e("e14041")}</div>`},{id:"usepublicaddress",q:v.app.localization.e("e14042"),a:`<div>${v.app.localization.e("e14043")}</div>`},{id:"desktopmac",q:v.app.localization.e("e14044"),a:`<div>${v.app.localization.e("e14045")}</div>`}]},{name:v.app.localization.e("e14046"),id:"pocketcoin",group:[{id:"pocketcoin",q:v.app.localization.e("e14047"),a:`<div>${v.app.localization.e("e14048")}</div>`},{id:"pocketcoinstock",q:v.app.localization.e("e14049"),a:`<div>${v.app.localization.e("e14050")}</div>`},{id:"pocketcoinbuy",q:v.app.localization.e("e14051"),a:`'<div>${v.app.localization.e("e14052")}</div>`},{id:"pocketcoinbuyfiat",q:v.app.localization.e("e14053"),a:`<div>${v.app.localization.e("e14054")}</div>`}]},{name:v.app.localization.e("e14055"),id:"privacy",group:[{id:"anonymous",q:v.app.localization.e("e14056"),a:`<div>${v.app.localization.e("e14057")}</div>`},{id:"viewoutside",q:v.app.localization.e("e14058"),a:`<div>${v.app.localization.e("e14059")}</div>`},{id:"walletid",q:v.app.localization.e("e14060"),a:`<div>${v.app.localization.e("e14061")}</div>`},{id:"runnode",q:v.app.localization.e("e14062"),a:`<div>${v.app.localization.e("e14063")}</div>`},{id:"signback",q:v.app.localization.e("e14064"),a:`<div>${v.app.localization.e("e14065")}</div>`}]},{name:v.app.localization.e("e14066"),id:"curation",group:[{id:"content",q:v.app.localization.e("e14067"),a:`<div>${v.app.localization.e("e14068")}</div>`},{id:"specific",q:v.app.localization.e("e14069"),a:`<div>${v.app.localization.e("e14070")}</div>`},{id:"racism",q:v.app.localization.e("e14071"),a:`<div>${v.app.localization.e("e14072")}</div>`}]},{name:v.app.localization.e("e14073"),id:"specificscuration",group:[{id:"trolls",q:v.app.localization.e("e14074"),a:`<div>${v.app.localization.e("e14075")}</div>`},{id:"flagging",q:v.app.localization.e("e14076"),a:`<div>${v.app.localization.e("e14077")}</div>`}]},{name:v.app.localization.e("e14078"),id:"differents",group:[{id:"differents1",q:v.app.localization.e("e14079"),a:`<div>${v.app.localization.e("e14080")}</div>`},{id:"differents2",q:v.app.localization.e("e14081"),a:`<div>${v.app.localization.e("e14082")}</div>`},{id:"differents3",q:v.app.localization.e("e14083"),a:`<div>${v.app.localization.e("e14084")}</div>`},{id:"differents4",q:v.app.localization.e("e14085"),a:`<div>${v.app.localization.e("e14086")}</div>`}]},{name:v.app.localization.e("e14087"),id:"ecosystem",group:[{id:"ecosystem1",q:v.app.localization.e("e14088"),a:`<div>${v.app.localization.e("e14089")}</div>`},{id:"ecosystem2",q:v.app.localization.e("e14090"),a:`<div>${v.app.localization.e("e14091")}</div>`},{id:"ecosystem3",q:v.app.localization.e("e14092"),a:`<div>${v.app.localization.e("e14093")}</div>`},{id:"ecosystem4",q:v.app.localization.e("e14094"),a:`<div>${v.app.localization.e("e14095")}</div>`},{id:"ecosystem5",q:v.app.localization.e("e14096"),a:`<div>${v.app.localization.e("e14097")}</div><div>${v.app.localization.e("e14098")}</div><div>${v.app.localization.e("e14099")} </div>`}]}],o={},p=function(i){_scrollToTop(e.c.find('.faqcnt .question[question="'+i+'"]'),null,null,-110)},l=function(i){_scrollToTop(e.c.find('.faqcnt .group[group="'+i+'"]'),null,null,-110)},t=function(i){var a=o[i],i="https://bastyon.com/help?page=faq&id="+i+"&ref="+v.app.platform.sdk.address.pnet().address,a=a.q;v.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:i,caption:"Share FAQ answer in social",title:a}})},n=function(){var i=$(window).height()/4,a=inView(e.c.find(".faqcnt .group"),{offsetTop:i,offsetBottom:i,mode:"line"}),i=null;0<a.length&&(i=$(a[0]).attr("group"),e.contens.removeClass("active"),e.c.find('.contens .item[group="'+i+'"]').addClass("active"))},d=function(){var i=$(this).attr("group");l(i)},c=function(){var i=$(this).closest(".question").attr("question");t(i)},s=function(){};return{primary:i,getdata:function(i){o={},_.each(a,function(i){_.each(i.group,function(i){o[i.id]=i})}),i({groups:a})},destroy:function(){window.removeEventListener("scroll",n),e={}},init:function(i){s(),(e={}).c=i.el.find("#"+v.map.id),e.contens=e.c.find(".contens .item"),e.contens.on("click",d),e.c.find(".share").on("click",c),e.c.find(".question .questionName").on("click",function(){$(this).closest(".question").toggleClass("opened")}),window.addEventListener("scroll",n),e.c.find(".contens").hcSticky({stickTo:"#faq",top:65});var a=parameters().id;a&&p(a),i.clbk(null,i)}}}var v=new nModule,o={};return v.run=function(i){var a=v.addEssense(o,e,i);v.init(a,i)},v.stop=function(){_.each(o,function(i){i.destroy()})},v}();"undefined"!=typeof module?module.exports=faq:(app.modules.faq={},app.modules.faq.module=faq);
 /*_____*/ 
var embeding=function(){function n(e){var i,s,o,e=deep(e,"history"),t=null,l={url:new Parameter({type:"URL",id:"url",placeholder:m.app.localization.e("e13102"),onType:!0}),images:{isValid:function(){return!0},value:[]}},c={url:m.app.localization.e("e13103"),imagesLength:m.app.localization.e("e13104")},n={check:function(e){if(l[e].isValid(l[e].value))return i.error.html(""),!0;i.error.html(c[e])},removeImage:function(e){removeEqual(l.images.value,{id:e}),r.images(),i.error.html("")},add:{url:function(){n.check("url")&&(s.added(l.url.value),m.closeContainer())},images:function(){var a;n.check("images")&&(a=[],_.each(l.images.value,function(e){e.base64&&a.push(e.base64)}),s.added(a),m.closeContainer())}},slowUploadGif:function(e,a){e.id=makeid(),e.slow=!0,e.base64=e.base64,l.images.value.push(e),a&&a()},slowUpload:function(a,n){resize(a.base64,1080,1080,function(e){e.split(",")[1]&&(a.id=makeid(),a.slow=!0,a.base64=e,l.images.value.push(a)),n&&n()})},upload:function(a,n){resize(a.base64,1080,1080,function(e){e=e.split(",");e[1]&&(5<l.images.value.length?i.error.html(c.imagesLength):(i.error.html(""),a.id=makeid(),a.loading=!0,l.images.value.push(a),r.images(),m.ajax.run({type:"POST",imgur:!0,data:{Action:"image",image:e[1]},success:function(e){a.loading=!1,a.src=deep(e,"data.link")||"https://bastyon.com/img/imagenotuploaded.jpg",r.images(),n&&n()},fail:function(){a.src="https://bastyon.com/img/imagenotuploaded.jpg",r.images(),n&&n()}})))})}},u=function(){var e=$(this).attr("action")||t;n.add[e]()},d=function(){var e=$(this).closest(".imageContainer").attr("value");n.removeImage(e)},r={images:function(e,a){(e=e||l.images.value).length&&m.shell({name:"images",el:i.images,data:{images:e}},function(e){e.el.find(".remove").on("click",d),e.el.find(".image").each(function(){$(this)}),a&&a()})}},g=function(){};return{primary:e,getdata:function(e,n){t=n.settings.essenseData.type,s=n.settings.essenseData.on,o=n.settings.essenseData,n.settings.essenseData.subtype,n.settings.essenseData.storage&&_.each(l,function(e,a){e.value=n.settings.essenseData.storage[a],"images"==a&&(e.value=[])}),e({type:t,options:l})},destroy:function(){i={}},init:function(e){var a;g(),(i={}).c=e.el.find("#"+m.map.id),i.error=i.c.find(".error"),i.action=i.c.find(".action"),i.upload=i.c.find(".upload"),i.images=i.c.find(".imagesMi"),i.c.find("input").focus().on("change",u),i.action.on("click",u),"images"==t?(r.images(),o.value&&(a={base64:o.value},n.slowUpload(a)),initUpload({el:i.upload,ext:["png","jpeg","jpg","gif"],dropZone:i.c.closest(".wnd"),multiple:!0,action:function(e,a){"gif"==e.ext?n.slowUploadGif(e,a):n.slowUpload(e,a)},onSuccess:function(){n.add.images()}})):ParametersLive([l[t]],i.c),e.clbk(null,e)},wnd:{header:"",buttons:{close:{class:"close",html:'<i class="fa fa-check"></i> '+m.app.localization.e("finish"),fn:function(e,a){n.add[t]()}}},close:function(){o.on.close&&o.on.close()},success:function(e,a){wndObj=a,wnd=e},offScroll:!0,noInnerScroll:!0,class:"embeding",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30}}}var m=new nModule,i={};return m.run=function(e){var a=m.addEssense(i,n,e);m.init(a,e)},m.stop=function(){_.each(i,function(e){e.destroy()})},m}();"undefined"!=typeof module?module.exports=embeding:(app.modules.embeding={},app.modules.embeding.module=embeding);
 /*_____*/ 
var userpage=function(){function n(e){var r,a,i,e=deep(e,"history"),s=null,p=null,l=!1,c=null,u=[],d={eachReport:function(i,e,t){var r=function(e,o,a){o=o||0,a=a||"",_.each(e,function(e,t){var n=a;n&&(n+="_"),n+=e.id,e.reports?i.group(e,o,n,function(){r(e.reports,o+1,n)},t):i.report(e,o,n)})};r(e=e||u,0,t)},findReport:function(e){var o=function(e,t){var n=t.split("_");if(!n.length)return null;t=n[0];e=_.find(e||[],function(e){return e.id==t});return e?(n.splice(0,1),(t=n.join("_"))&&e.reports?o(e.reports,t):e):null};return o(u,e)},mobileReports:function(){var a=[];return d.eachReport({group:function(e,t,n,o){e.mobile&&a.push(e),o()},report:function(e){e.mobile&&a.push(e)}}),a.push({name:g.app.localization.e("signout"),id:"signout"}),a},selector:function(){var e=d.mobileReports(),t=_.map(e,function(e){return e.id}),e=_.map(e,function(e){return e.text||e.name}),e=new Parameter({type:"VALUES",name:g.app.localization.e("e13187"),id:"contents",possibleValues:t,possibleValuesLabels:e,defaultValue:t[0]});return e.value=parameters().id||t[0],e._onChange=function(e){var t;"signout"==e?n.signout():(t=d.findReport(e),(e=parameters()).report=t.report,e.id=t.id,e="userpage"+collectParameters(e),g.nav.api.load({open:!0,href:e,history:!0}))},e}},n={closeGroup:function(e){var t=d.findReport(e);t&&(t.active=!t.active,e=r.c.find('[levelid="'+e+'"]'),t.active?e.addClass("active"):e.removeClass("active"))},openTree:function(i){d.eachReport({group:function(e,t,n,o){var a=r.c.find('[levelid="'+n+'"]');0==i.indexOf(n)?(e.active=!0,a.addClass("active"),o()):(e.active=!1,a.find(".openReport").removeClass("active"))},report:function(e,t,n){var o=r.c.find('[id="'+n+'"]');i==n?(e.active=!0,o.addClass("active")):(e.active=!1,o.removeClass("active"))}})},closeReport:function(){r.report.html("")},openReport:function(e,t){r.c.find(".openReport").removeClass("active"),r.c.find('[rid="'+e+'"]').addClass("active"),n.openTree(e),v.report(e),t&&(g.nav.api.history.addParameters({id:e},{removefromback:!1}),g.app.nav.clbks.history.navigation&&g.app.nav.clbks.history.navigation())},signout:function(){function e(){g.app.user.signout(),g.app.reload({href:"authorization"})}if(g.app.platform.sdk.address.pnet()){var t=g.app.platform.sdk.address.pnet().address,t=g.app.platform.sdk.registrations.storage[t];if(t&&t<=5)return void g.app.platform.ui.showmykey({text:g.app.localization.e("e13188"),faillabel:g.app.localization.e("e13189"),fail:function(){e()}})}e()}},f=function(){var e=$(this).closest("[levelid]").attr("levelid");n.closeGroup(e)},m=function(){var e=$(this).attr("rid");isMobile()&&v.contents(null,e),n.openReport(e,!0)},v={bgcaption:function(e){d.selector();r&&r.bgcaption&&(g.app.user.validate()?g.shell({name:"bgcaption",el:r.bgcaption,data:{}},function(e){}):r.bgcaption.html('<div class="bgCaptionSpacer"></div>'))},contents:function(n,e){var o;r.contents&&(o=d.selector(),e&&isMobile()?(r.contents.html(""),n&&n()):g.app.platform.sdk.node.transactions.get.allBalance(function(e){var t=g.app.platform.sdk.node.transactions.tempBalance();i=e+t,g.shell({name:"contents",el:r.contents,data:{reports:u,each:d.eachReport,selector:o}},function(e){e.el.find(".groupNamePanelWrapper").on("click",f),e.el.find(".openReport").on("click",m),ParametersLive([o],e.el),_scrollTop(0),l&&r.contents.hcSticky("refresh"),n&&n()})}))},userslist:function(e,t,n,o,a){g.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:t,empty:n,caption:o},clbk:function(e,t){a&&a(e,t)}})},followers:function(e,t){var n,o,a=deep(g,"app.user.address.value");a&&(n=deep(g,"sdk.users.storage."+a),o=_.map(deep(n,"subscribers")||[],function(e){return e}),a=g.app.localization.e("anofollowers"),g.user.isItMe(n.address)&&(a=g.app.localization.e("aynofollowers")),v.userslist(e,o,a,g.app.localization.e("followers"),t))},following:function(e,t){var n,o,a=deep(g,"app.user.address.value");a&&(n=deep(g,"sdk.users.storage."+a),o=_.map(deep(n,"subscribes")||[],function(e){return e.adddress}),a=g.app.localization.e("anofollowing"),g.user.isItMe(n.address)&&(a=g.app.localization.e("aynofollowing")),v.userslist(e,o,a,g.app.localization.e("following"),t))},fillUser:function(e,t){g.shell({name:"fillUser",el:e,data:{}},function(e){t&&t()})},report:function(e,n){s&&s.destroy();function o(e,t){_scrollTop(0),s=t,p&&p.apply(),n&&n()}var t=d.findReport(e);g.shell({name:"report",el:r.report,data:{}},function(e){v[t.report]?(v[t.report](e.el.find(".reportCnt"),o),l&&r.contents.hcSticky("refresh")):g.nav.api.load({open:!0,id:t.report,el:e.el.find(".reportCnt"),animation:!1,primary:!0,essenseData:{sub:t.sub,dumpkey:a.dumpkey},clbk:function(e,t){o(0,t),l&&r.contents.hcSticky("refresh")}})})}},t=function(){};function o(e){var t=parameters().id;isMobile()||(t=t||(g.app.user.validate()?"ustate":"test")),v.contents(function(){t?n.openReport(t):n.closeReport(),e&&e()},t)}g.authclbk=function(){v.bgcaption()};var b=function(e){v.bgcaption(),o(e),g.app.user.validate()||(r.c.addClass("validate"),g.app.errors.connectionRs()&&(g.iclbks.mn=function(){delete g.iclbks.mn,b()})),isMobile()||(r.contents.hcSticky({stickTo:"#userpagestick",top:77,bottom:177}),l=!0)};return{primary:e,parametersHandler:function(){o()},getdata:function(t,e){var n;a=deep(e,"settings.essenseData")||{},u=[],g.app.user.validate()||(n=g.app.localization.e("e13184"),g.app.errors.connection()&&(n=g.app.localization.e("e13185")),u.push({name:n,id:"test",report:"fillUser",mobile:!0})),u.push({name:g.app.localization.e("notifications"),id:"notifications",report:"notifications",mobile:!0}),u.push({name:g.app.localization.e("rstate"),id:"ustate",report:"ustate",mobile:!0,add:function(){if(isMobile()&&deep(c,"reputation"))return c.reputation.toFixed(1)}}),u.push({name:g.app.localization.e("rwallet"),id:"wallet",report:"wallet",mobile:!0,add:function(){if(isMobile()&&i)return g.app.platform.mp.coin(i)}}),u.push({name:g.app.localization.e("followers"),id:"followers",report:"followers",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e){e=deep(g,"sdk.users.storage."+e+".subscribers.length");if(isMobile()&&e)return e}}}),u.push({name:g.app.localization.e("following"),id:"following",report:"following",mobile:!0,if:function(){return isMobile()},add:function(){var e=deep(g,"app.user.address.value");if(e){e=deep(g,"sdk.users.storage."+e+".subscribes.length");if(isMobile()&&e)return e}}}),g.app.user.validate()&&u.push({name:g.app.localization.e("e13186"),id:"test",report:"test",mobile:!0}),u.push({name:g.app.localization.e("rsettings"),id:"usersettings",report:"usersettings",mobile:!0}),u.push({name:g.app.localization.e("raccounts"),id:"accounts",report:"accounts",mobile:!0}),u.push({name:g.app.localization.e("rsystem"),id:"system16",report:"system16",mobile:!1});var o={},e=parameters();o.p2pkh=g.app.platform.sdk.address.pnet(),g.app.platform.sdk.ustate.me(function(e){c=e,t(o)})},destroy:function(){delete g.iclbks.mn,l=!1,s&&s.destroy(),s=null,p&&p.destroy(),p=null,$("#menu").removeClass("abs"),r={}},init:function(e){t(),(r={}).c=e.el.find("#"+g.map.id),r.contents=r.c.find(".contents"),r.report=r.c.find(".report"),r.bgcaption=r.c.find(".bgCaptionWrapper"),$("#menu").addClass("abs"),new Caption({container:r.c,caption:r.c.find(".captionfwrapper"),offset:[0,0]}).init(),r.c.on("click",".signout",function(){n.signout()}),b(function(){e.clbk(null,e)})}}}var g=new nModule,o={};return g.run=function(e){var t=g.addEssense(o,n,e);g.init(t,e)},g.stop=function(){_.each(o,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=userpage:(app.modules.userpage={},app.modules.userpage.module=userpage);
 /*_____*/ 
var comments=function(){function t(e){function o(a,t,i){var e=t.el.find(".leaveComment"),s=t.el.find(".postbody");z.process(a.id||"0"),e.emojioneArea({pickerPosition:"top",search:!1,tones:!1,autocomplete:!1,attributes:{spellcheck:!0},filters:{smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning smiley smile grin laughing sweat_smile joy rofl relaxed blush innocent slight_smile upside_down wink relieved crazy_face star_struck heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes yum stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth hugging nerd sunglasses cowboy smirk unamused disappointed pensive worried face_with_raised_eyebrow face_with_monocle confused slight_frown frowning2 persevere confounded tired_face weary triumph angry rage face_with_symbols_over_mouth no_mouth neutral_face expressionless hushed frowning anguished open_mouth astonished dizzy_face exploding_head flushed scream fearful cold_sweat cry disappointed_relieved drooling_face sob sweat sleepy sleeping rolling_eyes thinking shushing_face face_with_hand_over_mouth lying_face grimacing zipper_mouth face_vomiting nauseated_face sneezing_face mask thermometer_face head_bandage smiling_imp imp japanese_ogre japanese_goblin poop ghost skull skull_crossbones alien space_invader robot jack_o_lantern clown smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat open_hands raised_hands palms_up_together clap pray handshake thumbsup thumbsdown punch fist left_facing_fist right_facing_fist fingers_crossed v metal love_you_gesture ok_hand point_left point_right point_up_2 point_down point_up raised_hand raised_back_of_hand hand_splayed vulcan wave call_me muscle middle_finger writing_hand selfie nail_care ring lipstick kiss lips tongue ear nose footprints eye eyes speaking_head bust_in_silhouette busts_in_silhouette baby boy girl man woman blond-haired_woman blond_haired_man older_man older_woman man_with_chinese_cap woman_wearing_turban man_wearing_turban woman_police_officer police_officer woman_construction_worker construction_worker woman_guard guard woman_detective detective woman_health_worker man_health_worker woman_farmer man_farmer woman_cook man_cook woman_student man_student woman_singer man_singer woman_teacher man_teacher woman_factory_worker man_factory_worker woman_technologist man_technologist woman_office_worker man_office_worker woman_mechanic man_mechanic woman_scientist man_scientist woman_artist man_artist woman_firefighter man_firefighter woman_pilot man_pilot woman_astronaut man_astronaut woman_judge man_judge mrs_claus santa princess prince bride_with_veil man_in_tuxedo angel pregnant_woman breast_feeding woman_bowing man_bowing woman_tipping_hand man_tipping_hand woman_gesturing_no man_gesturing_no woman_gesturing_ok man_gesturing_ok woman_raising_hand man_raising_hand woman_facepalming man_facepalming woman_shrugging man_shrugging woman_pouting man_pouting woman_frowning man_frowning woman_getting_haircut man_getting_haircut woman_getting_face_massage man_getting_face_massage man_in_business_suit_levitating dancer man_dancing women_with_bunny_ears_partying men_with_bunny_ears_partying woman_walking man_walking woman_running man_running couple bearded_person woman_with_headscarf woman_mage man_mage woman_fairy man_fairy woman_vampire man_vampire mermaid merman woman_elf man_elf woman_genie man_genie woman_zombie man_zombie womans_clothes shirt jeans necktie dress bikini kimono high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat mortar_board crown helmet_with_cross school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses closed_umbrella umbrella2 brain billed_cap scarf gloves coat socks "}},events:{"emojibtn.click":W.emessage,change:W.emessage,click:W.emessage,keydown:function(e,n){if(n.ctrlKey&&13==n.keyCode&&!s.hasClass("sending"))return s.addClass("sending"),z.post(a.id||"0",a.pid,a.aid,a.editid),n.preventDefault(),!1},keyup:function(e,n){var t=String.fromCharCode(n.keyCode||n.which),i=this.getText();C.test(t)&&z.links(i),n.ctrlKey&&13==n.keyCode||(z.message(a.id||"0",i),j.limits(s,i))},onLoad:function(e,n){(d.init||a.init)&&(t.el.find(".emojionearea-editor").focus(),t.el.addClass("active"),d.init=!1),a.value&&this.setText(a.value),a.images&&a.editid&&a.images.length&&(p[a.editid].images.v=_.clone(a.images),j.images(a.editid,a)),i&&i(this,t.el.find(".emojionearea-editor"))}}}),t.el.find(".emojionearea-editor").on("focus",function(){z.process(a.id||"0"),t.el.addClass("active")}),t.el.find(".emojionearea-editor").on("blur",function(){setTimeout(function(){t.el.removeClass("active")},150)}),t.el.find(".postaction").on("click",function(){s.hasClass("sending")||(s.addClass("sending"),z.post(a.id||"0",a.pid,a.aid,a.editid))}),a.id&&t.el.find(".closeEdit").on("click",function(){z.closeEdit(a.id)}),t.el.find(".closeAnswer").on("click",function(){z.removeForm(a.id||"0")})}function n(n){function e(){var e=_.map(y.levels,function(e){return e});e.length?lazyEach({array:e,action:function(n){var e=n.item;A.level(e,function(e){n.success()})},all:{success:function(){n&&n()}}}):n&&n()}f&&!s?e():A.level(null,function(){e()})}var c,r,d,l,t,i,a,m,e=deep(e,"history"),p={},f=!1,u=!1,s=!1,g=!1,h={content:I.app.localization.e("e13029"),messagelength:I.app.localization.e("e13030"),images:I.app.localization.e("maximages")},v={},w={},k=null,y={},C=/[,.!?;:() \n\r]/g,b=function(e,n,t,i){var a,s;n&&n.txid==r&&(s=(a=c.c.find("#"+n.id)).find(">div.commentPaddingWrapper>div.commentWrapper>div.commentBody>div.cbodyWrapper"),i==I.app.platform.sdk.address.pnet().address&&(a.addClass("rated"),0<t&&s.find(".scoreUp").addClass("ratedScore"),t<0&&s.find(".scoreDown").addClass("ratedScore")),n.scoreUp&&s.find(".scoreUp .commentScore").html(compressedNumber(n.scoreUp,1)),n.scoreDown&&s.find(".scoreDown .commentScore").html(compressedNumber(n.scoreDown,1)))},x=function(e,n,t,i,a,s,o,l){t==r&&(c.c.find(".sending").removeClass("sending"),e||(L.save(),c.c.find(".emojionearea-editor").blur(),c.c.find(".att").html(""),t={comments:[n]},u&&(d.lastComment=I.app.platform.sdk.comments.toLastComment(n)),delete p[o],"0"==o&&(t.class="firstcomment"),"0"==o?(w[o]&&w[o].setText(""),c.c.find(".post .newcommentimages").html("")):(e=c.c.find("#"+o),s?(e.find(".edit").html(""),n.timeUpd=n.timeUpd.addMinutes(1),n.parentid||(t.class="firstcomment"),delete w[o],delete v[o],e.removeClass("editing"),t.inner=replaceWith,t.el=e):(e.find(".answer").html(""),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),t.el=c.c.find("#"+o+" .answers"),delete w[o])),t.newcomments="newcomments",j.list(t,function(){l&&z.tocomment(n.id)}),!s&&d.send&&d.send(n),s||(d.comments&&d.comments++,z.showhideLabel())))},z={myscores:function(){_.each(v,function(e,n){n=deep(I.app.platform.sdk,"comments.storage.all."+n);n&&b(null,n,Number(n.myScore),I.app.platform.sdk.address.pnet().address)})},stateAction:function(n){I.app.user.isState(function(e){e?n():I.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:I.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!g},function(){n&&n()})}}})})},sharesocial:function(e){var n=findAndReplaceLink(filterXSS(e.message,{whiteList:[],stripIgnoreTag:!0}),!0),n=joypixels.toImage(n),t=nl2br(trimrn(n)),n=d.hr+"&commentid="+e.id;e.parentid&&"0"!=e.parentid&&(n=n+"&parentid="+e.parentid),I.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:n,caption:I.app.localization.e("e13031"),image:deep(app,"platform.sdk.usersl.storage."+e.address+".image"),title:deep(app,"platform.sdk.usersl.storage."+e.address+".name"),text:t}})},editImage:function(t,e,i){var a=p[t],s=_.map(a.images.v,function(e,n){return{original:e,index:n}});focusfixed=!0,I.nav.api.load({open:!0,id:"imageGalleryEdit",inWnd:!0,essenseData:{edit:!0,initialValue:e,images:s,close:function(){},success:function(e,n){_.each(a.images.v,function(e,n){var t=_.find(s,function(e){if(e.index==n)return!0});t&&(a.images.v[n]=t.original)}),j.images(t,i,n)}}})},removeImage:function(e,t,n){p[e].images.v.splice(t,1)[0];n.el.find(".imageContainer").each(function(){var e=$(this),n=e.attr("value");t<n&&e.attr("value",n-1),n==t&&e.remove()}),n.el.find(".imagesEmbWr").isotope()},embedimages:function(i,n){i=i||"0",z.process(i),w[i]&&(w[i].___inited=!0);var e=p[i].export(!0);I.nav.api.load({open:!0,id:"embeding",inWnd:!0,essenseData:{type:"images",storage:e,on:{added:function(e){var t=!0;_.isArray(e)||(e=[e]),_.each(e,function(e,n){t=p[i].images.set(e)}),!t&&h[type]&&sitemessage(h[type]),j.images(i,n)}}},clbk:function(e,n){k=n}})},removeForm:function(e){delete w[e],c.c.find("#"+e+" .answer").html(""),c.c.find("#"+e+" .edit").html("")},post:function(e,n,t,i){var a,s=p[e=e||"0"];s?(a=s.validation())?(c.c.find(".sending").removeClass("sending"),sitemessage(h[a])):s.loading||(s.loading=!0,s.uploadImages(I.app,function(){z.send(s,function(e,n){s.loading=!1,e||successCheck()},n,t,i,e)})):(c.c.find(".sending").removeClass("sending"),sitemessage(h.content))},send:function(e,t,n,i,a,s){I.app.platform.sdk.comments.send(r,e,n,i,function(e,n){c.c&&c.c.find(".sending").removeClass("sending"),e?(I.app.platform.errorHandler(e,!0),t&&t(e,null)):t&&t(null,n)},a,s)},links:function(e,n){var t=p[e=e||"0"];t&&(t.url.v||(e=null,(e=(n=n.match(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi))&&0<n.length?n[0]:e)&&t.url.set(e)))},process:function(e){p[e=e||"0"]||(p[e]=new Comment(r))},message:function(e,n){p[e=e||"0"]&&p[e].message.set(n),L.save()},emessage:function(e,n){n=n.getText();z.links(e,n),z.message(e,n),w[e]&&(w[e].___inited=!0)},fastreply:function(n){n&&z.replies(n.parentid||n.answerid,!0,function(){var e;n.noaction?(z.tocomment(n.answerid),(e=c.c.find("#"+n.answerid)).addClass("newcommentsn"),setTimeout(function(){e.removeClass("newcommentsn")},2500)):z.reply(n.parentid||n.answerid,n.answerid)})},reply:function(s,o){z.stateAction(function(){var e=c.c.find("#"+s).find(".answer");j.post(function(e,n){var t="0";o!=s&&(t=s);var i=I.app.platform.sdk.comments.address(r,o,t)||deep(d,"lastComment.address"),a=deep(I.app,"platform.sdk.usersl.storage."+i+".name")||i,t="@"+a+",  ";i!=I.app.platform.sdk.address.pnet().address&&a||(t=""),e.setText(t),w[s]=e,n.focus(),n.closest(".answer").addClass("active"),t.length&&ecaretPosition(n,0,t.length)},{placeholder:"Send Reply",el:e,answer:"answer",pid:s,aid:o,id:s})})},hideallReplies:function(){_.each(deep(I,"app.platform.sdk.comments.storage."+r+".0"),function(e,n){z.replies(n,!1)}),d.lastComment&&z.replies(d.lastComment.id,!1)},replies:function(n,e,t,i){var a,s;i=i||{},"0"!=n?((a={}).in=i.in,a.el=c.c.find("#"+n+" .answers"),s=c.c.find("#"+n),void 0===e&&(s.hasClass("showedreplies")?e=!1:(e=!0,s.find(".repliesloaderWrapper").removeClass("hidden"))),e?A.level(n,function(e){s.find(".repliesloaderWrapper").addClass("hidden"),a.comments=I.app.platform.sdk.comments.storage[r][n],s.addClass("showedreplies"),j.list(a,function(){l||j.caption(),t&&t()},n)}):(delete y.levels[n],_.each(I.app.platform.sdk.comments.storage[r][n],function(e){delete v[e.id]}),s.removeClass("showedreplies"),z.removeForm(n),a.el.html(""))):t&&t()},getid:function(e){if(e.attr("answer")){(n=e.closest(".comment")).attr("id");return e.closest(".firstcomment").attr("id")}if(e.attr("edit")){var n;(n=e.closest(".comment")).attr("aid"),n.attr("pid");return n.attr("id")}return"0"},tocomment:function(e){_scrollTo(c.c.find("#"+e),t)},closeEdit:function(e){var n=c.c.find("#"+e);n.removeClass("editing"),n.find(".commentBody").removeClass("editing"),z.removeForm(e)},delete:function(e,t){e=e.delete();I.app.platform.sdk.comments.delete(r,e,function(e,n){e?(I.app.platform.errorHandler(e,!0),t&&t(e,null)):t&&t(null,n)})},update:function(e){var n={},t=null,t=e?c.c.find("#"+e+" .answers"):(n.class="firstcomment",c.c.find(".list"));A.level(e,function(e){t.html(""),n.comments=e,j.list(n)})},hiddenCounts:function(e){0<e?c.showall.find(".ccounts").html("("+e+")"):c.showall.find(".ccounts").html()},showall:function(){s=!0,c.c.addClass("showedall"),z.showhideLabel(),d.showall=!0,u?(c.c.removeClass("listpreview"),c.c.find(".loaderWrapper").removeClass("hidden"),A.level(null,function(e,n){if(n)return I.app.platform.errorHandler(n,!0),c.c.addClass("listpreview"),c.c.find(".loaderWrapper").addClass("hidden"),s=!1,c.c.removeClass("showedall"),void z.showhideLabel();u=!1,j.caption(),v={};n={};n.comments=I.app.platform.sdk.comments.storage[r][0],n.class="firstcomment",n.inner=html,j.list(n,function(){c.c.find(".loaderWrapper").addClass("hidden")})})):j.caption()},showhideLabel:function(){var e,n;c.showall&&(s?c.showall.addClass("hidden"):(e=deep(I.app.platform,"sdk.node.shares.storage.trx."+r+".comments")||0,n=deep(I.app.platform,"sdk.node.shares.storage.trx."+r+".lastComment.children")||0,u?1<e-n?(c.showall.removeClass("hidden"),z.hiddenCounts(e-n-1)):c.showall.addClass("hidden"):5<e?(c.showall.removeClass("hidden"),z.hiddenCounts(e-5)):c.showall.addClass("hidden")))},openGallery:function(e,n,t){var i=_.map(e.images,function(e){return{src:e}}),a=findIndex(i,function(e){if(e.src==n)return!0});I.app.nav.api.load({open:!0,href:"imagegallery?s="+r+"&num="+(a||0)+"&com="+e.id,inWnd:!0,history:!0,essenseData:{initialValue:n,idName:"src",images:i,gid:r+e.id},clbk:function(){t&&t()}})},upvoteComment:function(n,t){z.stateAction(function(){var e=deep(I.app.platform.sdk,"comments.storage.all."+t);e&&e.address!=I.app.platform.sdk.address.pnet().address&&(e=e.upvote(n),I.app.platform.sdk.comments.upvote(e,function(e,n){e&&I.app.platform.errorHandler(e,!0)}))})}},W={upvoteComment:function(){var e,n,t;$(this).closest(".comment").hasClass("rated")||(e=0,e="scoreUp"==$(this).attr("score")?1:-1,n=$(this).closest(".comment").attr("id"),t=$(this).closest(".comment").attr("pid"),z.upvoteComment(e,n,t))},openGallery:function(){var e=$(this),n=e.closest(".comment"),t=n.attr("id"),n=n.attr("pid"),n=I.app.platform.sdk.comments.find(r,t,n);u&&d.lastComment&&(n=I.app.platform.sdk.comments.ini([d.lastComment])[0]),z.openGallery(n,e.attr("i"))},replyandreplies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e,!0);var n=$(this).closest(".comment"),e=$(this).closest(".firstcomment").attr("id"),n=n.attr("id");z.reply(e,n)},replies:function(){var e=$(this).closest(".firstcomment").attr("id");z.replies(e)},emessage:function(e,n){var t=this.getText(),i=z.getid(e.closest(".postbody"));z.emessage(i,this),j.limits(e.closest(".postbody"),t)},message:function(){var e=$(this).val(),n=z.getid(editor.closest(".postbody"));z.links(n,e),z.message(n,e)},reply:function(){var e=$(this).closest(".comment"),n=$(this).closest(".firstcomment").attr("id"),e=e.attr("id");z.reply(n,e)},tocomment:function(){var e=$(this).attr("comment");z.tocomment(e)},metmenu:function(){var t=$(this),e=t.closest(".comment"),i=t.closest(".commentBody"),n=e.attr("id"),e=e.attr("pid"),a=I.app.platform.sdk.comments.find(r,n,e),s={address:I.app.user.address.value,caddress:I.app.platform.sdk.comments.address(r,n,e)};u&&d.lastComment&&!e&&(a=I.app.platform.sdk.comments.ini([d.lastComment])[0],s.caddress=a.address),I.fastTemplate("metmenu",function(e,n){I.app.platform.api.tooltip(t,function(){return n(s)},function(e){e.find(".edit").on("click",function(){j.edit(i,a),t.tooltipster("hide")}),e.find(".remove").on("click",function(){dialog({html:I.app.localization.e("e13032"),success:function(){z.delete(a,function(e){e||((e=c.c.find("#"+a.id)).addClass("deleted"),c.c.find("#"+a.id+" >div.commentPaddingWrapper .commentmessage div").html("<div>"+I.app.localization.e("e13033")+"</div>"),e.find(".panel").remove(),e.find(".commentimages").remove(),e.find(".reply").remove())})},btn1text:I.app.localization.e("e13034"),btn2text:I.app.localization.e("e13035")}),t.tooltipster("hide")}),e.find(".socialshare").on("click",function(){z.sharesocial(a),t.tooltipster("hide")})},{theme:"zindex lighttooltip"})},s)}},j={images:function(n,i,a){var s=p[n];I.shell({name:"images",turi:"embeding",inner:html,el:i.el.find(".newcommentimages"),data:{images:_.map(s.images.v||[],function(e,n){return{src:e,id:n}})}},function(t){t.el.find(".remove").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.removeImage(n,e,i)}),t.el.find(".edit").on("click",function(){var e=$(this).closest(".imageContainer").attr("value");z.editImage(n,e,i)}),t.el.find(".image").on("click",function(){var e,n=$(this).attr("i");n&&(e=_.map(s.images,function(e){return{src:e}}),I.app.nav.api.load({open:!0,id:"imageGallery",inWnd:!0,essenseData:{initialValue:n,idName:"src",images:e}}))}),t.el.find(".image").imagesLoaded({background:!0},function(e){var n;isMobile()?(a&&a(),i.el.find(".newcommentimages").addClass("active")):((n=t.el.find(".imagesEmbWr")).isotope({layoutMode:"packery",itemSelector:".imageContainer",packery:{gutter:10},initLayout:!1}),n.on("arrangeComplete",function(){a&&a(),i.el.find(".newcommentimages").addClass("active")}),n.isotope())})})},limits:function(e,n){n=1e3-n.length;e.find(".limits").removeClass("bad"),n<500?0<n?e.find(".limits").addClass("active").html(n+" "+pluralform(n,["Character","Characters"])+" Available"):e.find(".limits").addClass("active").addClass("bad").html("You are "+-n+" characters over"):e.find(".limits").removeClass("active")},cpreview:function(e){e=e||d.caption,c.caption&&(c.caption.find(".captionPreview").html(e),bgImages(c.caption.find(".captionPreview")))},caption:function(n){d.caption&&I.shell({name:"caption",el:c.caption,data:{ed:d}},function(e){j.cpreview(),l=new Caption({container:c.c,caption:c.c.find(".captionfwrapper"),offset:[i,-100],removeSpacer:!0,iniHeight:!0,_in:t}).init(),e.el.find(".close .cact").on("click",function(){d.close&&d.close()}),e.el.find(".top .cact").on("click",function(){_scrollToTop(c.c.find(".list"),t,void 0,-150)}),e.el.find(".bottom .cact").on("click",function(){_scrollToBottom(c.c.find(".list"),t,void 0,-150)}),n&&n()})},edit:function(e,n){e.addClass("editing");n={value:n.message,images:n.images,init:!0,edit:"edit",el:e.find(">div.edit"),pid:n.parentid,aid:n.answerid,id:n.id,editid:n.id};j.post(function(e,n){},n)},post:function(a,s){I.app.user.isState(function(i){(s=s||{}).el||(s.el=c.post);var e=f&&!s.answer&&!s.editid;I.shell({name:"post",el:s.el,data:{placeholder:s.placeholder||"",answer:s.answer||"",edit:s.edit||"",preview:e,mestate:m}},function(n){function t(t){f&&(f=!1,s.init=!0,c.c.removeClass("preview"),o(s,n,function(e,n){a(e,n),t&&t(e,n)}))}if(n.el.find(".embedimages").off("click").on("click",function(){var e=z.getid(n.el.find(".postbody"));i?(z.embedimages(e,s),s.answer||s.editid||t()):z.stateAction(function(){})}),e)return n.el.find("textarea").on("click",function(){$(this).blur(),I.app.user.isState(function(e){e?t():z.stateAction(function(){})})}),void n.el.find(".embedEmojiPrivew").on("click",function(){i?t(function(e,n){e.showPicker()}):z.stateAction(function(){})});o(s,n,a)})})},commentimages:function(e,n){var t,o,l;c.c&&(e=c.c.find("#"+e.id),t=e.find(".commentimages .image"),!(o=e.find(".commentimages")).hasClass("active")&&t.length&&o.length?(l=e.height(),t.imagesLoaded({background:!0},function(s){_.each(s.images,function(e,n){var t=e.img,i=$(s.elements[n]).closest(".imagesWrapper"),a="",e=i.width();i.height();t.width>t.height&&!isMobile()&&(a="w2",(n=e*(t.width/t.height))>o.width()&&(n=o.width(),l=n*(t.height/t.width),i.height(l)),i.width(n)),(t.height>t.width||isMobile())&&(a="h2",i.height(e*(t.height/t.width))),a&&i.addClass(a)});o.isotope({layoutMode:"packery",itemSelector:".imagesWrapper",packery:{gutter:10},initLayout:!1}),o.on("arrangeComplete",function(){o.addClass("active"),t.addClass("active"),d.renderClbk&&d.renderClbk(),n&&n()}),o.isotope()})):n&&n())},list:function(n,t,e){(n=n||{}).comments=_.filter(n.comments||[],function(e){if(!v[e.id])return v[e.id]=!0});var i=append;d.fromtop&&!n.el?(n.comments=_.sortBy(n.comments,function(e){return-e.time}),i=prepend):n.comments=_.sortBy(n.comments,function(e){return e.time}),e&&(y.levels[e]=e),n.in&&(i=n.in),n.el||(n.el=c.list),I.shell({name:"list",el:n.el||c.list,inner:n.inner||i,data:{comments:n.comments||[],_class:n.class||"",newcomments:n.newcomments||"",replaceName:function(e,n){return'<span class="tocomment" comment="'+n.comment+'">'+e+"</span>"},replaceNameNoComment:function(e,n){return'<span class="tocommentno">'+e+"</span>"},mestate:m},additionalActions:function(){d.additionalActions()}},function(e){c.list.find(".reply").off("click").on("click",W.replyandreplies),c.list.find(".replies").off("click").on("click",W.replies),c.list.find(".panel").off("click").on("click",W.metmenu),c.list.find(".tocomment").off("click").on("click",W.tocomment),c.list.find(".imageCommentOpen").off("click").on("click",W.openGallery),setTimeout(function(){c.list&&c.list.find(".newcomments").removeClass("newcomments")},600),bgImages(c.list),lazyEach({array:n.comments,action:function(e){j.commentimages(e.item,e.success)}}),d.renderClbk&&d.renderClbk(),t&&t()})}},S=function(n){var t={};j.post(function(e){w[0]=e}),A.preview(function(e){t.comments=e,t.class="firstcomment",z.showhideLabel(),c.list.html(""),j.list(t,function(){n&&n()})})},T=function(n){var t={};A.level(null,function(e){t.comments=I.app.platform.sdk.comments.storage[r][0],t.class="firstcomment",z.showhideLabel(),c.list.html(""),j.list(t,function(){c.c.find(".loaderWrapper").addClass("hidden"),j.post(function(e){var n;w[0]=e,d.reply?z.fastreply(d.reply):(n={},(e=parameters()).commentid&&(n.answerid=e.commentid,n.parentid=e.parentid||"",n.noaction=!0,z.fastreply(n)))}),n&&n()})})},A={preview:function(e){var n=[];d.lastComment&&(n=I.app.platform.sdk.comments.ini([d.lastComment])),I.sdk.comments.users(n,function(){e&&e(n)})},level:function(e,t){I.app.platform.sdk.comments.get(r,e||"",function(e,n){t&&t(e,n)})}},L={save:function(){},load:function(){var e=I.app.settings.get(I.map.id,r);e&&p[0].import(e)}};return{primary:e,getdata:function(n,e){var t;a=e.settings.eid,v={},p={},y={reply:null,levels:{}},d=e.settings.essenseData||{},f=d.preview||!1,u=f,s=!1,r=d.txid||null,p[0]=new Comment(r),r&&((t={}).ed=d,I.app.platform.sdk.ustate.me(function(e){m=e,n(t)}))},authclbk:function(){c&&c.c&&(g=!0,I.app.platform.sdk.ustate.me(function(e){m=e,n(function(){z.myscores(),g=!1}),j.post(function(e){w[0]=e})}))},destroy:function(){delete I.app.platform.sdk.comments.sendclbks[a],delete I.app.platform.ws.messages.comment.clbks[a],delete I.app.platform.sdk.comments.upvoteClbks[a],delete I.app.platform.ws.messages.cScore.clbks[a],g=!1,k&&k.destroy(),l&&l.destroy(),c={}},init:function(e){(c={}).c=e.el.find("#"+I.map.id),c.post=c.c.find(".post"),c.list=c.c.find(".list"),c.caption=c.c.find(".captionCnt"),c.showall=c.c.find(".showall"),t=c.c.closest(".wndcontent"),i=t.length?0:(t=null,65),f?(c.c.find(".loaderWrapper").addClass("hidden"),c.c.addClass("preview"),c.c.addClass("listpreview"),S()):(T(),d.showall&&z.showall()),c.c.find(".showall").on("click",function(){z.showall()}),I.app.platform.sdk.comments.sendclbks[a]=x,I.app.platform.sdk.comments.upvoteClbks[a]=b,I.app.platform.ws.messages.comment.clbks[a]=function(e){if(e.posttxid==r){var n={};if(n.comments=[e.comment],e.parentid){e=c.c.find("#"+e.parentid);if(n.el=e.find(".answers"),e.find(".repliescount").html(Number(e.find(".repliescount").html()||"0")+1),e.find(".replies").removeClass("hidden"),!e.hasClass("showedreplies"))return}else n.el=c.c.find(".list"),n.class="firstcomment";j.list(n)}},I.app.platform.ws.messages.cScore.clbks[a]=function(e){e.comment.txid==r&&b(null,e.comment,e.upvoteVal||e.value,e.addrFrom)},c.c.on("click",".upvoteComment",W.upvoteComment),e.clbk(null,e)},freeze:function(){l&&l.destroy()},hideall:function(e){s=!1,(u=void 0!==e?e||!1:u)?(c.c.addClass("listpreview"),l&&l.destroy(),l=null):c.c.removeClass("listpreview"),c.c.removeClass("showedall"),z.hideallReplies(),z.showhideLabel()},changein:function(e,n){e?(t=e,i=n,l&&(l.addscroll=!0,l.setOffset([i,0]),l.setIn(t))):(t=c.c.closest(".wndcontent"),i=t.length?0:(t=null,65),l&&(l.addscroll=!!t,l.setOffset([i,0]),l.setIn(t)))}}}var I=new nModule,i={};return I.run=function(e){var n=I.addEssense(i,t,e);I.init(n,e)},I.authclbk=function(){_.each(i,function(e){e.authclbk()})},I.stop=function(){_.each(i,function(e){e.destroy()})},I}();"undefined"!=typeof module?module.exports=comments:(app.modules.comments={},app.modules.comments.module=comments);
 /*_____*/ 
var send=function(){function a(n){function e(){var n;a.c.find(".send").on("click",i.send),a.am.on("change",function(){var n=$(this).val();t.amount=n}),0<(n={alias:"numeric",groupSeparator:",",radixPoint:".",digits:6,digitsOptional:!1,autoGroup:!0,allowMinus:!1}).digits&&(n.placeholder="0.000000"),a.am.inputmask(n),parameters().setammount||a.am.blur()}var a,t,n=deep(n,"history"),i={stateAction:function(e,a){o.app.user.isState(function(n){n?a():o.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{loginText:o.app.localization.e("llogin"),successHref:e,signInClbk:function(){a&&a()}}})})},send:function(){i.stateAction("_this",function(){o.nav.api.load({open:!0,history:!0,href:"userpage?id=wallet&action=send&address="+t.address+"&amount="+t.amount})})}},s=function(){};return{primary:n,getdata:function(n){var e=parameters();t={},e.address&&bitcoin.address.fromBase58Check(e.address)&&(t.address=e.address),e.amount&&(t.amount=Number(e.amount)),e.label&&(t.label=clearScripts(donottrustLink(findAndReplaceLink(e.label,!0)))),e.message&&(t.message=clearScripts(donottrustLink(findAndReplaceLink(hexDecode(e.message,!0))))),t.amount&&t.address&&t.message?n(t):o.nav.api.load({open:!0,href:"page404",history:!0})},destroy:function(){a={}},init:function(n){s(),(a={}).c=n.el.find("#"+o.map.id),a.am=a.c.find(".amredit"),e(),n.clbk(null,n)}}}var o=new nModule,t={};return o.run=function(n){var e=o.addEssense(t,a,n);o.init(e,n)},o.stop=function(){_.each(t,function(n){n.destroy()})},o}();"undefined"!=typeof module?module.exports=send:(app.modules.send={},app.modules.send.module=send);
 /*_____*/ 
var menu=function(){function a(){function e(){r&&r.placeholder(u.app.localization.e("e13139")),c=null}var s,n=null,t=null,a=null,c=null,r=null,i=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),format:{right:!0},_onChange:function(e){e=app.localization.findByName(e);e&&e.key!=app.localization.key&&app.localization.set(e.key)}}),l={autoUpdate:function(){u.app.user.isState(function(e){})},elswidth:function(){s.c.find(".autowidth.active").each(function(){l.setWidth($(this))})},setWidth:function(e){var n,a;isMobile()||e.offset()&&(a=e.offset().left,n=e.width(),a=a-(s.c.width()-a-n),e.width(n+a))},ah:function(e,n){0<n?e.addClass("amountHave"):e.removeClass("amountHave"),e.find(".amount").html(n)},sitenameToNav:function(){o.navinit.el&&(a=slowMade(function(){var e,n=u.app.nav.current.href;("index"==n||"author"==n)&&45<$(window).scrollTop()?(s.nav.addClass("active"),s.c.addClass("menupanelactive"),s.nav.find(".pcenterLabel").removeClass("active"),e=parameters(u.app.nav.current.completeHref,!0).r||"empty","index"==n&&s.nav.find('.pcenterLabel[r="'+e+'"]').addClass("active")):(s.c.removeClass("menupanelactive"),s.nav.removeClass("active")),l.elswidth()},a,10))}},o={navinit:{init:function(e){isTablet()||($(window).on("scroll",l.sitenameToNav),u.app.nav.clbks.history.menu=function(e){l.sitenameToNav()})},destroy:function(){$(window).off("scroll",l.sitenameToNav),delete u.app.nav.clbks.history.menu}},sitename:{click:function(){u.app.user.isState(function(e){var n;"index"!=u.app.nav.get.pathname()&&(n=localStorage.lentakey||"index","index"!=(n=parameters().r==n?"index":n)&&(n="index?r="+n),e||(n="index"),u.nav.api.go({href:n,history:!0,open:!0,handler:!0}))})}},activate:{click:function(){dialog({header:u.app.localization.e("id167"),html:u.app.localization.e("id168"),class:"one",btn1text:u.app.localization.e("id169"),success:function(){u.app.platform.sdk.user.activateWithDialogs(function(e){})}})}},keyexport:{click:function(){u.app.platform.ui.showmykey()},init:function(n){u.app.platform.sdk.registrations.clbks.menu=function(){if(u.sdk.address.pnet()){var e=u.sdk.address.pnet().address,e=u.app.platform.sdk.registrations.storage[e];if(e&&e<=4)return}n.closest(".keyexportWrapper").remove(),delete u.app.platform.sdk.registrations.clbks.menu}}},notifications:{init:function(n){function a(){return _.filter(u.app.platform.sdk.notifications.storage.notifications,function(e){if(!e.seen)return!0})}var t=null;"undefined"!=typeof cordova&&(t=deep(cordova,"plugins.notification.badge")),u.app.platform.sdk.notifications.init(function(){var e=a().length;l.ah(n,e),t&&t.set(e),u.app.platform.api.electron.notifications(e,"notifications"),isMobile()||u.nav.api.load({open:!0,id:"notifications",el:n,inTooltip:!0})}),u.app.platform.sdk.notifications.clbks.added.menu=u.app.platform.sdk.notifications.clbks.seen.menu=function(){var e=a().length;t&&t.set(e),l.ah(n,e),u.app.platform.api.electron.notifications(e,"notifications")}},click:function(e){isMobile()&&u.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0})}},messenger:{init:function(e){function n(){var a=0;return _.each(t.storage.chat,function(e,n){a+=e.messages.unreaded}),a}var t=u.app.platform.clientrtc.rtchttp;u.app.platform.clientrtc.rtchttp.info.allchats(function(){l.ah(e,n())}),u.app.platform.sdk.messenger.clbks.menu=function(){l.ah(e,n())}},click:function(e){isMobile()?u.nav.api.load({href:"messenger",history:!0,open:!0}):u.nav.api.go({href:"userpage?id=messenger&report=messenger",history:!0,open:!0})}},savecross:{init:function(n){var e=deep(u.app,"platform.sdk.user.storage.me.rc")||0;l.ah(n,e),u.app.platform.ws.messages.event.clbks.menusave=function(e){"userInfo"==e.mesType&&(e=deep(u.app,"platform.sdk.user.storage.me.rc")||0,l.ah(n,e))}},click:function(){u.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{rescue:!0}})}},search:{click:function(){s.c.toggleClass("searchactive"),s.c.hasClass("searchactive")?(searchBackAction=null,s.postssearch.find("input").focus(),s.postssearch.addClass("active"),n&&(clearTimeout(n),n=null)):(s.postssearch.removeClass("active"),s.postssearch.find("input").val(""),c&&c.clear()),l.elswidth()}},searchinit:{init:function(t){function i(e){"s"!=u.app.nav.current.href||e?(t.find("input").val(""),s.c.removeClass("searchactive"),o()):searchBackAction&&(searchBackAction(),searchBackAction=null)}var o=function(){n&&(clearTimeout(n),n=null)};r=new search(s.postssearch,{placeholder:u.app.localization.e("e13139"),clbk:function(e){e.find("input").on("blur",function(){n=slowMade(function(){i()},n,200)})},last:{get:function(){return[]},tpl:function(e,n){}},events:{fastsearch:function(n,a){u.app.platform.sdk.search.get(n,"fs",null,null,null,function(e){p.results(e||{},n,function(e){a(e,function(e,a){bgImages(e),e.find(".result").on("click",function(){var e=$(this).attr("result");t.find("input").val(e);var n="s?ss="+e.replace("#","tag:");c&&(n="?report=shares&ss="+e.replace("#","tag:"),c.clear(!0));n={href:n,history:!0,open:!0};c&&(n.handler=!0),u.nav.api.go(n),a.closeResults(),o()}),e.find(".user").on("click",function(){var e=$(this).attr("address");u.nav.api.go({href:"author?address="+e,history:!0,open:!0}),a.closeResults(),i(),o()})})})})},search:function(e,n,a,t){var i="s?ss="+e.replace("#","tag:");c&&(i="?report=shares&ss="+e.replace("#","tag:"),c.clear(!0));i={href:i,history:!0,open:!0};c&&(i.handler=!0),u.nav.api.go(i),t.closeResults(),o(),n&&n(!0)},clear:function(e){e||(t.find("input").blur(),setTimeout(function(){i(!0),o()},100))}}})}},newaccount:{click:function(){u.nav.api.go({href:"registration",history:!0,open:!0})}},state:{init:function(e){function n(){_.isEmpty(u.app.errors.state)?e.addClass("hidden"):e.removeClass("hidden")}n(),u.app.errors.clbks.menu=function(){n()},e.tooltipster({theme:"tooltipster-light",maxWidth:300,zIndex:200})}},wallets:{click:function(){u.nav.api.go({open:!0,href:"userpage?id=wallet",history:!0})},init:function(t){function e(){u.app.platform.sdk.node.transactions.get.allBalance(function(e){var a,n=(e+=u.app.platform.sdk.node.transactions.tempBalance())-s;o&&(n=0,s=e),o=!1,a=s,n=n,t.removeClass("hidden"),0==n?(i.text(u.app.platform.mp.coin(a)),l.elswidth()):i.animateNumber({number:n,numberStep:function(e,n){l.elswidth();e=Number(a+e).toFixed(8);$(n.elem).text(u.app.platform.mp.coin(e))}},rand(400,1200),function(){t.removeClass("good")}),s=e,u.app.platform.sdk.wallet.drawSpendLine(t.find(".numberWrp"))})}function n(){e()}var i=t.find(".number"),o=!0,s=0;u.app.platform.sdk.node.transactions.clbks.menu=n,n()}},signout:{click:function(){u.app.user.signout(),u.app.reload({href:"authorization"})}},signin:{init:function(e){},click:function(){u.nav.api.go({href:"authorization",history:!0,open:!0})}},signup:{init:function(e){},click:function(){u.nav.api.go({href:"registration",history:!0,open:!0})}}},p={results:function(e,n,a){u.shell({name:"results",data:{results:e,value:n}},function(e){a&&a(e.rendered)})}};return{getdata:function(e,n){var a,t={};i.value=app.localization.current().name,t.loc=i,t._SEO=_SEO,t.lkey=app.localization.current(),n.state?(a=u.sdk.address.pnet().address,(n=u.app.platform.sdk.registrations.storage[a])&&n<=5&&(t.key=!0),u.app.platform.sdk.users.getone(a,function(){e(t)})):e(t)},destroy:function(){e(),r=null,$(window).off("resize",l.elswidth),delete u.app.platform.sdk.node.transactions.clbks.menu,delete u.app.platform.ws.messages.event.clbks.menusave,delete u.app.platform.sdk.notifications.clbks.seen.menu,delete u.app.platform.sdk.notifications.clbks.added.menu,delete u.app.platform.sdk.messenger.clbks.menu,delete u.app.errors.clbks.menu,delete u.app.platform.sdk.registrations.clbks.menu,t&&clearInterval(t),_.each(o,function(e){delete e.el,e.destroy&&e.destroy()}),s={}},closesearch:function(){s.c&&s.c.removeClass("searchactive")},showsearch:function(e,n){s.c.addClass("searchactive"),s.postssearch.find("input").val(e.replace("tag:","#")),searchBackAction=n||null,l.elswidth(),setTimeout(function(){l.elswidth()},2)},initauthorsearch:function(e){e.data&&(e=e,r&&r.placeholder(u.app.localization.e("e13140")+" "+e.data.name.toUpperCase()),c=e)},destroyauthorsearch:function(){e()},init:function(e){var n,a;(s={}).c=e.el.find("#"+u.map.id),s.a=e.el.find(".additionalbar"),s.cart=s.c.find(".cart"),s.likes=s.c.find(".favorites"),s.messagesCount=s.c.find(".dialogs .count"),s.notificationsCount=s.c.find(".notifications .count"),s.walletsAmount=s.c.find(".wallets .amount"),s.notactive=s.c.find(".notactive"),s.currency=s.c.find(".currencyWrapper"),s.postssearch=s.c.find(".postssearch"),s.nav=s.c.find(".menutoppanel"),s.c.find(".localizationicon").on("click",function(){var e=[];_.each(u.app.localization.available,function(a){e.push({text:a.name,action:function(e){var n=app.localization.findByName(a.name);n&&n.key!=u.app.localization.key&&u.app.localization.set(n.key),e()}})}),menuDialog({items:e})}),s.c.find("[events]").each(function(){var a=$(this),e=a.attr("events");o[e]&&(o[e].el=a,_.each(o[e],function(e,n){"init"==n?e(a):a.on(n,e)}))}),$(window).on("resize",l.elswidth),ParametersLive([i],s.c),t=setInterval(l.autoUpdate,100),"undefined"!=typeof _Electron&&(n=require("electron").remote,a=function(){n.getCurrentWindow().isFullScreen()?s.c.addClass("fullscreen"):s.c.removeClass("fullscreen")},s.c.find(".closeApp").on("click",function(){n.getCurrentWindow().close()}),s.c.find(".miniizeApp").on("click",function(){n.getCurrentWindow().minimize()}),s.c.find(".toggleMinMax").on("click",function(){var e=n.getCurrentWindow();e.setFullScreen(!e.isFullScreen()),a()}),a()),u.app.user.isState(function(e){parameters().ss&&(isMobile()||"s"==u.app.nav.get.pathname())&&(s.c.addClass("searchactive"),s.c.find(".postssearch").addClass("active"),l.elswidth(),s.postssearch.find("input").val(parameters().ss.replace("tag:","#")))}),e.clbk(null,e)}}}var u=new nModule,t={};return u.run=function(e){var n=u.addEssense(t,a,e);u.init(n,e)},u.stop=function(){_.each(t,function(e){e.destroy()})},u.initauthorsearch=function(n){_.each(t,function(e){e.initauthorsearch(n)})},u.destroyauthorsearch=function(){_.each(t,function(e){e.destroyauthorsearch()})},u.closesearch=function(){_.each(t,function(e){e.closesearch()})},u.showsearch=function(n){_.each(t,function(e){e.showsearch(n)})},u}();"undefined"!=typeof module?module.exports=menu:(app.modules.menu={},app.modules.menu.module=menu);
 /*_____*/ 
var toppanel=function(){function a(e){var t,e=deep(e,"history"),a={index:"index",sub:"index?r=sub",recommended:"index?r=recommended"},o=function(){var e=_.toArray(a),n=parameters(p.app.nav.current.completeHref,!0).r||"index",e=new Parameter({type:"VALUES",name:"Contents",id:"contents",possibleValues:e,possibleValuesLabels:[p.app.localization.e("e13136"),p.app.localization.e("e13137"),p.app.localization.e("e13138")],defaultValue:a[n]});return e.value=a[n],e._onChange=function(e){p.nav.api.load({open:!0,href:e,history:!0})},e},n=function(n){var a=o();p.app.user.isState(function(e){e&&isMobile()&&"index"!=n?t.c.addClass("hidden"):(t.c.removeClass("hidden"),p.shell({name:"menu",el:t.menu,data:{pathname:n,state:e,mobile:isTablet(),selector:a}},function(e){ParametersLive([a],e.el)}))})},i=function(){};return{primary:e,getdata:function(e){e({})},destroy:function(){delete p.app.nav.clbks.history.toppanel,t={}},init:function(e){i(),(t={}).c=e.el.find("#"+p.map.id),t.menu=t.c.find(".panelitems"),p.app.nav.clbks.history.toppanel=function(e){n(app.nav.current.href)},n(p.app.nav.current.href),e.clbk(null,e)}}}var p=new nModule,t={};return p.run=function(e){var n=p.addEssense(t,a,e);p.init(n,e)},p.stop=function(){_.each(t,function(e){e.destroy()})},p}();"undefined"!=typeof module?module.exports=toppanel:(app.modules.toppanel={},app.modules.toppanel.module=toppanel);
 /*_____*/ 
var navigation=function(){function i(n){var o,i,n=deep(n,"history"),e=function(){250<i.scrollTop()?o.c.addClass("scrolled"):o.c.removeClass("scrolled")},a=function(){_scrollTop(0,null,0)},t=function(n){var e=localStorage.lentakey||"index?b=true";-1==(e="index"==e?"index?b=true":e).indexOf("?")&&(e="index?r="+e);var i=c.app.nav.api.backChainGet();c.shell({name:"menu",inner:html,el:o.menu,data:{back:i,href:n,lentakey:e}},function(n){n.el.find(".toup").on("click",a)})},d=function(){o.c&&o.c.closest("#navigationWrapper").addClass("hidden")},r=function(){o.c&&o.c.closest("#navigationWrapper").removeClass("hidden")},l=function(){};return{primary:n,getdata:function(n,e){i=$(window),n({})},destroy:function(){window.removeEventListener("scroll",e),window.cordova&&(window.removeEventListener("keyboardWillShow",d),window.removeEventListener("keyboardWillHide",r)),delete c.app.nav.clbks.history.navigation,o&&(o.c&&o.c.remove(),o={})},init:function(n){l(),(o={}).c=n.el.find("#"+c.map.id),o.menu=o.c.find(".nmenu"),c.app.nav.clbks.history.navigation=function(n){t(c.app.nav.get.pathname())},window.addEventListener("scroll",e),window.cordova&&(window.addEventListener("keyboardWillShow",d),window.addEventListener("keyboardWillHide",r)),n.clbk(null,n),t(c.app.nav.get.pathname())}}}var c=new nModule,o={};return c.run=function(n){var e=c.addEssense(o,i,n);c.init(e,n)},c.stop=function(){_.each(o,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=navigation:(app.modules.navigation={},app.modules.navigation.module=navigation);
 /*_____*/ 
var footer=function(){function o(a){var e,a=deep(a,"history"),o=new Parameter({type:"VALUES",name:"Localization",id:"localization",defaultValue:app.localization.current().name,possibleValues:app.localization.availableMap("name"),possibleValuesLabels:app.localization.availableMap("name"),format:{right:!0},_onChange:function(a){a=app.localization.findByName(a);a&&a.key!=app.localization.key&&app.localization.set(a.key)}}),n=function(){};return{primary:a,getdata:function(a){var e={};e._SEO=_SEO,e.loc=o,a(e)},destroy:function(){e={}},init:function(a){n(),(e={}).c=a.el.find("#"+i.map.id),ParametersLive([o],e.c),a.clbk(null,a)}}}var i=new nModule,n={};return i.run=function(a){var e=i.addEssense(n,o,a);i.init(e,a)},i.stop=function(){_.each(n,function(a){a.destroy()})},i}();"undefined"!=typeof module?module.exports=footer:(app.modules.footer={},app.modules.footer.module=footer);
 /*_____*/ 
var notifications=function(){function i(a){var s,t,r,n=deep(a,"history"),l="",c=function(){var n=s.c.find(".notification:not(.seen)");n.length&&(t=slowMade(function(){g.app.platform.sdk.notifications.seenall(),0<n.length&&n.addClass("seen")},t,50))},d=function(){g.nav.api.go({href:"userpage?id=notifications&report=notifications",history:!0,open:!0}),g.closeContainer()},f=function(){c()},p={notifications:function(t,n){var e,i,o,a,r=(t=t||{}).notifications||g.app.platform.sdk.notifications.storage.notifications,l=!1;t.el=s.new,t.el&&(g.app.platform.currentTime(),t.seenFilter,e=-r.length+(t.notifications||g.app.platform.sdk.notifications.storage.notifications).length,r=_.sortBy(r,function(n){return Number(-n.nblock)}),i=new Date,o=group(r,function(n){if(t.now)return"ntnow";n=new Date(1e3*n.time);return n.addMinutes(60)>i?"ntlasthour":dateToStrSmall(n)==dateToStrSmall(i)?"nttoday":n.getFullYear().toString()+(n.getMonth()+1).toString()==i.getFullYear().toString()+(i.getMonth()+1).toString()?"ntmounth":"ntearlier"}),t.now&&((a=t.el.find('.group[index="ntnow"]')).length&&(t.el=a.find(".groupContent")),l=!0),g.shell({name:"notifications",el:t.el,data:{notifications:r,ws:g.app.platform.ws,now:t.now,grou:o,rnow:l},inner:prepend},function(i){p.loadingAndEmpty(),e&&s.c.find(".more").html("("+e+")");var o=g.app.platform.ws;_.each(r,function(n){var t=null;n.mesType&&(t=o.messages[n.mesType]),(t=n.msg&&!t?o.messages[n.msg]:t)&&t.fastMessageEvents&&t.fastMessageEvents(n,{el:i.el.find('.notification[notification="'+n.txid+'"]')})}),g.app.nav.api.links(null,s.c,function(){g.closeContainer()}),c()}))},loadingAndEmpty:function(){if(g.app.errors.connection())return s.loader.addClass("hidden"),s.empty.addClass("hidden"),void s.error.removeClass("hidden");s.error.addClass("hidden"),g.app.platform.sdk.notifications.loading?s.loader.removeClass("hidden"):(s.loader.addClass("hidden"),s.c.find(".notification").length?s.empty.removeClass("hidden"):s.loader.addClass("hidden"))}},u=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){s={},l="",t&&clearTimeout(t),t=null,r.removeEventListener("scroll",f),delete g.app.platform.sdk.notifications.clbks.added["notifications"+l],delete g.iclbks.lenta},init:function(n){var i,o,t,e;u(),(s={}).c=n.el.find("#"+g.map.id),s.new=s.c.find(".newWrapper"),s.loader=s.c.find(".loader"),s.empty=s.c.find(".empty"),s.error=s.c.find(".error"),"tooltip"==n.insert?(r=s.c.find(".nabsContentWrapper")[0],l="tt"):(l="",r=window),jinel=$(r),p.loadingAndEmpty(),s.c.find(".showAll").on("click",d),r.addEventListener("scroll",f),s.c.find(".closecontainer").on("click",function(){g.closeContainer()}),g.iclbks.lenta=function(){p.loadingAndEmpty()},isMobile()&&(i=s.c.find(".circularprogress"),(o=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),s.c.find(".circularprogressWrapper").html(o.el),t=$(window),e=new SwipeParallax({el:s.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(n){var t=Math.abs(n)/200;0<=n&&(o.options.text={value:""},o.update(100*t),i.height(220*t+"px"))},constraints:function(){if(0==t.scrollTop())return!0},restrict:!0,trueshold:200,clbk:function(){g.app.platform.sdk.notifications.getNotifications(function(){e.renew()})}}}}).init()),n.insert,p.notifications({seenFilter:a.inTooltip}),g.app.platform.sdk.notifications.clbks.added["notifications"+l]=function(n,t){p.notifications({notifications:n,now:t})},n.clbk(null,n)},tooltip:{options:{theme:"lighttooltip notificationTolltip",position:"left",zIndex:50,distance:-47,functionPosition:function(n,t,i){return i.coord.top=0,i.coord.left=0,i},arrow:!1,trigger:"custom",triggerOpen:{click:!0},triggerClose:{}},event:"click"}}}var g=new nModule,o={};return g.run=function(n){var t=g.addEssense(o,i,n);g.init(t,n)},g.stop=function(){_.each(o,function(n){n.destroy()})},g}();"undefined"!=typeof module?module.exports=notifications:(app.modules.notifications={},app.modules.notifications.module=notifications);
 /*_____*/ 
var panel=function(){function s(n){var c,n=deep(n,"history"),s=null,t=null,e=null,i=null,a={tags:function(){u.nav.api.load({open:!0,id:"tagcloud",el:c.tags,animation:!1,clbk:function(n,e){t=e}})},recommendationslist:function(n,e){n.length&&c.c&&u.shell({name:"recommendationslist",el:c.r.find(".userslist"),data:{users:n},bgImages:{clbk:function(n){$(n.elements[0]).addClass("active")}}},function(n){e&&e()})},lastcomments:function(n,e){u.nav.api.load({open:!0,id:"lastcomments",el:c.comments,animation:!1,clbk:function(n,e){0}})},recommendations:function(r,n){r.length&&c.c?u.shell({name:"recommendations",el:c.r,data:{users:r}},function(l){a.recommendationslist(r,function(){var e=0,s=4,t=l.el.find(".userslist"),i=l.el.find(".arrow"),a={uleft:l.el.find(".uleft"),uright:l.el.find(".uright")},o={clickArrow:function(n){"left"==n&&(e-=s)<0&&(e=0),"right"==n&&(e+=s)>=r.count&&(e=r.count-1),o.slideCarousel()},displayArrows:function(){0<e?o.displayArrow("left",!0):o.displayArrow("left",!1),e+s<r.length?o.displayArrow("right",!0):o.displayArrow("right",!1)},displayArrow:function(n,e){n=n?a["u"+n]:i;e?n.addClass("active"):n.removeClass("active")},slideCarousel:function(){var n=c.c.find(".user").width(),n=e*n;t.css("margin-left","-"+n+"px"),o.displayArrows()},applyCarousel:function(){var n=l.el.find(".user").width(),e=l.el.find(".userslistwrapper").width();s=Math.min(Number((e/n).toFixed(0)),4),c.c.find(".user").width((e/s).toFixed(0)+"px"),t.width((r.length*(e/s)).toFixed(0)+1),o.slideCarousel()}},n=function(){var n=$(this).attr("arrow");o.clickArrow(n)};o.applyCarousel(),l.el.find(".arrow").on("click",n)})}):c.r.html("")},discussions:function(){var n=i.discussions||{};n.view="fixedin",u.nav.api.load({open:!0,id:"discussions",el:c.cnt,animation:!1,essenseData:n,clbk:function(n,e){s=e}})},_discussions:function(){u.user.isState(function(n){n&&((n=u.app.platform.sdk.users.storage[u.app.platform.sdk.address.pnet().address]).relay||n.temp||a.discussions())})}},o=function(s){u.app.user.isState(function(n){var e;n?(e=u.sdk.address.pnet().address,u.sdk.users.get(e,function(){var n=deep(u,"sdk.users.storage."+e+".recomendedSubscribes");n&&n.length?u.sdk.users.get(n,function(){s&&s(n)}):s&&s([])})):s&&s([])})},l=function(){};return{primary:n,getdata:function(n,e){i=e.settings.essenseData||{};n({})},destroy:function(){delete u.app.platform.clbks.api.actions.subscribe.panelrec,delete u.app.platform.ws.messages.event.clbks.panel,s&&(s.destroy(),s=null),t&&(t.destroy(),t=null),e&&(e.destroy(),e=null),c={}},authclbk:function(){},init:function(n){l(),(c={}).c=n.el.find("#"+u.map.id),c.cnt=c.c.find(".panelcnt"),c.tags=c.c.find(".tagscnt"),c.comments=c.c.find(".lastcommentscnt"),c.r=c.c.find(".recommendationscnt"),u.app.platform.clbks.api.actions.subscribe.panelrec=function(){o(function(n){a.recommendations(n)})},u.app.platform.ws.messages.event.clbks.panel=function(n){"userInfo"==n.mesType&&a._discussions()},u.app.platform.sdk.usersettings.meta.vidgetchat.value&&a._discussions(),u.app.platform.sdk.usersettings.meta.vidgettags.value&&a.tags(),u.app.platform.sdk.usersettings.meta.vidgetlastcomments.value&&a.lastcomments(),n.clbk(null,n)}}}var u=new nModule,t={};return u.authclbk=function(){_.each(t,function(n){n.authclbk()})},u.run=function(n){var e=u.addEssense(t,s,n);u.init(e,n)},u.stop=function(){_.each(t,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=panel:(app.modules.panel={},app.modules.panel.module=panel);
 /*_____*/ 
var aboutus=function(){function o(n){var n=deep(n,"history"),u=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){0},init:function(n){u(),{}.c=n.el.find("#"+t.map.id),n.clbk(null,n)}}}var t=new nModule,e={};return t.run=function(n){var u=t.addEssense(e,o,n);t.init(u,n)},t.stop=function(){_.each(e,function(n){n.destroy()})},t}();"undefined"!=typeof module?module.exports=aboutus:(app.modules.aboutus={},app.modules.aboutus.module=aboutus);
 /*_____*/ 
var support=function(){function t(n){var o,n=deep(n,"history"),t={send:function(){var n=t.values();n?(o.c.removeClass("showError"),topPreloader(20),u.app.platform.sdk.user.support(n,function(){topPreloader(100),dialog({html:u.app.localization.e("contactSuccess"),class:"one"}),$.each(o.inputs,function(){$(this).val("")})})):o.c.addClass("showError")},values:function(){var t={},e=!0;return $.each(o.inputs,function(){var n=$(this),o=n.val(),n=n.attr("systemId");o?t[n]=o:e=!1}),e?t:null}},e=function(){t.send()},s=function(){};return{primary:n,getdata:function(n){n({})},destroy:function(){o={}},init:function(n){s(),(o={}).c=n.el.find("#"+u.map.id),o.send=o.c.find(".send"),o.inputs=o.c.find(".forminput"),o.send.on("click",e),n.clbk(null,n)}}}var u=new nModule,e={};return u.run=function(n){var o=u.addEssense(e,t,n);u.init(o,n)},u.stop=function(){_.each(e,function(n){n.destroy()})},u}();"undefined"!=typeof module?module.exports=support:(app.modules.support={},app.modules.support.module=support);
 /*_____*/ 
var wallet=function(){function t(e){function a(e,i){lazyEach({array:_.toArray(o),sync:!0,action:function(l){var o=l.item,e=o.addresses();b.app.platform.sdk.node.transactions.get.balance(function(r){b.app.platform.sdk.node.transactions.get.canSpend(e,function(e,a){var t="#414244",n=100,s=b.app.platform.sdk.node.transactions.tempBalance();a&&(n=100*e/(a="pnetwallet"==o.id||"total"==o.id?s+a:a),t="#0F8623");t={positive:{summary:n,color:t}};e<a&&(t.neutral={summary:100-n,color:"#414244"}),"pnetwallet"!=o.id&&"total"!=o.id||(r=s+r),h.total({label:o.label,id:o.id,balance:r,move:t,update:i},l.success)})},e)},all:{success:function(){e&&e()}}})}var l,e=deep(e,"history"),r={},o={pnetwallet:{label:b.app.localization.e("tacaddress"),alabel:b.app.localization.e("tacaddress"),id:"pnetwallet",addresses:function(){return[b.app.platform.sdk.address.pnet().address]}},wallet:{label:b.app.localization.e("twallet"),id:"wallet",addresses:function(){return b.app.platform.sdk.addresses.storage.addresses||[]},caption:b.app.localization.e("twalletaddresses")},total:{label:b.app.localization.e("tTotal"),id:"total",addresses:function(){return[b.app.platform.sdk.address.pnet().address].concat(b.app.platform.sdk.addresses.storage.addresses||[])}}},c={parameters:{source:new Parameter({name:b.app.localization.e("source"),type:"VALUES",id:"source",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress"),b.app.localization.e("tTotal")],possibleValues:["wallet","pnetwallet","total"],placeholder:b.app.localization.e("wsselect")}),reciever:new Parameter({name:b.app.localization.e("wsreciever"),type:"VALUESCUSTOM",id:"reciever",possibleValuesLabels:[],possibleValues:[],placeholder:b.app.localization.e("wsenter"),onType:!0}),amount:new Parameter({name:b.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),message:new Parameter({name:b.app.localization.e("message"),id:"message",type:"stringany",placeholder:b.app.localization.e("yourmessage"),format:{Length:80}}),fees:new Parameter({name:b.app.localization.e("wsincludefees"),type:"VALUES",id:"fees",defaultValue:"include",possibleValuesLabels:[b.app.localization.e("wsrecieverpay"),b.app.localization.e("wssenderpay")],possibleValues:["include","exclude"]})}},n={wallet:b.app.localization.e("twallet"),pnetwallet:b.app.localization.e("tacaddress")},s={active:!1,parameters:{deposit:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"deposit",defaultValue:"wallet",possibleValuesLabels:[b.app.localization.e("twallet"),b.app.localization.e("tacaddress")],possibleValues:["wallet","pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),depositamount:new Parameter({name:b.app.localization.e("wdamount"),id:"depositamount",type:"NUMBER",placeholder:b.app.localization.e("wdenteramount"),onType:!0,format:{Precision:6}}),message:new Parameter({name:b.app.localization.e("wdmessage"),id:"message",type:"TEXT",placeholder:b.app.localization.e("wdmessageplaceholder"),onType:!0}),label:new Parameter({name:b.app.localization.e("wdlabel"),id:"label",type:"STRING",onType:!0})}},i={active:!1,parameters:{reciever:new Parameter({name:b.app.localization.e("wrecieveon"),type:"VALUES",id:"reciever",defaultValue:"pnetwallet",possibleValuesLabels:[b.app.localization.e("tacaddress")],possibleValues:["pnetwallet"],placeholder:b.app.localization.e("wdselectfrom")}),amount:new Parameter({name:b.app.localization.e("e13214"),id:"amount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}}),currency:new Parameter({name:b.app.localization.e("currency"),id:"currency",type:"VALUES",defaultValue:"btc",possibleValuesLabels:["BTC","LTC"],possibleValues:["btc","ltc"],placeholder:b.app.localization.e("e13215")}),currencyAmount:new Parameter({name:b.app.localization.e("e13216"),id:"currencyAmount",type:"NUMBER",placeholder:b.app.localization.e("wsamountof"),format:{Precision:6}})},segments:[{id:"AWAITINGFUNDS",time:180,exclude:"all",label:function(e,a,t){if(e==this.id)return'<div class="todeal">'+t.currency.toUpperCase()+": "+a.Address+' <i class="fas fa-chevron-circle-right"></i> </div>'},currentLabel:function(e){return"Awaitng Funds. Address will be valid for <b>"+e.MinutesLeft+" minutes</b>"}},{id:"EXPIREDAWAITINGFUNDS",class:"bad",finish:!0,exclude:"all",label:function(e,a){return b.app.localization.e("e13217")},currentLabel:function(e){return b.app.localization.e("e13217")+' <div class="reactivate">'+b.app.localization.e("reactivate")+"</div>"}},{id:"CONFIRMATIONS0",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (0/4)"}},{id:"CONFIRMATIONS1",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (1/4)"}},{id:"CONFIRMATIONS2",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (2/4)"}},{id:"CONFIRMATIONS3",time:10,currentLabel:function(e){return b.app.localization.e("e13218")+" (3/4)"}},{id:"POCSENT",time:4,currentLabel:function(e){return b.app.localization.e("e13219")}},{id:"POCDELEVERED",finish:!0,currentLabel:function(e){return b.app.localization.e("e13220")}}]},d=[],p=[],u=0,m={showCrInStep:function(a,e,t,n){h.step(function(e){h.crowdfunding(function(e){a&&m[a](e,n),h.stepC(e,t)},e)},e,{class:"crowdfunding",view:a})},olddeal:function(e,a){h.crDeal(a,b.app.platform.sdk.exchanges.info[a.info.address],e.find(".actionbody"))},newdeal:function(n){var e={currency:i.parameters.currency.value,address:i.parameters.reciever.value,amount:i.parameters.amount.value,currencyAmount:i.parameters.currencyAmount.value};m.pocAddress(e,function(e,a,t){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0003)"):h.crDeal(a,t,n.find(".actionbody"))})},showListcount:function(t){b.app.platform.sdk.exchanges.statuses(function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0004)"):h.showListcount(a,t.find(".actionbody"))})},status:function(){},pocAddress:function(e,n){(e=e||{}).reciever&&"pnetwallet"!=e.reciever||(e.address=b.app.platform.sdk.address.pnet().address),"wallet"==e.reciever&&(e.address=b.app.platform.sdk.addresses.storage.addresses[0]),e.currency&&e.address?b.app.platform.sdk.exchanges.address(e,function(e,a,t){e?n&&n("fail",null):n&&n(null,a,t)}):n&&n("no data",null)},sendAddresses:function(){var e=c.parameters.source.value;return o[e].addresses()},canChangeSend:function(){if(c.parameters.reciever.value){var t=null;if(_.find(n,function(e,a){return t=a,c.parameters.reciever.value==e||c.parameters.reciever.value==a}))return t}return null},sendParameters:function(){var t=c.parameters.source.value;c.parameters.reciever.possibleValues=[],c.parameters.reciever.possibleValuesLabels=[],_.each(n,function(e,a){a!=t&&"total"!=t&&(c.parameters.reciever.possibleValues.push(a),c.parameters.reciever.possibleValuesLabels.push(e))}),"total"==t&&_.find(n,function(e,a){return c.parameters.reciever.value==e||c.parameters.reciever.value==a})&&(c.parameters.reciever.value=""),c.parameters.reciever.value!=t&&c.parameters.reciever.value!=n[t]||(c.parameters.reciever.value=c.parameters.reciever.possibleValuesLabels[0]),c.parameters.reciever.possibleValues.length?c.parameters.reciever.placeholder=b.app.localization.e("wrenteraddressselect"):c.parameters.reciever.placeholder=b.app.localization.e("wrenteraddress");var e=m.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){c.parameters.amount.value>e&&(c.parameters.amount.value=e)},e,null,!0)},addaddress:function(){var e=b.app.platform.sdk.addresses.storage.addresses.length;b.app.platform.sdk.addresses.addWalletAddress(e),b.app.platform.sdk.addresses.save(),topPreloader(0),k(function(){topPreloader(100)})},linkValidation:function(){return 0<s.parameters.depositamount.value&&trim(s.parameters.message.value)&&trim(s.parameters.label.value)},linkValidationQr:function(){return 0<s.parameters.depositamount.value},showDepositInStep:function(a,e,t){h.step(function(e){h.deposit(function(e){m[a](e),h.stepB(e,t)},e)},e,{class:"deposit"})},showQrResult:function(e){s.address&&m.linkValidationQr()&&h.qrResultForDeposit(s.address,e.find(".actionbody"))},showLinkResult:function(e){s.address&&m.linkValidation()&&h.linkResultForDeposit(s.address,e.find(".actionbody"))},showLinkMaker:function(e){s.address&&h.linkMakerForDeposit(s.address,e.find(".actionbody"))},showQrMaker:function(e){s.address&&h.qrMakerForDeposit(s.address,e.find(".actionbody"))},showDeposit:function(a){s.address="";var e=s.parameters.deposit.value,t="";if(s.active=!0,"pnetwallet"==e)return t=b.app.platform.sdk.address.pnet().address,s.address=t,void h.addressForDeposit(t,a.find(".actionbody"));"wallet"==e&&b.app.platform.sdk.addresses.addNewWalletAddress(function(e){b.app.platform.sdk.addresses.save(),t=e,s.address=t,h.addresses(),h.addressForDeposit(t,a.find(".actionbody"))})},showSendInStep:function(a,e,t){h.step(function(e){h.send(function(e){m[a](e),h.stepB(e,t)},e)},e,{class:"send"})},calculateFee:function(a){b.app.platform.sdk.node.fee.estimate(function(e){h.sendFees(a.find(".actionbody"),e)})},validSend:function(){var e=c.parameters.amount.value,a=c.parameters.reciever.value;return!!(0<e&&a)},prepareTransaction:function(l,o){function a(n,s,r){b.app.platform.sdk.wallet.txbase(n,_.clone(s),0,r,function(e,a,t){e?sitemessage(e):(t=b.app.platform.sdk.node.transactions.create.wallet(a,t),t=Math.min(t.virtualSize()*l,.0999),o&&o(n,s,t,r))})}var t=c.parameters.amount.value,n=c.parameters.fees.value,e=c.parameters.message.value,s=m.sendAddresses(),r=[],i=c.parameters.reciever.value;if("pnetwallet"==i||i==b.app.localization.e("tacaddress"))return r.push({address:b.app.platform.sdk.address.pnet().address,amount:t}),void a(s,r,n);"wallet"!=i&&i!=b.app.localization.e("twallet")?(r.push({address:i,amount:t}),b.sdk.wallet.embed(r,e),a(s,r,n)):b.app.platform.sdk.addresses.addNewWalletAddress(function(e){r.push({address:e,amount:t}),b.app.platform.sdk.addresses.save(),a(s,r,n)})}},f=function(){m.addaddress()},v=function(){$(this).closest(".actionbody").html("")},h={clearMain:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElement",timeouts:150},clear:!0,el:l.c.find(".animationWrapper")},e)},clearStep:function(e){b.shell({animation:{id:"fadeInByElement",selector:".fadeInByElementStep",timeouts:150},clear:!0,el:l.step},e)},mainWithClear:function(e){d=[],p=[],h.clearStep(function(){h.main(function(){k()})})},main:function(e){b.shell({name:"main",el:l.main,data:{},animation:"fadeIn"},function(){l.total=l.c.find(".total .tttl"),l.totaler=l.c.find(".total .tttlforerror"),l.addresses=l.c.find(".addresses"),l.send=l.c.find(".send"),l.deposit=l.c.find(".deposit"),l.crowdfunding=l.c.find(".crowdfunding"),b.iclbks.main=function(){b.app.errors.connection()?l.totaler.addClass("active"):l.totaler.removeClass("active")},e&&e()})},stepC:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},stepB:function(e,a){e.find("._stepback").html('<div class="backWrapper"><div class="back"><i class="fas fa-arrow-left"></i></div></div>'),e.find("._stepclose").html('<div class="closeAdditional"><span><i class="fas fa-undo"></i> '+b.app.localization.e("wreturntoeallet")+"</span></div>"),e.find("._subcaptionlevel span").html(a||"")},step:function(a,e,t){t=t||{},u==e?a&&a(l.c.find(".step")):(d[u=e]=a,p[e]=t,h.clearMain(function(){_scrollToTop(l.step,0,200,-70),setTimeout(function(){b.shell({name:"step",el:l.step,data:{},animation:"fadeIn"},function(e){e=e.el.find(".step");t.class&&e.addClass(t.class),t.view?e.attr("view",t.view):e.removeAttr("view"),a&&a(e)})},200)}))},showListcount:function(e,a){var t=b.app.platform.sdk.exchanges.get();b.shell({name:"listcr",el:a,data:{list:t,c:i}},function(n){function s(e,a){b.app.platform.sdk.exchanges.remove(e.currency,e.info.address),a.remove(),(t=b.app.platform.sdk.exchanges.get()).length||h.step(d[u-1],u-1,p[u-1])}n.el.find(".removecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),n=b.app.platform.sdk.exchanges.find(e);b.app.platform.sdk.exchanges.status(n.currency,n.info.address,function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0006)"):"AWAITINGFUNDS"==a.Status||"EXPIREDAWAITINGFUNDS"==a.Status?s(n,t):dialog({html:b.app.localization.e("e13221"),success:function(){s(n,t)}})})}),n.el.find(".updatecr").on("click",function(){var t=$(this).closest(".item"),e=t.attr("item"),n=b.app.platform.sdk.exchanges.find(e);n?b.app.platform.sdk.exchanges.status({address:n.info.address,currency:n.currency},function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0002)"):h.crStatus(n,a,t.find(".status"))}):sitemessage(b.app.localization.e("errorreload")+" (error: 0001)")}),n.el.on("click",".todeal",function(){var e=$(this).closest(".item").attr("item"),e=b.app.platform.sdk.exchanges.find(e);m.showCrInStep("olddeal",u+1,"Deal",e)}),lazyEach({array:t,action:function(e){var a=e.item,t=n.el.find('[item="'+a.info.address+'"] .status'),e=b.app.platform.sdk.exchanges.info[a.info.address];h.crStatus(a,e,t)}})})},listcount:function(e){var a,t=b.app.platform.sdk.exchanges.get(),n=e.find(".listcountWrapper");0<t.length?(a="("+t.length+")",e.find(".listcount").html(a),n.fadeIn()):n.fadeOut()},crdealstatusstep:function(e,a,t){b.shell({name:"crdealstatusstep",el:t,data:{addressobject:e,info:a}},function(e){})},crDeal:function(n,s,e){b.shell({name:"crdeal",el:e,data:{addressobject:n}},function(t){h.crStatus(n,s,t.el.find(".status")),h.crdealstatusstep(n,s,t.el.find(".crdealstatusstep")),t.el.on("click",".copyaddress1",function(){copyText(t.el.find(".forcopyaddress1")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".copyaddress2",function(){copyText(t.el.find(".forcopyaddress2")),sitemessage(b.app.localization.e("waddresswascop"))}),t.el.on("click",".reactivate",function(){b.app.platform.sdk.exchanges.reactivate({address:n.info.address,currency:n.currency},function(e,a){e?sitemessage(b.app.localization.e("errorreload")+" (error: 0002)"):(s=a,h.crStatus(n,s,t.el.find(".status")),h.crdealstatusstep(n,s,t.el.find(".crdealstatusstep")))})})})},applyStatus:function(n,s){_.find(i.segments,function(e){var a=s.find('.segment[segment="'+e.id+'"]');if(e.id==n.Status){var t=100*Math.min((Number(e.time)-Number(n.MinutesLeft))/Number(e.time),.99);return a.find(".line").css("width",t+"%"),a.addClass("active"),e.class&&a.addClass(e.class),e.finish&&(a.addClass("ended"),a.find(".line").css("width","100%")),!e.finish&&"all"!=e.exclude||s.find(".current").html(e.currentLabel(n)),!0}a.addClass("ended"),a.find(".line").css("width","100%")})},crStatus:function(e,a,t,n){b.shell({name:"pocstatus",el:t,data:{addressobject:e,info:a,segments:i.segments}},function(e){h.applyStatus(a,t),n&&n()})},crowdRate:function(e,a,t){e.find(".rate .value").html("<b>1 PKOIN = "+a[t].toFixed(6)+" "+t.toUpperCase()+"</b>")},crowdCurrencyLabel:function(e,a){e.find(".currencyAmountLabel").html(a.toUpperCase()+" "+b.app.localization.e("amount")+"</b>")},crowdfunding:function(e,a){2==u&&(d[1]=function(e){m.showCrInStep("",1,"")},p[1]={class:"crowdfunding"}),i.parameters.currency||(i.parameters.currency.value="btc"),b.app.platform.sdk.exchanges.rates(function(n){b.app.platform.sdk.node.transactions.get.balance(function(t){t=Math.min(t/3,1e3),b.shell({name:"crowdfunding",el:a||l.crowdfunding,data:{d:i,amount:t}},function(a){ParametersLive(_.toArray(i.parameters),a.el),a.el.on("click",".closeAdditional",v),h.crowdRate(a.el,n,i.parameters.currency.value),h.crowdCurrencyLabel(a.el,i.parameters.currency.value),h.listcount(a.el),i.parameters.amount._onChange=function(e){i.parameters.amount.value<0&&(i.parameters.amount.value=0),i.parameters.amount.value>t&&(i.parameters.amount.value=t),i.parameters.currencyAmount.value=i.parameters.amount.value*n[i.parameters.currency.value],i.parameters.amount.el.closest(".inputWrapper").html(i.parameters.amount.input()),i.parameters.currencyAmount.el.closest(".inputWrapper").html(i.parameters.currencyAmount.input()),ParametersLive([i.parameters.amount,i.parameters.currencyAmount],a.el)},i.parameters.currency._onChange=function(e){b.app.platform.sdk.exchanges.rates(function(e){n=e,h.crowdRate(a.el,n,i.parameters.currency.value),h.crowdCurrencyLabel(a.el,i.parameters.currency.value)})},i.parameters.currencyAmount._onChange=function(e){i.parameters.currencyAmount.value<0&&(i.parameters.currencyAmount.value=0),i.parameters.currencyAmount.value/n[i.parameters.currency.value]>t&&(i.parameters.currencyAmount.value=Number((t*n[i.parameters.currency.value]).toFixed(6))),i.parameters.amount.value=i.parameters.currencyAmount.value/n[i.parameters.currency.value],i.parameters.amount.el.closest(".inputWrapper").html(i.parameters.amount.input()),i.parameters.currencyAmount.el.closest(".inputWrapper").html(i.parameters.currencyAmount.input()),ParametersLive([i.parameters.amount,i.parameters.currencyAmount],a.el)},a.el.find(".listcountWrapper").on("click",function(){m.showCrInStep("showListcount",2,"List of deals")}),a.el.find(".newdeal").on("click",function(){0<i.parameters.amount.value?(m.showCrInStep("newdeal",2,"Deal"),a.el.find(".required").addClass("hidden")):a.el.find(".required").removeClass("hidden")}),e&&e(a.el)})},"PFF7PevK753eYTwWBScdEAbWQrgu36AdUA",!0,!0)})},qrResultForDeposit:function(e,a,t){b.shell({name:"depositqrresult",el:a,data:{address:e,d:s}},function(e){})},linkResultForDeposit:function(e,a,t){b.shell({name:"depositlinkresult",el:a,data:{address:e,d:s}},function(e){e.el.find(".copylink").on("click",function(){copyText(e.el.find(".linkInTextArea")),sitemessage(b.app.localization.e("waddresswascop"))})})},linkMakerForDeposit:function(e,a,t){b.shell({name:"depositlinkmaker",el:a,data:{address:e,d:s}},function(e){var a=e.el.find(".getlink"),t=[s.parameters.depositamount,s.parameters.message,s.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){m.linkValidation()?a.removeClass("disabled"):a.addClass("disabled")}}),m.linkValidation()&&a.removeClass("disabled"),a.on("click",function(){m.linkValidation()&&m.showDepositInStep("showLinkResult",3,b.app.localization.e("linkCreated"))})})},qrMakerForDeposit:function(e,a,t){b.shell({name:"depositqrmaker",el:a,data:{address:e,d:s}},function(e){var a=e.el.find(".getlink"),t=[s.parameters.depositamount,s.parameters.message,s.parameters.label];ParametersLive(t,e.el),_.each(t,function(e){e._onChange=function(){m.linkValidationQr()?a.removeClass("disabled"):a.addClass("disabled")}}),m.linkValidationQr()&&a.removeClass("disabled"),a.on("click",function(){m.linkValidationQr()&&m.showDepositInStep("showQrResult",3,b.app.localization.e("wqrcodecreated"))})})},addressForDeposit:function(e,a,t){b.shell({name:"depositaddress",el:a,data:{address:e,d:s}},function(e){e.el.find(".getlink").on("click",function(){m.showDepositInStep("showLinkMaker",2,b.app.localization.e("wlinkcreating"))}),e.el.find(".qrcode").on("click",function(){m.showDepositInStep("showQrMaker",2,b.app.localization.e("wqrcodecreating"))}),e.el.find(".copyaddress").on("click",function(){copyText(e.el.find(".adr")),sitemessage(b.app.localization.e("waddresswascop"))})})},deposit:function(e,a){b.shell({name:"deposit",el:a||l.deposit,data:{d:s}},function(a){ParametersLive([s.parameters.deposit],a.el),s.parameters.deposit._onChange=function(e){b.app.settings.set(b.map.uri,"deposit",e);e=s.parameters.deposit.labelByValue(e);a.el.find(".type").html(e),m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))},a.el.find(".recieveaddress").on("click",function(){m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))}),a.el.on("click",".closeAdditional",v),e&&e(a.el)})},sendFees:function(s,e,a){var r;m.validSend()&&(r=e.feerate||1e-6,m.prepareTransaction(r,function(e,a,t,n){b.shell({name:"sendfees",el:s,data:{fees:t,d:c}},function(e){ParametersLive([c.parameters.fees],e.el),c.parameters.fees._onChange=function(e){b.app.settings.set(b.map.uri,"feesMode",e)},e.el.find(".sendtransaction").on("click",function(){m.prepareTransaction(r,function(e,a,t,n){b.app.platform.sdk.wallet.txbase(e,_.clone(a),t,n,function(e,t,a){e?sitemessage(e):(a=b.app.platform.sdk.node.transactions.create.wallet(t,a),_.each(t,function(e){e.cantspend=!0}),b.app.platform.sdk.node.transactions.send(a,function(e,a){a?(b.app.platform.sdk.node.transactions.releaseCS(t),sitemessage(a)):(a=_.map(t,function(e){return e.txid}),b.app.platform.sdk.node.transactions.clearUnspents(a),u=0,h.mainWithClear(),sitemessage(b.app.localization.e("wssuccessfully")))}))})})})})}))},send:function(a,e){m.sendParameters(),b.shell({name:"send",el:e||l.send,data:{d:c}},function(t){ParametersLive(_.toArray(c.parameters),t.el);function n(){m.canChangeSend()?e.removeClass("hidden"):e.addClass("hidden")}var e=t.el.find(".change");c.parameters.amount._onChange=function(e){var a=m.sendAddresses();b.app.platform.sdk.node.transactions.get.balance(function(e){c.parameters.amount.value<0&&(c.parameters.amount.value=0),c.parameters.amount.value>e&&(c.parameters.amount.value=e),c.parameters.amount.el.closest(".inputWrapper").html(c.parameters.amount.input()),ParametersLive([c.parameters.amount],t.el),1==u&&m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},a,null,!0)},c.parameters.source._onChange=function(e){m.sendParameters(),c.parameters.reciever.el.closest(".inputWrapper").html(c.parameters.reciever.input()),c.parameters.amount.el.closest(".inputWrapper").html(c.parameters.amount.input()),ParametersLive([c.parameters.reciever,c.parameters.amount],t.el),n(),1==u&&m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))},c.parameters.reciever._onChange=function(e){if(n(),!m.canChangeSend()&&e){var a=!0;try{bitcoin.address.fromBase58Check(e)}catch(e){a=!1}a?(t.el.find(".notvalidaddress").html(""),e[0]):t.el.find(".notvalidaddress").html(b.app.localization.e("wsaddressnotv"))}else t.el.find(".notvalidaddress").html("")},e.on("click",function(){var e=m.canChangeSend();e&&(c.parameters.source.value=e,c.parameters.source._onChange(),c.parameters.source.el.closest(".inputWrapper").html(c.parameters.source.input()),ParametersLive([c.parameters.source],t.el))}),t.el.find(".calculateFee").on("click",function(){m.validSend()?(m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees")),t.el.find(".required").addClass("hidden")):t.el.find(".required").removeClass("hidden")}),n(),a&&a(t.el)})},addresses:function(n){var s=o.total.addresses(),r={};b.app.platform.sdk.node.transactions.get.unspents(function(t){b.app.platform.sdk.node.transactions.get.balance(function(e){_.each(t,function(e,a){r[a]=_.reduce(e,function(e,a){return e+Number(a.amount)},0)});var a=[o.pnetwallet,o.wallet],a=_.map(a,function(e){var a=_.map(e.addresses(),function(e){return{balance:r[e],address:e}});return{caption:e.caption,details:a,label:e.alabel}},s);b.shell({name:"addresses",el:l.addresses,data:{addressesGroup:a,total:e}},function(e){e.el.find(".addaddress").on("click",f),n&&n()})},s)},s)},updateTotal:function(e,a){h.datasets(e,r[e.id].data.datasets),r[e.id].update(),l.total.find('.totalItem[item="'+e.id+'"] .balanceWrapper').html(b.app.platform.mp.coinwithsmall(e.balance)),a&&a()},datasets:function(e,a){var t=[],n=_.map(e.move,function(e){return t.push(e.color),Number(e.summary||0)}),s=[],r=[],l=[],o=[],i="#F1F1F1";$("html").hasClass("stblack")&&(i="rgb(9, 20, 34)"),_.each(e.move,function(e){_.each(e.items,function(e){s.push(Number(e.value)),r.push(e.color),l.push(i),o.push(8)})});var c=[{data:n,backgroundColor:t,borderColor:[i,i],borderWidth:[8,8]},{data:s,backgroundColor:r,borderColor:l,borderWidth:o}];return _.each(a,function(e,a){e.data=c[a].data}),c},total:function(a,t){a.update?h.updateTotal(a,t):b.shell({name:"total",el:l.total,inner:append,data:{item:a}},function(e){e=e.el.find("#chart"+a.id)[0].getContext("2d");r[a.id]=new Chart(e,{type:"doughnut",data:{datasets:h.datasets(a)},options:{rotation:.5*Math.PI,cutoutPercentage:85}}),t&&t()})}},w=function(){},k=function(e){l.total.html(""),a(function(){lazyActions([h.send,h.deposit,h.addresses],e),b.app.platform.sdk.node.transactions.clbks.circles=function(){a(null,!0)},b.app.platform.sdk.node.transactions.clbks.walletaddresses=function(){h.addresses()}}),b.app.platform.sdk.node.transactions.get.allBalance(null,!0)};return{primary:e,getdata:function(e){var a={};a.p2pkh=b.app.platform.sdk.address.pnet(),s.parameters.deposit.value=b.app.settings.get(b.map.uri,"deposit")||s.parameters.deposit.defaultValue,c.parameters.source.value=b.app.settings.get(b.map.uri,"source")||c.parameters.source.defaultValue,c.parameters.reciever.value="",c.parameters.fees.value=b.app.settings.get(b.map.uri,"feesMode")||c.parameters.fees.defaultValue,s.active=!1,u=0,d=[],p=[],e(a)},destroy:function(){delete b.app.platform.sdk.node.transactions.clbks.circles,delete b.app.platform.sdk.node.transactions.clbks.walletaddresses,delete b.iclbks.main,l={}},init:function(a){var t,n,e,s;r={},w(),(l={}).c=a.el.find("#"+b.map.id),l.step=l.c.find(".actionstep"),l.main=l.c.find(".mainstep"),l.c.on("click","._stepclose",function(){u=0,h.mainWithClear()}),l.c.on("click","._stepback",function(){1<u?h.step(d[u-1],u-1,p[u-1]):(u=0,h.mainWithClear())}),isMobile()&&(t=l.c.find(".circularprogress"),(n=new CircularProgress({radius:30,strokeStyle:"#00A3F7",lineCap:"round",lineWidth:1,font:"100 14px 'Segoe UI',SegoeUI,'Helvetica Neue',Helvetica,Arial,sans-serif",fillStyle:"#00A3F7",text:{value:""},initial:{strokeStyle:"#fff",lineWidth:1}})).update(70),l.c.find(".circularprogressWrapper").html(n.el),e=$(window),s=new SwipeParallax({el:l.c.find(".ntf"),allowPageScroll:"vertical",directions:{down:{cancellable:!0,positionclbk:function(e){var a=Math.abs(e)/200;0<=e&&(n.options.text={value:""},n.update(100*a),t.height(220*a+"px"))},constraints:function(){if(0==e.scrollTop())return!0},restrict:!0,trueshold:200,clbk:function(){b.app.platform.sdk.notifications.getNotifications(),b.app.platform.sdk.node.transactions.get.allBalanceUpdate(function(){k(),s.renew()})}}}}).init()),h.main(function(){k(function(){var e=parameters();e.action&&("send"==e.action&&(c.parameters.amount.value=Number(e.amount.replace(/,/g,"")),c.parameters.reciever.value=e.address,c.parameters.amount._onChange(),m.showSendInStep("calculateFee",1,b.app.localization.e("wscalculatefees"))),"recieve"==e.action&&m.showDepositInStep("showDeposit",1,b.app.localization.e("wdoptions"))),a.clbk(null,a)})})}}}var b=new nModule,n={};return b.run=function(e){var a=b.addEssense(n,t,e);b.init(a,e)},b.stop=function(){_.each(n,function(e){e.destroy()})},b}();"undefined"!=typeof module?module.exports=wallet:(app.modules.wallet={},app.modules.wallet.module=wallet);
 /*_____*/ 
var discussions=function(){function i(s){var c,a,d,n,s=deep(s,"history"),i={},t={},o={},r=null,e=!1,u=null,l=null,f={preloader:function(s){c.c&&(s?c.c.addClass("loading"):c.c.removeClass("loading"))},inView:function(s,n,i){var t,o,e;_.toArray(a).length&&c.c&&(t=c.c.find(n||".discussion"),n="offset","fixedin"==r.view&&(n="position"),0<(n=inView(t,{inel:d,offset:0,mode:"part",f:n})).length&&(o={},n=_.map(n,function(s){s=$(s).attr("chat");return o[s]=!0,a[s]}),i&&(e=[],_.each(a,function(s,n){o[n]||e.push(s)}),i(e)),s&&s(n)))},chatp:function(s){a[s]&&(f.preloader(!0),retry(function(){if(t[s]||!i[s])return!0},function(){f.chat(a[s])}))},chat:function(n){l=!0,f.closeAll(function(){v.app.platform.sdk.chats.save();var s={open:!0,href:"chat",animation:!1,history:!0};"fixedin"==r.view?(s.history=!1,s.el=c.c.find(".chatWrapper"),s.essenseData={view:"fixedin",chat:n,destroyClbk:function(){u&&(l=!1,f.preloader(!0),c.c&&c.c.removeClass("forChat"),s.el.html(""),m.discussions(null,function(){u=null,f.preloader(!1),d.scrollTop(0),setTimeout(function(){f.openInView()},100)}))}},s.clbk=function(s,n){u=n,c.c.addClass("forChat"),f.preloader(!1)}):s.href="chat?chatid="+n.chat.id,v.nav.api.load(s)})},open:function(s,n){},remove:function(s){f.preloader(!0),f.close(s,function(){f.preloader(!1),v.app.platform.sdk.chats.remove(s),a=v.app.platform.sdk.discussions.fromChats(v.app.platform.sdk.chats.get("share"),r.author),c.c.find('.discussion[chat="'+s+'"]').remove(),m.empty()})},openInView:function(s){f.inView(function(s){_.map(s,function(s){return s.chat.id});_.each(s,function(s){f.open(s)})},".discussion:not(.dempty)",function(s){s=_.map(s,function(s){return s.chat.id});f.closeMany(s)})},close:function(s,n){o[s]?retry(function(){if(!o[s])return!0},n):(o[s]=!0,retry(function(){if(t[s])return!0},function(){v.app.platform.rtc.destroy(s),delete o[s],delete t[s],delete i[s],n()}))},closeMany:function(s,n){lazyEach({array:s,action:function(s){var n=s.item;i[n]?f.close(n,s.success):s.success()},all:{success:function(){n&&n()}}})},closeAll:function(s){var n=_.map(i,function(s,n){return n});lazyEach({array:n,action:function(s){var n=s.item;f.close(n,s.success)},all:{success:function(){i={},t={},o={},s&&s()}}})}},p={inViewScroll:function(){n=slowMade(function(){l||(p.inView(),f.openInView())},n,200)},inView:function(){e||f.inView(function(s){e=!0,v.app.platform.sdk.discussions.info(s,function(s){m.fdiscussions(s,function(){e=!1}),a=v.app.platform.sdk.discussions.fromChats(v.app.platform.sdk.chats.get("share"),r.author)})},".discussion.dempty")},chat:function(){var s=$(this).closest(".discussion").attr("chat");f.chatp(s)},remove:function(){var s=$(this).closest(".discussion").attr("chat");f.remove(s)}},m={empty:function(){_.toArray(a).length?c.c.removeClass("sempty"):c.c.addClass("sempty")},message:function(s,n){v.shell({name:"message",inner:html,el:c.list.find('[chat="'+n+'"] .lastMessage'),data:{message:s}},function(s){})},discussion:function(s,n){var i=c.list.find('[chat="'+s.chat.id+'"]');s.share&&s.author?v.shell({name:"discussion",inner:html,el:i,data:{discussion:s}},function(s){i.removeClass("dempty"),s.el.find(".discussioncnt").on("click",p.chat),s.el.find(".remove").on("click",p.remove),n&&n()}):(i.remove(),n&&n())},fdiscussions:function(s,n){lazyEach({array:_.toArray(s),action:function(s){var n=s.item;m.discussion(n,s.success)},all:{success:function(){f.openInView(),n&&n()}}})},discussions:function(s,n,i){s=s||a;s=_.toArray(s),s=_.sortBy(s,function(s){return-s.chat.time});v.shell({name:"discussions",inner:i||html,el:c.list,data:{discussions:s}},function(s){p.inView(),n&&n()})},discussionTemp:function(i,t,o){v.shell({name:"discussions",el:c.temp,data:{discussions:i}},function(s){var n=s.el.find(".discussion");v.app.platform.sdk.discussions.info(i,function(s){v.shell({name:"discussion",inner:html,el:n,data:{discussion:i[0],c:t}},function(s){n.removeClass("dempty"),n.on("click",function(){v.app.platform.sdk.chats.add(i[0].chat.id,"share")}),o&&o()})})})}},h=function(){};return{primary:s,getdata:function(s,n){r=n.settings.essenseData||{},e=!1;n=v.app.platform.sdk.address.pnet().address+"addedtochat";localStorage[n]=!0,v.app.platform.sdk.chats.add("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd","share");n={};a=v.app.platform.sdk.discussions.fromChats(v.app.platform.sdk.chats.get("share"),r.author),n.discussions=a,s(n)},destroy:function(){d&&d.off("scroll",p.inViewScroll),delete v.app.platform.sdk.chats.clbks.discussions,f.closeAll(),u&&(u.destroy(),u=null),c={}},init:function(s){i={},opened={},l=!(t={}),h(),(c={}).c=s.el.find("#"+v.map.id),d="fixedin"==r.view?c.c.find(".discussionsWrapper"):$(window),c.list=c.c.find(".list"),c.temp=c.c.find(".gotoDisscussion"),d.on("scroll",p.inViewScroll),v.app.platform.sdk.chats.clbks.discussions=function(s,n,i){if("removeTemp"==n)return c.temp.html(""),void c.temp.fadeOut(1);var t=_.toArray(v.app.platform.sdk.discussions.fromChats([s]));"add"==n&&(a=v.app.platform.sdk.discussions.fromChats(v.app.platform.sdk.chats.get("share"),r.author),m.empty(),m.discussions(t,function(){f.chatp(t[0].chat.id)},prepend)),"addTemp"==n&&m.discussionTemp(t,i,function(){}),"addtwice"==n&&(m.discussions(),f.chatp(t[0].chat.id))},f.chatp("6768de97ad495c0110a9e09d43825ef24f1055449a5d368225ac102804397dc1_PEj7QNjKdDPqE9kMDRboKoCtp8V6vZeZPd"),s.clbk(null,s)}}}var v=new nModule,t={};return v.run=function(s){var n=v.addEssense(t,i,s);v.init(n,s)},v.stop=function(){_.each(t,function(s){s.destroy()})},v}();"undefined"!=typeof module?module.exports=discussions:(app.modules.discussions={},app.modules.discussions.module=discussions);
 /*_____*/ 
var s=function(){function t(s){var n,a,u,r,i,s=deep(s,"history"),e=0,t=10,o="list",l={clickNext:function(){f("users",e+=t,30),l.displayArrows()},clickArrow:function(s){"left"==s&&(e-=t)<0&&(e=0),"right"==s&&((e+=t)>=u.users.count&&(e=u.users.count-1),f("users",e,t)),l.slideCarousel()},displayArrows:function(){0<e?l.displayArrow("left",!0):l.displayArrow("left",!1),e+t<u.users.count?(l.displayArrow("right",!0),l.displayNext(!0)):(l.displayArrow("right",!1),l.displayNext(!1))},displayNext:function(s){s?n.unext.addClass("active"):n.unext.removeClass("active")},displayArrow:function(s,e){var t=n.ea;s&&(t=n["u"+s]),e?t.addClass("active"):t.removeClass("active")},slideCarousel:function(){var s=n.c.find(".user").width(),s=e*s;n.userslist.css("margin-left","-"+s+"px"),l.displayArrows()},applyCarousel:function(){var s,e;"list"==o?(s=n.c.find(".user").width(),e=n.c.find(".userslistwrapper").width(),t=Math.min(Number((e/s).toFixed(0)),10),n.c.find(".user").width((e/t).toFixed(0)+"px"),n.userslist.width((u.users.data.length*(e/t)).toFixed(0)+1),l.slideCarousel()):(n.userslist.css("margin-left","0px"),n.userslist.css("width","auto"),n.c.find(".user").css("width","auto"))},changeUsersView:function(){"list"==o?o="full":(o="list",e=0),n.users.attr("view",o),l.applyCarousel()}},c=function(){var s=$(this).attr("arrow");l.clickArrow(s)},d=function(){l.clickNext()},p={users:function(s,e){w.shell({name:"userslist",el:n.users.find(".userslist"),data:{users:s},inner:append,bgImages:{clbk:function(s){$(s.elements[0]).addClass("active")}}},function(s){"list"==o&&l.applyCarousel(),e&&e(s)})},posts:function(){var s=!1;w.nav.api.load({open:!0,id:"lenta",el:n.lenta,animation:!1,mid:"search",essenseData:{search:!0,hr:"index?",searchValue:a,loader:function(e){function t(s){s=w.app.platform.sdk.node.shares.transform(s),e&&e(s,null,{count:10})}s?f("posts",u.posts.data.length,10,function(s){t(s)}):(s=!0,t(u.posts.data))}},clbk:function(s,e){i=e}})}},f=function(e,s,t,n){var a,r=u[e].data.length,i=u[e].count;s+t<=r||(s<r&&(a=r-s,s=r,t-=a),(t=i<s+t?i-s:t)<=0||h[e](function(s){n?n(s):p[e](s)},s,t))},h={users:function(e,s,t){w.app.platform.sdk.search.get(a,"users",s,t,r,function(s){e(s.data)})},posts:function(e,s,t){w.app.platform.sdk.search.get(a,"posts",s,t,r,function(s){e(s.data)})}},m=function(){};return{primary:s,getdata:function(t){var n={};i=null,a=(parameters().ss||"").replace("tag:","#");var s=deep(w,"app.modules.menu.module.showsearch");s&&s(a),w.app.platform.sdk.search.clear(),w.app.platform.sdk.search.get(a,"all",0,10,null,function(s,e){r=e,u=s,n.result=s,n.value=a,t(n)})},destroy:function(s){s==w.app.nav.current.href||(s=deep(w,"app.modules.menu.module.closesearch"))&&s(),i&&i.destroy(),i=null,n={}},init:function(s){e=0,t=10,m(),(n={}).c=s.el.find("#"+w.map.id),n.users=n.c.find(".users"),n.userslist=n.c.find(".userslist"),n.posts=n.c.find(".posts"),n.uleft=n.c.find(".uleft"),n.uright=n.c.find(".uright"),n.ua=n.c.find(".arrow"),n.showmore=n.c.find(".showmore"),n.unext=n.c.find(".nextpage"),n.lenta=n.c.find(".lentasearch"),n.ua.on("click",c),n.showmore.on("click",l.changeUsersView),n.userslist.swipe({swipe:function(s,e,t,n,a,r){}}),n.unext.on("click",d),deep(u,"users.data.length")&&p.users(u.users.data),deep(u,"posts.data.length")&&p.posts(),s.clbk(null,s)}}}var w=new nModule,n={};return w.run=function(s){var e=w.addEssense(n,t,s);w.init(e,s)},w.stop=function(e){_.each(n,function(s){s.destroy(e)})},w}();"undefined"!=typeof module?module.exports=s:(app.modules.s={},app.modules.s.module=s);
 /*_____*/ 
var imageGalleryEdit=function(){function a(e){var a,n,e=deep(e,"history"),t=null,r=0,l=!1,d=null,o=null,s=null,c={normal:{name:"Normal"},vintage:{name:"Vintage"},oldBoot:{name:"Old Boot"},clarity:{name:"Clarity"},sunrise:{name:"Sunrise"},crossProcess:{name:"Cross Process"},orangePeel:{name:"Orange Peel"},love:{name:"Love"},jarques:{name:"Jarques"},pinhole:{name:"Pinhole"}},f={},p={back:function(){--r<0&&(r=n.images.length-1),v()},next:function(){++r>=n.images.length&&(r=0),v()},initialValue:function(){n.initialValue&&(r=n.initialValue)},filters:function(){return(l=!l)?(a.c.addClass("filters"),g.filters()):a.c.removeClass("filters"),u.resize(),l},caman:function(e,i){var a=i?i:"#galleryImage";o&&!i?e&&e(o):Caman(a,function(){i||(o=this),e&&e(this)})},crop:function(){return d?(d.destroy(),d=null,!1):(p.caman(function(){var e=a.imagesWrapper.find("#galleryImage"),i=e.parent();t=o,n.crop||(n.crop={}),d=new Cropper(e[0],{aspectRatio:n.crop.aspectRatio||null,autoCropArea:n.crop.autoCropArea||.9,checkOrientation:!1,crop:function(e){var i=o.width,a=o.height,a={x:e.detail.x/i,y:e.detail.y/a,w:e.detail.width/i,h:e.detail.height/a};f.crop=a},ready:function(){i.find(".cropper-container").addClass(n.crop.style||""),i.find(".cropper-crop-box").append('<div class="applyCrop center" action="apply">\t\t\t\t\t\t\t\t\t<span class="fa fa-check" aria-hidden="true"></span>\t\t\t\t\t\t\t\t</div>'),i.find(".applyCrop").on("click",function(){p.apply("crop"),g.savePanel()})}})}),!0)},camanFilter:function(e,i,a){e.revert(!1),"normal"!=i&&e.newLayer(function(){this.opacity(50),this.copyParent(),this.filter[i]()}),e.render(a)},previewFilter:function(e,i){var a=e.attr("filter"),n=e.attr("imageId");Caman("#"+n,function(){p.camanFilter(this,a,function(){e.animate({opacity:1})})}),e.on("click",function(){p.caman(function(){p.camanFilter(o,a,function(){t=o,f.filter=a,g.savePanel(),u.resize()})})})},applyFilters:function(t,e,r,l){"crop"!=e?"filter"==e&&p.caman(function(e){p.camanFilter(e,t,function(){l&&l()})},r):p.caman(function(e){var i=e.canvas.width,a=e.canvas.height,n={x:t.x*i,y:t.y*a,width:t.w*i,height:t.h*a};e.crop(n.width,n.height,n.x,n.y),e.resize({width:n.width,height:n.height}),e.render(function(){e.resetOriginalPixelData(),e.cropped=!1,e.cropCoordinates={x:0,y:0},e.originalHeight=n.height,e.originalWidth=n.width,e.preScaledHeight=n.height,e.preScaledWidth=n.width,e.resized=!1,r||u.resize(),l&&l()})},r)},apply:function(e,i){e&&f[e]&&(p.applyFilters(f[e],e,i),p[e](),a.c.find('[action="'+e+'"]').removeClass("active"))},close:function(){n.success?(topPreloader(20),n.success(n.images,function(){topPreloader(100),w.closeContainer()})):w.closeContainer()},exit:function(){n.apply&&(p.apply("crop"),p.save(!0)),p.close()},cancel:function(){f={},g.savePanel(),g.image({image:s})},save:function(e){p.checkUpdates()&&(s.original=o.toBase64(),f={},e||(g.savePanel(),g.image({image:s})))},checkUpdates:function(){return!!(f.filter&&"normal"!=f.filter||f.crop)}},u={resize:function(){u.bestFit(a.imagesWrapper.find(".image"),t)},bestFit:function(e,i){var a=e.closest(".imagesAbsWrapper"),n=e.find(".imgWrapper"),t=i.naturalWidth||i.width,r=i.naturalHeight||i.height,l=r/t;e.css("padding-top","0px");var o=e.width(),s=e.height(),c=a.width(),a=a.height();(s=a<s?a:s)<=(r=(o=c<o?c:o)<t?(t=o)*l:r)&&(t=(r=s)/l);s=(s-r)/2;e.css("padding-top",s+"px"),i.canvas?(i.resize({width:t,height:r}),i.render()):(i.width=t,i.height=r,$(i).attr("data-camanwidth",t),$(i).attr("data-camanheight",r),$(i).css("opacity","1")),n.width(t),n.height(r),d&&d.resize({width:t,height:r})},nFormat:function(e){return e=e<10?"0"+e:e}},i=function(){var e=$(this).attr("action");p[e]()},m=function(){var e=$(this).attr("action"),i=$(this);p[e]()?i.addClass("active"):i.removeClass("active")},g={savePanel:function(){(f.filter&&"normal"!=f.filter||f.crop)&&!n.apply?a.exitPanel.fadeOut(200,function(){a.savePanel.fadeIn(200)}):a.savePanel.fadeOut(200,function(){a.exitPanel.fadeIn(200)})},image:function(i){o=t=null,f={},g.savePanel(),d&&(d.destroy(),d=null,a.editPanel.find('.eitem[action="crop"]').removeClass("active")),a.imageNavigation.find(".number").html(u.nFormat(Number(r)+1)),$(window).off("resize",u.resize),i=i||{},w.shell({name:"image",el:a.images,inner:html,display:"table",animation:!1,data:{data:n,image:i.image}},function(e){e.el.find("img").imagesLoaded(function(e){t=deep(e,"images.0.img"),s=i.image,u.resize(),$(window).on("resize",u.resize),l&&(l=!l,p.filters()),i.clbk&&i.clbk()})})},filters:function(i){(i=i||{}).image||(i.image=n.images[r]),a.filters.html(""),resizeFit(i.image.original,80,80,function(e){w.shell({name:"filters",el:a.filters,data:{data:n,image:e,filters:c}},function(e){e.el.find(".preview").each(function(){p.previewFilter($(this),i.image)});var r=e.el.find(".filtersSwipe");swipedetect(r[0],function(e,i,a,n){var t=Number(r.css("margin-left").replace("px",""))+Number(1.7*i),i=-r.find(".filtersList").width()+r.closest(".filtersWrapperOvf").width();(t=0<t?0:t)<i&&(t=i),r.css("margin-left",t+"px")})})})}},h=function(){},v=function(){g.image({image:n.images[r],clbk:function(){n.apply&&(p.filters(),p.crop())}})},y=function(e){n.edit?w.nav.api.loadRelations({relations:[{src:"js/vendor/caman.full.min.js",f:"js",require:function(){Caman=require("../../js/vendor/caman.full.min.js").Caman}},{src:"js/vendor/cropper.js",f:"js",require:function(){Cropper=require("../../js/vendor/cropper.js")}},{src:"css/cropper.min.css",f:"css"}]},e):e&&e()};return{primary:e,getdata:function(e){e({})},destroy:function(){$(window).off("resize",u.resize),a={}},init:function(e){s=t=o=null,l=!1,f={},n=e.essenseData||{},h(),p.initialValue(),(a={}).c=e.el.find("#"+w.map.id),a.imagesWrapper=e.el.find(".imagesWrapper"),a.images=e.el.find(".images"),a.imageNavigation=e.el.find(".imageNavigation"),a.arrows=a.imageNavigation.find(".arrow"),a.editPanel=a.c.find(".editPanel"),a.savePanel=a.c.find(".panel .savePanel"),a.exitPanel=a.c.find(".panel .exitPanel"),a.filters=a.c.find(".filters"),y(function(){v(),a.arrows.on("click",i),a.editPanel.find(".eitem").on("click",m),a.savePanel.find(".sitem").on("click",m),a.exitPanel.find(".sitem").on("click",m),e.clbk(null,e)})},wnd:{close:function(){n.close&&n.close()},class:"allscreen black withoutButtons imageGalleryEdit"}}}var w=new nModule,n={};return w.run=function(e){var i=w.addEssense(n,a,e);w.init(i,e)},w.stop=function(){_.each(n,function(e){e.destroy()})},w}();"undefined"!=typeof module?module.exports=imageGalleryEdit:(app.modules.imageGalleryEdit={},app.modules.imageGalleryEdit.module=imageGalleryEdit);
 /*_____*/ 
var complain=function(){function i(e){var t,i,a,o,s,e=deep(e,"history"),r={post:[{name:"Sexual content",gid:1,group:[{name:"Graphic sexual activity",id:"1"},{name:"Nudity",id:"2"},{name:"Suggestive, but without nudity",id:"3"},{name:"Content involving minors",id:"4"},{name:"Abusive title or description",id:"5"},{name:"Other sexual content",id:"6"}]},{name:"Violent or repulsive content",gid:2,group:[{name:"Adults fighting",id:"7"},{name:"Physical attack",id:"8"},{name:"Youth violence",id:"9"},{name:"Animal abuse",id:"10"}]},{name:"Hateful or abusive content",gid:3,group:[{name:"Promotes hatred or violence",id:"11"},{name:"Abusing vulnerable individuals",id:"12"},{name:"Bullying",id:"13"},{name:"Abusive title or description",id:"14"}]},{name:"Harmful dangerous acts",gid:4,group:[{name:"Pharmaceutical or drug abuse",id:"19"},{name:"Abuse of fire or explosives",id:"20"},{name:"Suicide or self injury",id:"21"},{name:"Other dangerous acts",id:"22"}]},{name:"Child abuse",id:"23"},{name:"Promotes terrorism",id:"24"},{name:"Spam or misleading",gid:6,group:[{name:"Mass advertising",id:"25"},{name:"Pharmaceutical drugs for sale",id:"26"},{name:"Misleading text",id:"27"},{name:"Misleading thumbnail",id:"28"},{name:"Scams / fraud",id:"29"}]},{name:"Infringes my rights",gid:7,group:[{name:"Infringes my copyright",id:"30"},{name:"Invades my privacy",id:"31"},{name:"Other legal claim",id:"32"}]}]},n=function(n){return _.find(r[i],function(e){return(e.gid||e.id)==n})},d=function(i){var e=a.complain(o);topPreloader(30),g.sdk.node.transactions.create.commonFromUnspent(e,function(e,n){topPreloader(100),e?i&&i(!0):(g.app.platform.errorHandler(n,!0),i&&i())})},l=function(){o?t.next.removeClass("disabled"):t.next.addClass("disabled")},u=function(){g.closeContainer()},c=function(){!t.next.hasClass("disabled")&&o&&d(function(e){e&&(g.closeContainer(),s.success&&s.success())})},m=function(){var e=$(this).attr("reason"),e=n(e);e&&($(this).hasClass("active")||(t.c.find(".reason").removeClass("active"),o=null,$(this).addClass("active"),e.group?p.selector(e):o=e.id,l()))},p={reasons:function(){g.shell({name:"reasons",inner:html,el:t.reasons,data:{reasons:r[i]}},function(e){e.el.find(".reason").on("click",m)})},selector:function(e){var n=t.c.find('.reason[reason="'+e.gid+'"] .reasongroupIn'),i=_.map(e.group,function(e){return e.name}),a=_.map(e.group,function(e){return e.id}),s=new Parameter({type:"VALUES",name:e.name,id:e.gid,possibleValues:a,possibleValuesLabels:i,placeholder:"Choose one"});s._onChange=function(e){o=e||null,l()},g.shell({name:"selector",inner:html,el:n,data:{selector:s}},function(e){ParametersLive([s],e.el)})}},f=function(){};return{primary:e,getdata:function(e,n){o=null,i=deep(n,"settings.essenseData.item")||"post",a=deep(n,"settings.essenseData.obj")||null,s=n.settings.essenseData||{},a&&e({ess:i})},destroy:function(){t={}},init:function(e){f(),(t={}).c=e.el.find("#"+g.map.id),t.reasons=t.c.find(".reasons"),t.next=t.c.find(".next"),t.c.find(".cancel").on("click",u),t.next.on("click",c),p.reasons(),e.clbk(null,e)},wnd:{class:"withoutButtons transparent small complain"}}}var g=new nModule,a={};return g.run=function(e){var n=g.addEssense(a,i,e);g.init(n,e)},g.stop=function(){_.each(a,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=complain:(app.modules.complain={},app.modules.complain.module=complain);
 /*_____*/ 
var imagegallery=function(){function i(e){var n,t,a,e=deep(e,"history"),i=null,r=0,o={back:function(){1<t.images.length&&(o.prepareImages(),--r<0&&(r=t.images.length-1),u())},next:function(){1<t.images.length&&(o.prepareImages(),++r>=t.images.length&&(r=0),u())},initialValue:function(){o.prepareImages(),t.initialValue&&(r=findIndex(t.images,function(e){var a="name";if(e[a=t.idName?t.idName:a]==t.initialValue)return!0}))},prepareImages:function(){t.getImages&&(t.images=t.getImages())},prepareImage:function(e,a){t.getImage?t.getImage(e,function(e){a&&a(e)}):a&&a(e)}},s={resize:function(){s.bestFit(n.imagesWrapper.find(".image"),i)},bestFit:function(e,a){var i=e.closest(".imagesAbsWrapper"),n=e.find(".imgWrapper"),t=a.naturalWidth||a.width,r=a.naturalHeight||a.height,o=r/t;e.css("padding-top","0px");var s=e.width(),l=e.height(),c=i.width(),i=i.height();(l=i<l?i:l)<=(r=(s=c<s?c:s)<t?(t=s)*o:r)&&(t=(r=l)/o);l=(l-r)/2;e.css("padding-top",l+"px"),a.width=t,a.height=r,$(a).attr("data-camanwidth",t),$(a).attr("data-camanheight",r),$(a).animate({opacity:1}),n.width(t),n.height(r)},nFormat:function(e){return e=e<10?"0"+e:e}},l=function(){if(!a){var e=$(this).attr("action");return o[e](),!1}},c=function(e){a||e.pageY<80||(action="next",e.pageX<$(window).width()/2&&(action="back"),o[action]())},g=function(e){n.imageNavigation.find(".number").html(s.nFormat(r+1)),$(window).off("resize",s.resize),e=e||{},d.shell({name:"image",el:n.images,inner:html,display:"table",data:{data:t,image:e.image}},function(e){e.el.find("img").imagesLoaded(function(e){n.c.removeClass("loading"),a=!1,(i=deep(e,"images.0.img"))&&(s.resize(),$(window).on("resize",s.resize))})})},m=function(){},u=function(){n.c.addClass("loading"),a=!0;var e=t.images[r];d.app.nav.api.history.addParameters({num:r.toString()}),o.prepareImage(e,function(e){g({image:e})})};return{primary:e,parametersHandler:function(){var e=parameters().num;void 0!==e&&(r=Number(e),o.prepareImages(),u())},getdata:function(e){e({})},destroy:function(){i=null,$(window).off("resize",s.resize),a=!1,n={}},clearparameters:["i","num","s","com"],init:function(e){i=null,a=!1,t=e.essenseData||{},m(),o.initialValue(),(n={}).c=e.el.find("#"+d.map.id),n.imagesWrapper=e.el.find(".imagesWrapper"),n.images=e.el.find(".images"),n.imageNavigation=e.el.find(".imageNavigation"),n.arrows=n.imageNavigation.find(".arrow"),u(),function(){n.arrows.on("click",l),n.c.on("click",c);var a=n.c.find(".imagesTableWrapper").closest(".wnd"),e={up:{trueshold:150,mintrueshold:50,cancellable:!0,positionclbk:function(e){e=(150-Math.abs(e))/150;0<e&&a.css("opacity",e)},clbk:function(){d.closeContainer()}}};1<t.images.length&&(e.left={trueshold:100,mintrueshold:50,cancellable:!0,restrict:!0,positionclbk:function(e){Math.abs(e)},clbk:function(){o.next(),setTimeout(i.renew,200)}},e.right={trueshold:100,mintrueshold:50,cancellable:!0,restrict:!0,positionclbk:function(e){Math.abs(e)},clbk:function(){o.back(),setTimeout(i.renew,200)}});var i=new SwipeParallax({el:n.c.find(".imagesTableWrapper"),directions:e}).init()}(),e.clbk(null,e)},wnd:{class:"allscreen black withoutButtons imageGallery"}}}var d=new nModule,n={};return d.run=function(e){var a=d.addEssense(n,i,e);d.init(a,e)},d.stop=function(){_.each(n,function(e){e.destroy()})},d}();"undefined"!=typeof module?module.exports=imagegallery:(app.modules.imagegallery={},app.modules.imagegallery.module=imagegallery);
 /*_____*/ 
var main=function(){function a(n){function e(n,e){localStorage.lentakey=parameters().r||"index",v.lenta(n,e),h(),k.app.user.isState(function(n){isMobile()||v.panel(),v.addpanel()}),v.smallpanel()}var t,a,o=deep(n,"history"),i=null,l=null,r=null,s=null,d=null,c="common",u=!1,p={addbutton:function(){k.nav.api.load({open:!0,id:"share",inWnd:!0,eid:"postin",clbk:function(n,e){},essenseData:{close:function(){r.make()},post:function(){r.make()},hello:!0,absolute:!0}})},addbuttonscroll:function(){400<$(window).scrollTop()?t.addbutton.addClass("scrollactive"):t.addbutton.removeClass("scrollactive")},panelTopPosition:function(){},panelPosition:function(){},currentMode:function(){"recommended"==c?k.nav.api.history.addParameters({r:"recommended"}):"sub"==c?k.nav.api.history.addParameters({r:"sub"}):k.nav.api.history.removeParameters(["r"]),v.lenta(),h(),v.smallpanel()}},m=function(){c=$(this).attr("lenta"),p.currentMode()},f=function(){p.panelPosition()},v={addpanel:function(){k.app.user.isState(function(n){n&&(n&&!isMobile()?t.addbutton.addClass("active"):t.addbutton.removeClass("active"))})},smallpanel:function(){t.smallpanel.find(".item").removeClass("active"),t.smallpanel.find('.item[lenta="'+c+'"]').addClass("active")},share:function(){isMobile()||k.nav.api.load({open:!0,id:"share",el:t.share,animation:!1,clbk:function(n,e){r=e,u&&t.panel.hcSticky("refresh")},essenseData:{post:function(){d}}})},panel:function(){k.nav.api.load({open:!0,id:"panel",el:t.panel,animation:!1,clbk:function(n,e){a=e,p.panelPosition(),window.addEventListener("resize",f),window.addEventListener("scroll",p.panelTopPosition),t.panel.hcSticky({stickTo:"#main",top:76,bottom:177})}})},lenta:function(a,e){e=e||{},v.addpanel(),k.app.user.isState(function(n){k.nav.api.load({open:!0,id:"lenta",el:t.lenta,animation:!1,mid:"main",essenseData:{hr:"index?",goback:e.goback,r:null,renderclbk:function(){u&&t.panel.hcSticky("refresh")}},clbk:function(n,e){s=s||k.app.platform.api.upbutton(t.up,{top:function(){return"65px"},rightEl:t.c.find(".lentacell")}),l=e,a&&a()}})})}},b=function(){},h=function(){k.app.user.isState(function(n){n&&(isMobile()||("common"==c?(v.share(),t.c.find(".bgCaption").removeClass("hidden")):(t.share.html(""),t.c.find(".bgCaption").addClass("hidden"))))})};return{primary:o,parametersHandler:function(n){var e=c;localStorage.lentakey=parameters().r||"index",e=parameters().r?parameters().r:"common",c!=e&&(c=e,l&&l.destroy(),v.lenta()),h(),n&&n()},authclbk:function(){void 0!==t&&t.c&&(t.c.find(".bgCaption").removeClass("hidden"),h(),u&&t.panel.hcSticky("refresh"))},getdata:function(n,e){u=!1;var a=parameters();c=a.r||"common",beginmaterial=a.s||a.i||a.v||null,e.state&&o&&!k.app.user.validate()?k.nav.api.load({open:!0,href:"userpage?id=test",history:!0}):n({})},destroy:function(){s&&s.destroy(),s=null,window.removeEventListener("scroll",p.panelTopPosition),window.removeEventListener("resize",f),window.removeEventListener("scroll",p.addbuttonscroll),i&&i.destroy(),l&&l.destroy(),r&&r.destroy(),a&&a.destroy(),l=i=a=null},init:function(n){l=i=null,b(),(t={}).c=n.el.find("#"+k.map.id),t.share=t.c.find(".share"),t.lenta=t.c.find(".lentaWrapper"),t.panel=t.c.find(".panel"),t.up=t.c.find(".upbuttonwrapper"),t.smallpanel=t.c.find(".smallpanell"),t.addbutton=t.c.find(".addbutton"),t.w=$(window),window.addEventListener("scroll",p.addbuttonscroll),t.smallpanel.find(".item").on("click",m),t.addbutton.on("click",p.addbutton),e(function(){n.clbk(null,n)},n)}}}var k=new nModule,t={};return k.run=function(n){var e=k.addEssense(t,a,n);k.init(e,n)},k.stop=function(){var e=null;return _.each(t,function(n){n=n.destroy();n&&(e=n)}),e},k.authclbk=function(){_.each(t,function(n){n.authclbk()})},k}();"undefined"!=typeof module?module.exports=main:(app.modules.main={},app.modules.main.module=main);
 /*_____*/ 
var addaccount=function(){function o(n){var o,e,t=deep(n,"history"),i=t?"primary":"secondary";n.inWnd&&(i="window");var a=function(){var n=trim(o.login.val());e.success&&e.success(n),c.closeContainer()};return{primary:t,id:i,getdata:function(n,e){n({})},destroy:function(){o={}},init:function(n){(o={}).c=n.el.find("#"+c.map.id),o.login=o.c.find(".loginValue"),o.enter=o.c.find(".enter"),e=n.essenseData||{},o.enter.on("click",a),o.login.on("focus",function(){o.c.find(".inputTable").addClass("typeactive")}),o.login.on("blur",function(){o.c.find(".inputTable").removeClass("typeactive")}),initUpload({el:o.c.find(".uploadFile"),notexif:!0,ext:["txt","png","jpeg","jpg"],dropZone:o.c,action:function(n,e){"png"==n.ext||"jpeg"==n.ext||"jpg"==n.ext?grayscaleImage(n.base64,function(n){qrscanner.q.callback=function(n){"error decoding QR Code"==n?sitemessage(c.app.localization.e("filedamaged")):(o.login.val(trim(n)),a())},qrscanner.q.decode(n)}):(n=n.base64.split(",")[1],(n=b64_to_utf8(n).split("/"))[1]?(o.login.val(trim(n[1])),a()):sitemessage(c.app.localization.e("filedamaged")))}}),n.clbk(null,n)},tooltip:{options:{position:"left",functionPosition:function(n,e,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen"}}}var c=new nModule,t={};return c.run=function(n){var e=c.addEssense(t,o,n);c.init(e,n)},c.stop=function(){_.each(t,function(n){n.destroy()})},c}();"undefined"!=typeof module?module.exports=addaccount:(app.modules.addaccount={},app.modules.addaccount.module=addaccount);
 /*_____*/ 
var authorization=function(){function o(e){var a,i,t,o=deep(e,"history"),n="secondary",s=null;o&&(n="primary"),e.inWnd&&(n="window");var r=new Parameter({type:"BOOLEAN",name:"stay",id:"stay",name:u.app.localization.e("e13027"),_onChange:function(e){e||(localStorage.stay="0",localStorage.mnemonic,u.app.user.stay=0)}}),l={login:function(){var n={},e=trim(a.login.val());localStorage.stay=boolToNumber(r.value).toString(),u.user.stay=r.value,u.user.signin(e,function(e){e?(u.app.platform.sdk.registrations.remove(),(e={}).href=i.successHref,!e.href&&o&&(e.href=function(){return u.app.user.validate()?"index":u.app.errors.connection()?"userpage?id=test":"filluser"}),e.nav=i.nav,e.clbk=function(){topPreloader(100);var e=deep(t,"container.close");e&&e(),i.signInClbk&&i.signInClbk()},"_this"==deep(i,"successHref")?u.app.reloadModules(function(){var e;u.app.user.validate()?((e=deep(t,"container.close"))&&e(),i.signInClbk&&i.signInClbk()):u.nav.api.loadSameThis("filluser",n)}):u.app.reload(e)):sitemessage(u.app.localization.e("e13028"))})}},c=function(){u.nav.api.load({open:!0,id:"filluserfast",el:a.c.find(".filluserform"),essenseData:{inauth:!0,successHref:i.successHref,welcomepart:function(){a.c.addClass("welcomepnet")},signInClbk:function(){var e=deep(t,"container.close");e&&e(),i.signInClbk()}},clbk:function(e,n){s=n}})};return{primary:o,id:n,getdata:function(e,n){n.state&&o?u.nav.api.load({open:!0,href:"index",history:!0}):(r.value=numberToBool(u.app.user.stay),localStorage.mnemonic,e({stay:r,mnemonic:"",fast:deep(n,"settings.essenseData.fast")||!1}))},destroy:function(){a={},s&&(s.destroy(),s=null)},init:function(e){var n,o;(a={}).c=e.el.find("#"+u.map.id),a.login=a.c.find(".loginValue"),a.pwd=a.c.find(".pwdValue"),a.enter=a.c.find(".enter"),a.toRegistration=a.c.find(".toRegistration"),a.forgotPassword=a.c.find(".forgotPassword"),i=e.essenseData||{},n=t=e,a.enter.on("click",l.login),a.toRegistration.on("click",function(){u.nav.api.loadSameThis("registration",n)}),a.c.find(".showformh").on("click",function(){a.c.toggleClass("signinshow")}),initUpload({el:a.c.find(".uploadFile"),ext:["txt","png","jpeg","jpg"],notexif:!0,dropZone:a.c,action:function(e,n){"png"==e.ext||"jpeg"==e.ext||"jpg"==e.ext?grayscaleImage(e.base64,function(e){qrscanner.q.debug=!0,qrscanner.q.callback=function(e){"error decoding QR Code"==e?sitemessage(u.app.localization.e("filedamaged")):(a.login.val(trim(e)),l.login())},qrscanner.q.decode(e)}):(e=e.base64.split(",")[1],(e=b64_to_utf8(e).split("/"))[1]?(a.login.val(trim(e[1])),l.login()):sitemessage(u.app.localization.e("filedamaged")))}}),a.c.find(".loginValue").on("focus",function(){a.c.find(".inputTable").addClass("typeactive")}),a.c.find(".loginValue").on("blur",function(){a.c.find(".inputTable").removeClass("typeactive")}),o=parameters(),ParametersLive([r],a.c),o.restore&&l.forgotPassword(),i.fast&&c(),e.clbk(null,e)},tooltip:{options:{position:"left",functionPosition:function(e,n,o){return o.coord.top=10,o.coord.left+=10,o}},event:"mouseenter"},wnd:{class:"withoutButtons allscreen authwindow"}}}var u=new nModule,a={};return u.run=function(e){var n=u.addEssense(a,o,e);u.init(n,e)},u.stop=function(){_.each(a,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=authorization:(app.modules.authorization={},app.modules.authorization.module=authorization);
 /*_____*/ 
var scheduler=function(){function t(e){function a(){function e(){l.tasks();var e=d.taskForTime();l.time(),l.ready(),e.length&&d.missed(e)}var a=f.app.platform.sdk.address.pnet().address;(a=f.app.platform.sdk.pool.getPack(a))?(r=a[0],f.app.platform.sdk.pool.info(r,function(){e()})):e()}var s,r,e=deep(e,"history"),t=[],n=null,i=function(a){return _.find(t,function(e){return e.id==a})},o=function(a){return findIndex(t,function(e){return e.id==a})},d={postInterval:function(){n=setInterval(function(){var e=d.taskForTime();l.time(),e.length&&lazyEach({array:e,sync:!0,action:function(e){var a=e.item;f.app.platform.sdk.node.transactions.get.unspent(function(){d.post(a,function(){e.success()})},null,!0)}})},6e4)},missed:function(e){dialog({html:"You have <b>"+e.length+"</b> missed posts. Do you want to share it?",btn1text:"Yes",btn2text:"No",success:function(){_.each(e,function(e){d.post(e)})},fail:function(){_.each(e,function(e){e.time=null,l.task(e,null,!0)})}})},taskForTime:function(){var a=new Date;return _.filter(t,function(e){if(e.time&&e.ready&&a>e.time&&!e.remove)return!0})},post:function(t,n){var e;t.share?(e=t.share.validation())?(sitemessage(e),d.failPost(t.id),n&&n(!1)):f.app.platform.sdk.pool.dumpKey(r,t.address,function(e){var a;e?(a=bitcoin.ECPair.fromPrivateKey(Buffer.from(e,"hex")),e=bitcoin.payments.p2pkh({pubkey:a.publicKey}),t.module.post(function(e,a){e?d.successPost(t.id):(sitemessage(a),d.failPost(t.id)),n&&n(e)},{address:e,keys:a})):sitemessage("noprivateley")}):(sitemessage("error"),d.failPost(t.id),n&&n(!1))},add:function(){var e={time:null,id:makeid(),share:new Share,address:f.app.platform.sdk.address.pnet().address,ready:!1};e.share.on.change.scheduler=function(){u.save()},t.push(e),l.task(e),u.save()},remove:function(e){var a=o(e);t.splice(a,1),u.save(),s.c.find('.shareAppendWrapper[t="'+e+'"]').remove()},failPost:function(a){var e=i(a);e.time=null,l.task(e,function(){l.ready();var e=s.c.find('.shareAppendWrapper[t="'+a+'"] .result');e.html('<i class="fas fa-exclamation-circle"></i>'),e.addClass("bad")},!0)},successPost:function(e){i(e).remove=!0;e=s.c.find('.shareAppendWrapper[t="'+e+'"] .result');e.html('<i class="far fa-check-circle"></i>'),e.addClass("good"),l.ready(),u.save()}},c=function(){function e(){d.remove(a)}var a=$(this).closest(".shareTimeWrapper").attr("task"),t=i(a);t&&(t.share.validation()?e():dialog({html:"Do you really want to remove this task?",btn1text:"Yes",btn2text:"No",success:e}))},l={tasks:function(e){lazyEach({array:t,action:function(e){var a=e.item;l.task(a,e.success)},sync:!0,all:{success:e}})},task:function(t,n,e){e||s.tasks.append('<div class="shareAppendWrapper" t="'+t.id+'">'),_el=s.tasks.find('.shareAppendWrapper[t="'+t.id+'"]'),f.shell({name:"task",el:_el,data:{task:t}},function(e){e.el.find(".remove").on("click",c);e=e.el.find('.shareTimeWrapper[task="'+t.id+'"] .shareContainer');f.nav.api.load({open:!0,id:"share",el:e,animation:!1,_id:t.id,essenseData:{daddress:t.address||f.app.platform.sdk.address.pnet().address,dtype:t.ready,share:t.share,exoprtByTime:!0,pack:r||{},time:t.time,notClear:!0,changeArrange:function(){u.save()},selectTime:function(e){t.time=e,l.ready(),u.save()},address:function(e){t.address=e,l.ready(),u.save()},type:function(e){"p"==e&&d.post(t,function(){}),"t"==e&&(t.ready=!0),"w"==e&&(t.ready=!1),l.time(),l.ready(),u.save()}},clbk:function(e,a){t.module=a,n&&n()}})})},time:function(){var e=new Date;s.c.find(".timeCellWrapper .time").html(e.getHours()+":"+e.getMinutes())},ready:function(){var a=new Date,e=_.filter(t,function(e){if(e.time&&e.ready&&a<e.time&&!e.remove)return!0});s.c.find(".activeTasks .count").html(e.length)}},u={save:function(){var e=_.filter(t,function(e){if(!e.remove)return!0}),e=_.map(e,function(e){var a=null;return{time:a=e.time?dateToStr(e.time):a,id:e.id,share:e.share.export(!0),address:e.address,ready:e.ready}});localStorage.tasks=JSON.stringify(e)},load:function(){var e=JSON.parse(localStorage.tasks||"[]");t=_.map(e,function(e){var a=new Share;a.import(e.share),a.on.change.scheduler=function(){u.save()};var t=null;return{time:t=e.time?strToDate(e.time):t,id:e.id,share:a,address:e.address,ready:e.ready||!1}})}};return{primary:e,getdata:function(e){u.load(),e({tasks:t})},destroy:function(){s={},n&&clearInterval(n),n=null},init:function(e){u.load(),(s={}).c=e.el.find("#"+f.map.id),s.tasks=s.c.find(".shares"),s.add=s.c.find(".addshare"),s.add.on("click",d.add),d.postInterval(),a(),e.clbk(null,e)}}}var f=new nModule,n={};return f.run=function(e){var a=f.addEssense(n,t,e);f.init(a,e)},f.stop=function(){_.each(n,function(e){e.destroy()})},f}();"undefined"!=typeof module?module.exports=scheduler:(app.modules.scheduler={},app.modules.scheduler.module=scheduler);
 /*_____*/ 
var postscores=function(){function t(s){var r,a,n,o,s=deep(s,"history"),i=function(s,t){if(a.address!=l.user.address.value){s=a.upvote(s);if(!s)return l.app.platform.errorHandler("4",!0),void(t&&t(!1));l.sdk.node.transactions.create.commonFromUnspent(s,function(s,e){topPreloader(100),s?t&&t(!0):(a.myVal=null,l.app.platform.errorHandler(e,!0),t&&t(!1))})}},t=function(){var t=$(this).attr("value");l.app.user.isState(function(s){var e;s?(e=$(this).closest(".stars")).attr("value")||(e.attr("value",t),e.addClass("liked"),i(t,function(s){s?(a.scnt||(a.scnt=0),a.score||(a.score=0),a.scnt++,a.score=Number(a.score||0)+Number(t),s=Number(a.score)/Number(a.scnt),e.find(".tstarsov").css("width",s/5*100+"%"),e.closest(".itemwr").find(".count span.v").html(s.toFixed(1)),d.stars(),n.push({address:l.user.address.value,value:t}),d.details(),d.userlist(),o.like&&o.like(a)):(e.removeAttr("value"),e.removeClass("liked"))})):l.nav.api.load({open:!0,href:"authorization",history:!0})})},d={userlist:function(t){n=_.filter(n,function(s){return 1<=s.value});var s=_.map(n,function(s){return s.address}),a={};_.each(n,function(s){a[s.address]=s.value}),l.nav.api.load({open:!0,id:"userslist",el:r.users,animation:!1,essenseData:{addresses:s,empty:l.app.localization.e("e13151"),caption:l.app.localization.e("e13152"),extra:function(s){var e="",e='<div class="userscore">';return e='<div class="userscore">'+a[s]+' <i class="fas fa-star"></i>',e+="</div>"}},clbk:function(s,e){t&&t(s,e)}})},mystars:function(s){var e;void 0===a.myVal&&(e=[a.txid],l.app.platform.sdk.likes.get(e,function(){d.stars()}))},stars:function(e){l.shell({turi:"lenta",name:"stars",el:r.stars,data:{share:a}},function(s){fastars(s.el.find(".stars")),s.el.find(".stars i").on("click",t),e&&e()})},details:function(e){l.shell({name:"details",el:r.details,data:{share:a,scores:n}},function(s){s.el.find(".line").each(function(){var s=$(this);s.width(s.attr("awidth")+"%")}),e&&e()})}},e=function(){};return{primary:s,getdata:function(e,s){var t=deep(s,"settings.essenseData.share");o=deep(s,"settings.essenseData"),l.app.platform.sdk.node.shares.getbyid([t],function(){var s;(a=l.app.platform.sdk.node.shares.storage.trx[t])||(s=_.find(l.sdk.node.transactions.temp.share,function(s){return s.txid==t}))&&((a=new pShare)._import(s,!0),a.temp=!0,a.address=l.app.platform.sdk.address.pnet().address),a&&l.app.platform.sdk.postscores.get(t,function(){n=l.sdk.postscores.storage[t]||[],e({share:a})})})},destroy:function(){r={}},clearparameters:["p"],init:function(s){e(),(r={}).c=s.el.find("#"+l.map.id),r.stars=r.c.find(".forstars"),r.details=r.c.find(".details"),r.users=r.c.find(".users"),d.stars(function(){d.details(),d.userlist(),d.mystars()}),s.clbk(null,s)},wnd:{class:"postscoreswnd",nooverflow:!0,swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,buttons:{}}}}var l=new nModule,a={};return l.run=function(s){var e=l.addEssense(a,t,s);l.init(e,s)},l.stop=function(){_.each(a,function(s){s.destroy()})},l}();"undefined"!=typeof module?module.exports=postscores:(app.modules.postscores={},app.modules.postscores.module=postscores);
 /*_____*/ 
var surveyiframe=function(){function r(e){var n,e=deep(e,"history"),r=function(e){"endsurvey"==(e.originalEvent.data||{}).message&&a.closeContainer()},i=function(){};return{primary:e,getdata:function(e){e({})},destroy:function(){n={}},init:function(e){localStorage.survey1=!0,i(),(n={}).c=e.el.find("#"+a.map.id),$(n.c.find("iframe")[0].contentWindow).on("message",r),e.clbk(null,e)},wnd:{class:"allscreen black surveyiframe"}}}var a=new nModule,i={};return a.run=function(e){var n=a.addEssense(i,r,e);a.init(n,e)},a.stop=function(){_.each(i,function(e){e.destroy()})},a}();"undefined"!=typeof module?module.exports=surveyiframe:(app.modules.surveyiframe={},app.modules.surveyiframe.module=surveyiframe);
 /*_____*/ 
var dust=function(){function t(e){function t(){var e=deep(r,"pk.value");r={pk:new Parameter({name:"Private Key",type:"string",id:"pk",placeholder:"Private Key",value:e||""}),reciever:new Parameter({name:u.app.localization.e("wsreciever"),type:"string",id:"reciever",placeholder:u.app.localization.e("wsenter")}),amount:new Parameter({name:u.app.localization.e("wsamount"),id:"amount",type:"NUMBER",placeholder:u.app.localization.e("wsamountof"),format:{Precision:6}}),outputs:new Parameter({name:"Count of outputs",id:"outputs",type:"NUMBER",placeholder:"Count of outputs",defaultValue:1,format:{Precision:0,Min:1,Max:200}}),message:new Parameter({name:"Message",id:"message",type:"stringany",placeholder:"Your message",format:{Length:80}})}}var n,e=deep(e,"history"),r={},s={sendWrapper:function(){if(r.reciever.value){var a=!0;try{bitcoin.address.fromBase58Check(r.reciever.value)}catch(e){a=!1}a?r.amount.value?r.pk.value?s.send(r.pk.value):dialog({html:"Do you want to send coins from current acount?",btn1text:"Yes",btn2text:"No, cancel",success:function(){s.send(u.app.user.private.value.toString("hex"))}}):sitemessage("You must enter Amount"):sitemessage("Address is not valid")}else sitemessage("You Must Enter Reciever Address")},send:function(e){n.c.find(".loader").fadeIn(),u.app.platform.sdk.wallet.sendmanyoutputs(e,r.reciever.value,r.amount.value,r.outputs.value,function(e,a){n.c.find(".loader").fadeOut(),e?u.app.platform.errorHandler(e,!0):(t(),o.parameters(),sitemessage("Success!"))},r.message.value)}},o={parameters:function(){u.shell({name:"parameters",el:n.c.find(".parametersWrapper"),data:{d:{parameters:r}}},function(e){ParametersLive(_.toArray(r),e.el),e.el.find(".sends").on("click",s.sendWrapper)})}},a=function(){};return{primary:e,getdata:function(e){e({})},destroy:function(){n={}},init:function(e){a(),(n={}).c=e.el.find("#"+u.map.id),t(),o.parameters(),e.clbk(null,e)}}}var u=new nModule,n={};return u.run=function(e){var a=u.addEssense(n,t,e);u.init(a,e)},u.stop=function(){_.each(n,function(e){e.destroy()})},u}();"undefined"!=typeof module?module.exports=dust:(app.modules.dust={},app.modules.dust.module=dust);
 /*_____*/ 
var post=function(){function t(s){var n,i,o,r,t=deep(s,"history")||deep(s,"primary"),d="",p=null,l=0,a=!1,c={authclbk:function(){a=!0;var e=i.txid;W.app.platform.sdk.node.shares.getbyid(e,function(){delete(i=W.app.platform.sdk.node.shares.storage.trx[e]).myVal,c.subscribeLabel(),T.mystars(function(){a=!1})})},subscribeLabel:function(){var e,s=W.app.user,t=!1;s.address.value&&i.address==s.address.value||!s.address.value||(e=deep(W.app,"platform.sdk.users.storage."+s.address.value))&&e.relation(i.address,"subscribes")&&(t=!0),n.c&&(e=n.share.find(".shareTable"),t?e.addClass("subscribed"):e.removeClass("subscribed"))},stateAction:function(s){W.app.user.isState(function(e){e?s():W.nav.api.load({open:!0,id:"authorization",inWnd:!0,essenseData:{fast:!0,loginText:W.app.localization.e("llogin"),successHref:"_this",signInClbk:function(){retry(function(){return!a},function(){s&&s()})}}})})},postscores:function(e){W.app.nav.api.load({open:!0,href:"postscores?p="+i.txid,inWnd:!0,history:!0,essenseData:{share:i.txid,like:function(e){T.stars(),o.like&&o.like()}},clbk:function(){e&&e()}})},repost:function(s){c.stateAction(function(){var e="index";isMobile()&&(e="share"),W.closeContainer(),W.nav.api.load({open:!0,href:e+"?repost="+s,history:!0,handler:!0,essenseData:{},clbk:function(e){}})})},next:function(){n.wnd.off("scroll");var s=n.c.find(".nextpost");s.html('<div class="loader"><div class="preloader5"><span></span><span></span><span></span></div></div>'),o.next(i.txid,function(e){e?W.nav.api.load({open:!0,href:"post?s="+e,eid:"nextpost"+e,el:s,clbk:function(){},essenseData:{share:e,hr:o.hr,like:o.like,next:o.next,removemargin:!0}}):s.html('<div class="ended">'+W.app.localization.e("e13146")+"</div>")})},sharesocial:function(e){var s="https://bastyon.com/"+(o.hr||"index?")+"s="+i.txid+"&mpost=true&ref="+W.app.platform.sdk.address.pnet().address;parameters().address&&(s+="&address="+(parameters().address||""));var t=i.message,a=trimHtml(t,130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),t=i.images[0];t||!i.url||(n=videoImage(i.url))&&(t=n);var n="Post";"a"==i.settings.v&&(n="Article"),W.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0,essenseData:{url:s,caption:W.app.localization.e("e13147")+" "+n,image:t,title:i.caption||deep(app,"platform.sdk.usersl.storage."+i.address+".name"),text:a}})},donate:function(e){var s=deep(app,"platform.sdk.usersl.storage."+i.address)||{address:i.address,addresses:[]},t="send?address="+i.address+"&amount=1&message="+hexEncode(W.app.localization.e("postlabel")+" &mdash; "+(i.caption||i.message).substr(0,20)+"...")+"&label="+(s.name||s.address)+"&setammount=true";W.fastTemplate("donation",function(e){dialog({html:e,class:"one donation",btn1text:W.app.localization.e("dcancel"),clbk:function(e,s){e.find(".pnetdnt").on("click",function(){W.nav.api.load({open:!0,href:t,history:!0}),W.closeContainer(),s.destroy()}),e.find(".copy").on("click",function(){var e=$(this).closest(".address").find(".addr");copyText(e),sitemessage(W.app.localization.e("successfullycopiedaddress"))})}})},{userinfo:s})},position:function(){var e;isMobile()||t||o.removemargin||(0<(e=($(window).height()-n.wr.height())/2)?n.wr.css("margin-top",e+"px"):n.wr.css("margin-top","0px"))},initVideo:function(t){var e,a;W.app.platform.sdk.usersettings.meta.embedvideo&&!W.app.platform.sdk.usersettings.meta.embedvideo.value||(e=n.c.find(".js-player, [data-plyr-provider][data-plyr-embed-id]")).length&&(a={resetOnEnd:!0,muted:!1},$.each(e,function(e,s){PlyrEx(s,a,function(e){e.on("ready",function(){t&&t()})})}))},likeWithR:function(e,s){},like:function(e,t){e=i.upvote(e);if(!e)return W.app.platform.errorHandler("4",!0),void(t&&t(!1));W.sdk.node.transactions.create.commonFromUnspent(e,function(e,s){topPreloader(100),e?t&&t(!0):(i.myVal=null,W.app.platform.errorHandler(s,!0),t&&t(!1))})},complain:function(e){W.nav.api.load({open:!0,id:"complain",inWnd:!0,essenseData:{item:"post",obj:i,success:function(){}},clbk:function(){}})},unsubscribe:function(t){W.app.platform.api.actions.unsubscribe(i.address,function(e,s){e||W.app.platform.errorHandler(s,!0),t&&t(e,s)})},subscribe:function(t){W.app.platform.api.actions.subscribe(i.address,function(e,s){e||W.app.platform.errorHandler(s,!0),t&&t(e,s)})},openGalleryRec:function(t,e){var a=[],n=function(e,s){_.each(e.images,function(e){a.push(e)}),e.repost?W.app.platform.sdk.node.shares.getbyid(e.repost,function(e){e=e[0];e?n(e,s):s&&s()}):s&&s()};n(i,function(){var e=_.map(a,function(e){return{src:e}}),s=findIndex(e,function(e){if(e.src==t)return!0});W.app.nav.api.load({open:!0,href:"imagegallery?i="+i.txid+"&num="+(s||0),inWnd:!0,history:"true",essenseData:{initialValue:t,idName:"src",images:e}})})},openGallery:function(s){var e=_.map(i.images,function(e){return{src:e}}),t=findIndex(e,function(e){if(e.src==s)return!0});W.app.nav.api.load({open:!0,href:"imagegallery?i="+i.txid+"&num="+(t||0),inWnd:!0,history:"true",essenseData:{initialValue:s,idName:"src",images:e}})}},u=function(){c.postscores()},f=function(){c.repost(i.txid)},m=function(){var e=$(this),s=i.txid;W.app.platform.api.metmenu(e,s,c)},h=function(e){c.unsubscribe(function(){tx&&n.share.find(".shareTable").removeClass("subscribed")})},b=function(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";W.app.platform.api.actions[e](i.address,function(e,s){e||W.app.platform.errorHandler(s,!0)})},v=function(e){c.stateAction(function(){W.app.platform.api.actions.subscribeWithDialog(i.address,function(e,s){e?n.share.find(".shareTable").addClass("subscribed"):W.app.platform.errorHandler(s,!0)})})},g=function(){W.app.platform.sdk.node.transactions.get.tx(i.txid)},k=function(){var t=$(this).attr("value");c.stateAction(function(){var s;W.app.platform.sdk.address.pnet()&&i.address!=W.app.platform.sdk.address.pnet().address&&((s=$(this).closest(".stars")).attr("value")||(s.attr("value",t),s.addClass("liked"),c.like(t,function(e){e?(i.scnt||(i.scnt=0),i.score||(i.score=0),i.scnt++,i.score=Number(i.score||0)+Number(t),e=Number(i.score)/Number(i.scnt),s.find(".tstarsov").css("width",e/5*100+"%"),s.closest(".itemwr").find(".count span.v").html(e.toFixed(1)),T.stars(),o.like&&o.like(i)):(s.removeAttr("value"),s.removeClass("liked"))})))})},y=function(){dialog({html:W.app.localization.e("e13148"),btn1text:W.app.localization.e("dyes"),btn2text:W.app.localization.e("dno"),success:function(){n.share.addClass("complained"),topPreloader(30),c.complain(function(e){topPreloader(100),e||s.removeClass("hidden")})}})},x=function(){var e=$(this).attr("i");c.openGalleryRec(e)},w=function(){c.sharesocial()},C=function(){c.donate()},T={comments:function(a){!o.repost||o.fromempty?W.fastTemplate("commentspreview",function(e){var s=n.c.find(".commentsWrapper"),t="";W.app.platform.sdk.address.pnet()&&(t="&ref="+W.app.platform.sdk.address.pnet().address);t="https://bastyon.com/"+(o.hr||"index?")+"s="+i.txid+"&mpost=true"+t;parameters().address&&(t+="&address="+(parameters().address||"")),W.nav.api.load({open:!0,id:"comments",el:s,eid:(o.eid||"")+i.txid+"post",essenseData:{hr:t,totop:n.c,caption:e,send:function(){var e=n.c.find(".commentsAction .count span");e.html(Number(e.html()||"0")+1)},txid:i.txid,reply:o.reply,showall:!o.fromempty,init:o.fromempty||!1,preview:o.fromempty||!1,fromtop:!o.fromempty,fromempty:o.fromempty,lastComment:o.fromempty?i.lastComment:null,additionalActions:function(){W.closeContainer()}},clbk:function(e,s){c.position(),r=s,a&&a()}})},{share:i}):a&&a()},empty:function(){W.shell({name:"empty",el:n.share},function(e){c.position()})},images:function(e){var s=n.c.find(".image"),t=n.c.find(".images");!t.hasClass("active")&&s.length&&t.length?s.imagesLoaded({background:!0},function(a){"a"!=i.settings.v&&_.each(a.images,function(e,s){var t=e.img,e=$(a.elements[s]).closest(".imagesWrapper"),s=e.width();e.height(),t.width,t.height;t.width<e.width()?(e.find(".image").width(t.width),e.find(".image").height(t.height)):e.height(s*(t.height/t.width))}),t.addClass("active"),s.addClass("active"),e&&e()}):e&&e()},share:function(s){W.shell({turi:"lenta",name:"share",el:n.share,additionalActions:function(){W.closeContainer()},data:{share:i,all:!0,mestate:{},repost:o.repost,fromempty:o.fromempty}},function(e){n.stars=n.share.find(".forstars"),c.position(),n.wr.addClass("active"),T.stars(function(){T.mystars(function(){}),T.url(function(){T.repost(),c.position(),T.urlContent(function(){c.position(),c.initVideo(),T.images(function(){o.repost||(c.position(),n.share.find(".complain").on("click",y),n.share.on("click",".image",x),n.share.on("click",".forrepost",f),n.share.find(".txid").on("click",g),n.share.find(".donate").on("click",C),n.share.find(".sharesocial").on("click",w),n.share.find(".asubscribe").on("click",v),n.share.find(".aunsubscribe").on("click",h),n.share.find(".metmenu").on("click",m),n.share.find(".notificationturn").on("click",b)),s&&s()})})})})})},wholike:function(s){var e=i.who||[];W.shell({turi:"lenta",name:"wholike",el:n.share.find(".wholikes"),data:{scores:Number(i.scnt),wholikes:e},bgImages:{}},function(e){e.el.find(".wholikesTable").on("click",u),s&&s()})},mystars:function(e){var s;void 0===i.myVal?(s=[i.txid],W.app.platform.sdk.likes.get(s,function(){T.stars(),T.wholike(e)})):e&&e()},stars:function(s){W.shell({turi:"lenta",name:"stars",el:n.stars,data:{share:i}},function(e){fastars(e.el.find(".stars")),n.share.find(".stars i").on("click",k),s&&s()})},repost:function(e){i.repost&&W.shell({turi:"lenta",name:"repost",el:n.c.find(".repostWrapper"),data:{repost:i.repost,level:l,share:i}},function(e){c.position(),e.el&&e.el.length&&W.app.platform.papi.post(i.repost,e.el.find(".repostShare"),function(e){p=e,c.position()},{repost:!0,eid:d+i.txid,level:l,fromempty:i.isEmpty()})})},url:function(s){var e=i.url,t=W.app.platform.sdk.remote.storage[e];W.shell({turi:"share",name:"url",el:n.c.find(".url"),data:{url:e,og:t,share:i},additionalActions:function(){W.closeContainer()}},function(t){var a=t.el.find("img");t.el.find("img").imagesLoaded({background:!0},function(e){_.each(e.images,function(e,s){e.isLoaded?($(a[s]).addClass("active"),500<e.img.naturalWidth&&t.el.addClass("bigimageinlink")):$(a[s]).closest(".image").css("display","none")}),s&&s()})})},urlContent:function(s){var e,t,a=i.url;a?(e=W.app.platform.parseUrl(a),t=W.app.platform.sdk.remote.storage[a],!a||t||"youtube"==e.type||"vimeo"==e.type||"bitchute"==e.type||"peertube"==e.type?s&&s():W.app.platform.sdk.remote.get(a,function(e){e?T.url(s):s&&s()})):s&&s()}},D=function(){};return{primary:t,getdata:function(a,n){p=null,d=n.settings.eid||"";var s=deep(n,"settings.essenseData.share")||parameters().s;o=deep(n,"settings.essenseData")||{},i=null,l=(o.level||-1)+1,W.app.platform.sdk.node.shares.getbyid([s],function(){var e;(i=W.app.platform.sdk.node.shares.storage.trx[s])||(e=_.find(W.sdk.node.transactions.temp.share,function(e){return e.txid==s}))&&((i=new pShare)._import(e,!0),i.temp=!0,i.address=W.app.platform.sdk.address.pnet().address),i&&W.app.platform.sdk.node.shares.users([i],function(e,s){var t={ed:deep(n,"settings.essenseData")||{}};a(t)})})},authclbk:function(){void 0!==n&&n.c&&c.authclbk()},destroy:function(e){n={},o.close&&o.close(),r&&r.destroy(),delete W.app.platform.ws.messages.event.clbks.post,delete W.app.platform.ws.messages.transaction.clbks.temppost,delete W.app.platform.clbks.api.actions.subscribePrivate.post,delete W.app.platform.clbks.api.actions.unsubscribe.post,delete W.app.platform.clbks.api.actions.subscribe.post,a=!1,p&&(p.destroy(),p=null)},clearparameters:["s","commentid","parentid"],init:function(e){D(),(n={}).c=e.el.find("#"+W.map.id),n.share=n.c.find(".share"),n.wr=n.c.find(".postWrapper"),n.wnd=n.c.closest(".wndcontent"),i?T.share(function(){T.comments(function(){})}):T.empty(),e.clbk(null,e),W.app.platform.ws.messages.transaction.clbks.temppost=function(e){e.temp&&i.txid==e.temp.txid&&(i.temp=!1,i.scnt="0",i.score="0",i.myVal=0,T.share())},W.app.platform.ws.messages.event.clbks.post=function(e){"upvoteShare"==e.mesType&&e.share&&i.txid==e.share.txid&&T.stars(function(){})},W.app.platform.clbks.api.actions.subscribePrivate.post=function(e){var s;e==i.address&&(n.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),(s=deep(W.app,"platform.sdk.users.storage."+W.user.address.value.toString("hex")))&&(s=s.relation(e,"subscribes"),n.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"),!s||"true"!=s.private&&!0!==s.private?n.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"):n.c.find('.shareTable[address="'+e+'"] .notificationturn').addClass("turnon")))},W.app.platform.clbks.api.actions.subscribe.post=function(e){e==i.address&&(n.c.find('.shareTable[address="'+e+'"]').addClass("subscribed"),n.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))},W.app.platform.clbks.api.actions.unsubscribe.post=function(e){e==i.address&&(n.c.find(".shareTable").removeClass("subscribed"),n.c.find('.shareTable[address="'+e+'"] .notificationturn').removeClass("turnon"))}},wnd:{class:"withoutButtons postwindow",swipeClose:!0,swipeCloseDir:"right",swipeMintrueshold:30,close:function(){}}}}var W=new nModule,a={};return W.authclbk=function(){_.each(a,function(e){e.authclbk()})},W.run=function(e){var s=W.addEssense(a,t,e);W.init(s,e)},W.stop=function(){_.each(a,function(e){e.destroy()})},W}();"undefined"!=typeof module?module.exports=post:(app.modules.post={},app.modules.post.module=post);
 /*_____*/ 
var socialshare=function(){function i(e){var i,a,e=deep(e,"history"),t=(g.app.localization.e("e13171"),g.app.localization.e("e13172")+"\r\n"),s={},n=!1,o="",c=deep(window,"plugins.socialsharing"),r=function(){return!i||n?"":o||t},l=function(){g.shell({name:"sharebuttons",el:a.c.find(".sharebuttons"),data:{socials:p()}},function(e){h()})},p=function(){return _.filter(d,function(e){if(!e.if||e.if())return!0})},d=[{n:"Email",i:'<i class="far fa-envelope"></i> '+g.app.localization.e("e13173"),t:"email",c:"#f82a53"},{n:"SMS",i:"SMS",t:"sms",c:"#143e50",s:"shareViaSMS",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Facebook",i:'<i class="fab fa-facebook-f"></i>',t:"facebook",c:"#3b5999",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Instagram",i:'<i class="fab fa-instagram"></i>',t:"instagram",c:"#fd1d1d",s:"shareViaInstagram",if:function(){return deep(window,"plugins.socialsharing.canShareVia")}},{n:"Twitter",i:'<i class="fab fa-twitter"></i>',t:"twitter",c:"#55acee",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}},{n:"Reddit",i:'<i class="fab fa-reddit-alien"></i>',t:"reddit",c:"#ff5700"},{n:"Pinterest",i:'<i class="fab fa-pinterest-p"></i>',t:"pinterest",c:"#bd081c"},{n:"LinkedIn",i:'<i class="fab fa-linkedin-in"></i>',t:"linkedin",c:"#0077B5"},{n:"Whatsapp",i:'<i class="fab fa-whatsapp"></i>',t:"whatsapp",c:"#075e54",s:"shareViaWhatsApp",if:function(){return deep(window,"plugins.socialsharing.canShareVia")||!window.cordova}}],u=function(){g.app.settings.set(g.map.id,"calltoActionNotInclude",n),g.app.settings.set(g.map.id,"calltoActionUserText",o)},f=function(){o=g.app.settings.get(g.map.id,"calltoActionUserText")||"",n=g.app.settings.get(g.map.id,"calltoActionNotInclude")||!1},h=function(){a.c.find(".socialsharebtn").each(function(){var e,a,i,t,n,o=$(this);o.hasClass("s_email")?o.on("click",function(){var e=r()+"\r\n"+s.title+"\r\n\r\n"+s.text+"\r\n\r\n\r\n"+s.url;deep(app,"platform.sdk.user.storage.me.name")&&(e+="\r\n\r\nBest,\r\n"+deep(app,"platform.sdk.user.storage.me.name"));var a="";a+="mailto:",a+="?subject="+s.title,a+="&body=",a+=encodeURIComponent(e),window.location.href=a}):(a=s.text,e=s.title,a=trim(r()+" "+a),i=o.data("type"),(i=(n=i,_.find(d,function(e){return e.t==n})))&&i.s&&window.cordova&&c?(t=i.s,o.on("click",function(){"shareViaFacebook"!=t&&"shareViaTwitter"!=t&&"shareViaWhatsApp"!=t||c[t](a,s.image,s.url),"shareViaInstagram"==t&&c[t](a,s.image),"shareViaSMS"==t&&c[t]({message:a+" "+s.url,subject:e,image:s.image})})):o.ShareLink({title:e,text:a,image:s.image,url:s.url,class_prefix:"s_",width:640,height:480}),o.on("click",function(){$(this).data("type")}))})};return{primary:e,getdata:function(e,a){i=a.state,s=a.settings.essenseData||{},f(),s.title||(s.title="Pocketnet"),s.text||(s.text=g.app.localization.e("e13171")),s.image||(s.image="https://bastyon.com/img/logobigpadding.png"),s.url||("undefined"!=typeof _Electron||window.cordova?(a=(a=window.location.pathname.split("/"))[a.length-1],s.url="https://bastyon.com/"+a+window.location.search):s.url="https://bastyon.com/"+g.app.nav.get.href()),g.app.platform.sdk.address.pnet()&&(s.url=g.app.nav.api.history.addParametersToHref(s.url,{ref:g.app.platform.sdk.address.pnet().address})),e({socials:p(),url:s.url,rescue:s.rescue||!1,caption:s.caption,calltoActionUserText:o||t,calltoActionNotInclude:n})},destroy:function(){a={}},init:function(e){f(),(a={}).c=e.el.find("#"+g.map.id),a.url=a.c.find(".url"),a.c.find(".copycell").on("click",function(){copyText(a.url.find(".urlcell")),sitemessage(g.app.localization.e("urlsuccesscopied"))}),a.c.find(".changecallto").on("click",function(){n=!n,$(".additionalwrapper").toggleClass("checked"),n&&a.c.removeClass("textshowed"),u(),l()}),a.c.find(".morecell").on("click",function(){a.c.toggleClass("textshowed"),a.c.closest(".wnd").toggleClass("textshowedwnd")}),a.c.find(".calltoActionUserText").on("keyup",function(){(o=$(this).val())==t&&(o=""),u(),l()}),a.c.find(".calltoActionUserText").on("change",function(){o||a.c.find(".calltoActionUserText").val(t)}),l(),e.clbk(null,e)},wnd:{swipeClose:!0,swipeMintrueshold:30,header:g.app.localization.e("e13174"),class:"sharingwindow"}}}var g=new nModule,t={};return g.run=function(e){var a=g.addEssense(t,i,e);g.init(a,e)},g.stop=function(){_.each(t,function(e){e.destroy()})},g}();"undefined"!=typeof module?module.exports=socialshare:(app.modules.socialshare={},app.modules.socialshare.module=socialshare);
 /*_____*/ 
var author=function(){function t(e){var i,a,r,o,e=deep(e,"history"),t=null,n=null,l=!1,s=null,c={subscribeLabel:function(){var e,n=v.app.user,t=!1;n.address.value&&i.address==n.address.value||!n.address.value||(e=deep(v.app,"platform.sdk.users.storage."+n.address.value))&&e.relation(i.address,"subscribes")&&(t=!0),r.c&&(e=r.caption.find(".subscribebuttonstop"),t?e.addClass("following"):e.removeClass("following"))},showmoreabout:function(){var e=filterXSS(clearScripts(findAndReplaceLink(deep(i,"data.about"),!0)));r.c.find(".aboutwrapper").html(e),r.c.find(".showmoreabout").remove()},showHideUp:function(){200<r.w.scrollTop()?r.up.addClass("active"):r.up.removeClass("active")},panelTopPosition:function(){var e;isMobile()||(e=$(window).scrollTop(),r.caption.height()+20<e?r.fxd.addClass("dfxd"):r.fxd.removeClass("dfxd"),c.panelPosition())},panelPosition:function(){var e,n,t;isMobile()||(e=r.fxd,t=r.panel.closest(".mwork"),n=$(window).width(),t=n-(n=n-(t.offset().left+t.width())+0)-350,e.css("right",n+"px"),e.css("left",t+"px"))},destroy:function(){_.each(u,function(e){e.active=!1,e.module&&e.module.destroy()})}},p={showHideUp:function(){n=slowMade(function(){c.showHideUp()},n,30)},up:function(){_scrollTop(0)},unsubscribe:function(){dialog({html:v.app.localization.e("e13022"),btn1text:v.app.localization.e("unfollow"),btn2text:v.app.localization.e("ucancel"),class:"zindex",success:function(){v.app.platform.api.actions.unsubscribe(i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)})}})},subscribe:function(){v.app.platform.api.actions.subscribeWithDialog(i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)})},subscribePrivate:function(){var e=$(this).hasClass("turnon")?"notificationsTurnOff":"notificationsTurnOn";v.app.platform.api.actions[e](i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)})}},u={shares:{name:v.app.localization.e("uposts"),mobile:'<i class="fas fa-align-justify"></i>',id:"shares",render:"lenta",history:!0,count:function(){return 0}},post:{if:function(){return!1},id:"post",render:"post",count:function(){return 0}},followers:{name:v.app.localization.e("followers"),mobile:'<i class="fas fa-users"></i>',id:"followers",render:"followers",history:!0,count:function(){return deep(i,"data.subscribers.length")||0}},following:{name:v.app.localization.e("following"),id:"following",mobile:'<i class="fas fa-user-plus"></i>',render:"following",history:!0,count:function(){return deep(i,"data.subscribes.length")||0}},share:{name:v.app.localization.e("share").toUpperCase()+' <i class="fas fa-share-alt"></i>',mobile:'<i class="fas fa-share-alt"></i>',id:"share",if:function(){return!0},events:{click:function(){v.nav.api.load({open:!0,href:"socialshare",history:!0,inWnd:!0})}}},settings:{name:v.app.localization.e("settings")+' <i class="fas fa-cog"></i>',mobile:'<i class="fas fa-cog"></i>',id:"settings",href:function(){return v.app.user.validate()?"userpage?id=ustate":"userpage"},class:"tosettings",if:function(){if(v.user.isItMe(i.address)&&!isMobile())return!0}},more:{name:'<i class="fas fa-ellipsis-h"></i>',mobile:'<i class="fas fa-ellipsis-h"></i>',id:"more",class:"more",if:function(){if(!v.user.isItMe(i.address)&&a)return!0},events:{click:function(){d.metmenu($(this))}}},info:{name:v.app.localization.e("info")+' <i class="fas fa-info-circle"></i>',mobile:'<i class="fas fa-info-circle"></i>',id:"info",class:"info",render:"info",history:!0,if:function(){if(isMobile())return!0}}},d={contents:function(e,n){var t=parameters().mt,t={name:"contents",el:r.contents,data:{contents:e,author:i,selected:t}};v.shell(t,function(e){e.el.find(".hasmore .captiontable").on("click",function(){$(this).closest(".hasmore").toggleClass("showedmore")}),n&&n()})},metmenu:function(t){var o={};v.fastTemplate("metmenu",function(e,n){v.app.platform.api.tooltip(t,function(){return o.author=i,n(o)},function(e){e.find(".donate").on("click",function(){c.donate(id),t.tooltipster("hide")}),e.find(".block").on("click",function(){v.app.platform.api.actions.blocking(i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)}),t.tooltipster("hide")}),e.find(".unblock").on("click",function(){v.app.platform.api.actions.unblocking(i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)}),t.tooltipster("hide")})})},o)},panel:function(){var e={};v.user.isItMe(i.address)||(e.author=i.address),v.nav.api.load({open:!0,id:"panel",el:r.panel,animation:!1,essenseData:{discussions:e},clbk:function(e,n){t=n,c.panelPosition(),window.addEventListener("resize",p.panelPosition),window.addEventListener("scroll",c.panelTopPosition)}})},report:function(e,n,t){var o;c.destroy(),!e.active&&e.history&&(o=["mt"],"shares"==e.id&&!n||o.push("ss"),t||v.app.nav.api.history.addRemoveParameters(o,{report:e.id})),e.active=!0,d[e.render]&&(d[e.render](r.lenta,e),d.menulight(),v.app.platform.sdk.contents.get(i.address,function(e){d.contents(e)}))},menulight:function(){r.menu.find(".usermenuitem").removeClass("active");var e=_.find(u,function(e){return e.active});e&&r.menu.find(".usermenuitem .c"+e.class).addClass("active")},menu:function(e){v.shell({name:"menu",el:r.menu,data:{reports:u}},function(o){o.el.find(".usermenuitem").swipe({tap:function(){var e=$(this).attr("menuitem");u[e]&&d.report(u[e])}}),_.each(u,function(e,n){var t;e.events&&(t=o.el.find('[menuitem="'+n+'"]'),_.each(e.events,function(e,n){"click"==n&&isMobile()?t.swipe({tap:e}):t.on(n,e)}))}),e&&e()})},userslist:function(e,n,t,o,a){v.nav.api.load({open:!0,id:"userslist",el:e,animation:!1,essenseData:{addresses:n,empty:t,caption:o},clbk:function(e,n){a&&a(e,n)}})},info:function(e){v.shell({name:"info",el:e,data:{author:i},animation:"fadeIn"},function(e){e.el.find(".showmoreabout").on("click",c.showmoreabout)})},followers:function(e,t){var n=_.map(deep(i,"data.subscribers")||[],function(e){return e}),o=v.app.localization.e("anofollowers");v.user.isItMe(i.address)&&(o=v.app.localization.e("aynofollowers")),d.userslist(e,n,o,"Followers",function(e,n){t.module=n})},following:function(e,t){var n=_.map(deep(i,"data.subscribes")||[],function(e){return e.adddress}),o=v.app.localization.e("anofollowing");v.user.isItMe(i.address)&&(o=v.app.localization.e("aynofollowing")),d.userslist(e,n,o,"Following",function(e,n){t.module=n})},post:function(o,e){var a=parameters().mt;v.app.platform.sdk.contents.get(i.address,function(e){var n=v.app.platform.sdk.contents.getsorteditems(e),t=_.map(n,function(e){return e.txid}),e=_.indexOf(t,a),n={currentindex:e+1,allength:t.length,leftid:null,rightid:null};0<e&&(n.leftid=t[e-1]),e<t.length-1&&(n.rightid=t[e+1]),v.shell({name:"post",el:o,data:n},function(t){var e="author?address="+i.address,n=app.platform.api.name(i.address);n&&(e=n.toLowerCase()+"?"),v.app.platform.papi.post(a,t.el.find(".postcnt"),function(e,n){external=n,l&&r.c.find(".contentswrapper").hcSticky("refresh"),t.el.find(".postauarrows").addClass("active")},{hr:e})})})},lenta:function(t,o){function n(){var e={name:"lenta",el:t,data:{}};v.shell(e,function(e){var n;v.nav.api.load({open:!0,id:"lenta",el:t.find(".authorlentawrapper"),animation:!1,mid:i.address,essenseData:s,clbk:function(e,n){o.module=n,l&&r.c.find(".contentswrapper").hcSticky("refresh")}}),!isMobile()&&i.data&&i.data.name&&(n=e.el.find(".authorlentawrappermain"),e.el.find(".authorsearchicon .icon").on("click",function(){n.toggleClass("searchactive"),n.hasClass("searchactive")?n.find(".search input").focus():(n.find(".search input").val(""),h())}),new search(e.el.find(".authorsearch"),{placeholder:"SEARCH ON "+i.data.name.toUpperCase(),clbk:function(e){},last:{get:function(){return[]},tpl:function(e,n){}},events:{search:function(e,n,t,o){e="?report=shares&ss="+e.replace("#","tag:");h(!0);e={href:e,history:!0,open:!0,handler:!0};v.nav.api.go(e),n&&n(!0)},clear:function(e){}}}),parameters().ss&&(n.addClass("searchactive"),n.find(".search input").val(parameters().ss)))})}var e="author?address="+i.address,a=app.platform.api.name(i.address);a&&(e=a.toLowerCase()+"?");var s={author:i.address,byauthor:!0,hr:e,renderclbk:function(){l&&r.c.find(".contentswrapper").hcSticky("refresh")}};"b"==parameters().r?(e=a.toLowerCase()+"?r=b&mt="+parameters().mt,s.beginmaterial=parameters().mt,s.contents=!0,v.app.platform.sdk.contents.get(i.address,function(e){e=v.app.platform.sdk.contents.getsorteditems(e);s.txids=_.map(e,function(e){return e.txid}),n()})):(parameters().ss&&(s.search=!0,s.searchValue=parameters().ss,s.loader=function(n){b("posts",deep(m,"data.length")||0,10,function(e){e=e,e=v.app.platform.sdk.node.shares.transform(e),n&&n(e,null,{count:10})})}),n())}},f=function(){},m=null,h=function(e){parameters().ss&&(v.app.platform.sdk.search.clear(),s=m=null,e||d.report(u.shares,!0))},b=function(e,n,t,o){var a,s=0,i=10;m&&(s=m.data.length,i=m.count),n+t<=s||(n<s&&(a=s-n,n=s,t-=a),(t=i<n+t?i-n:t)<=0||w[e](function(e){o&&o(e)},n,t))},w={posts:function(t,e,n){v.app.platform.sdk.search.get(parameters().ss,"posts",e,n,s||null,function(e,n){s=n,t((m=m||e).data)},i.address)}};return{primary:e,parametersHandler:function(){var e=parameters().report||"shares";d.report(u[e],null,!0),d.menu()},authclbk:function(){var e=_.find(u,function(e){return e.active});e&&"shares"!=e.id&&d.report(e,null,!0),c.subscribeLabel()},getdata:function(n,e){i={},v.app.platform.sdk.search.clear();var t=e.settings.essenseData||{},o=parameters();a=e.state,o.address||(o.address=t.address),l=!1,m=s=null,v.sdk.users.addressByName(o.address,function(e){e&&(i.address=e,v.sdk.users.get(i.address,function(){v.sdk.ustate.get(i.address,function(){if(v.app.platform.sdk.address.pnet()&&i.address==v.app.platform.sdk.address.pnet().address){if(u.shares.name=v.app.localization.e("myuposts"),!v.app.user.validate())return void v.nav.api.go({href:"userpage?id=test",history:!0,open:!0})}else u.shares.name=v.app.localization.e("uposts");i.data=v.sdk.users.storage[i.address],i.state=v.sdk.ustate.storage[i.address],n({author:i})})}))})},destroy:function(){o&&o.destroy(),o=null,t&&t.destroy(),window.removeEventListener("resize",p.panelPosition),window.removeEventListener("scroll",c.panelTopPosition),window.removeEventListener("scroll",p.showHideUp),delete v.app.platform.ws.messages.event.clbks.author,delete v.app.platform.clbks.api.actions.subscribe.author,delete v.app.platform.clbks.api.actions.unsubscribe.author,delete v.app.platform.clbks.api.actions.subscribePrivate.author,c.destroy();var e=deep(v,"app.modules.menu.module.destroyauthorsearch");e&&isMobile()&&e(),r={}},init:function(e){var n,t;setTimeout(function(){var e=deep(v,"app.modules.menu.module.initauthorsearch");e&&isMobile()&&(i.clear=h,e(i))},300),f(),(r={}).c=e.el.find("#"+v.map.id),r.lenta=r.c.find(".lentaWrapper"),r.menu=r.c.find(".usermenu"),r.panel=r.c.find(".panel"),r.caption=r.c.find(".bgCaption"),r.fxd=r.c.find(".fxd"),r.subscribe=r.c.find(".subscribebuttonstop"),r.up=r.c.find(".upbuttonwrapper"),r.w=$(window),r.contents=r.c.find(".contentswrapper"),r.info=r.c.find(".authorinfoWrapper"),n=!0,t=parameters().report||"shares",u[t].active=!0,d.report(u[t],null,n),d.menu(),v.app.user.isState(function(e){!e||(e=v.app.platform.sdk.users.storage[v.app.platform.sdk.address.pnet().address])&&e.relation(i.address,"blocking")&&r.caption.addClass("blocking")}),o=v.app.platform.api.upbutton(r.up,{top:function(){return"65px"},class:"light",rightEl:r.c.find(".leftpanelcell")}),v.app.platform.sdk.contents.get(i.address,function(e){d.contents(e)}),isMobile()||d.info(r.info),r.up.on("click",p.up),r.subscribe.find(".subscribe").on("click",p.subscribe),r.subscribe.find(".unsubscribe").on("click",p.unsubscribe),r.c.find(".notificationturn").on("click",p.subscribePrivate),r.caption.find(".unblocking").on("click",function(){dialog({html:v.app.localization.e("e13023"),btn1text:v.app.localization.e("unblock"),btn2text:v.app.localization.e("ucancel"),class:"zindex",success:function(){v.app.platform.api.actions.unblocking(i.address,function(e,n){e||v.app.platform.errorHandler(n,!0)})}})}),v.app.platform.ws.messages.event.clbks.author=function(e){"subscribe"!=e.mesType&&"unsubscribe"!=e.mesType||(r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count()))},v.app.platform.clbks.api.actions.subscribe.author=function(e){e==i.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count())),v.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count()))},v.app.platform.clbks.api.actions.subscribePrivate.author=function(e){e==i.address&&(r.subscribe.addClass("following"),r.c.find(".notificationturn").addClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count())),v.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count()))},v.app.platform.clbks.api.actions.unsubscribe.author=function(e){e==i.address&&(r.subscribe.removeClass("following"),r.c.find(".notificationturn").removeClass("turnon"),r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count())),v.app.user.address.value.toString("hex")==i.address&&(r.c.find('.toReport[report="followers"] .count').html(u.followers.count()),r.c.find('.toReport[report="following"] .count').html(u.following.count()))},v.app.platform.clbks.api.actions.blocking.author=function(e){e==i.address&&(r.caption.addClass("blocking"),r.c.find(".notificationturn").removeClass("turnon"))},v.app.platform.clbks.api.actions.unblocking.author=function(e){e==i.address&&r.caption.removeClass("blocking")},v.user.isItMe(i.address)&&v.app.nav.api.backChainClear(),e.clbk(null,e)}}}var v=new nModule,o={};return v.run=function(e){var n=v.addEssense(o,t,e);v.init(n,e)},v.stop=function(){_.each(o,function(e){e.destroy()})},v.authclbk=function(){_.each(o,function(e){e.authclbk()})},v}();"undefined"!=typeof module?module.exports=author:(app.modules.author={},app.modules.author.module=author);
 /*_____*/ 
var userslist=function(){function t(s){var t,e,s=deep(s,"history"),i=[],o=!1,a=null,r=0,n=function(s){dialog({html:v.app.localization.e("e13022"),btn1text:v.app.localization.e("unsub"),btn2text:v.app.localization.e("ucancel"),class:"zindex",success:function(){v.app.platform.api.actions.unsubscribe(s,function(s,n){s||v.app.platform.errorHandler(n,!0)})}})},c=function(s){v.app.platform.api.actions.subscribeWithDialog(s,function(s,n){s||v.app.platform.errorHandler(n,!0)})},u=function(s,n){n=n?"notificationsTurnOff":"notificationsTurnOn";v.app.platform.api.actions[n](s,function(s,n){s||v.app.platform.errorHandler(n,!0)})},l=function(){$(window).scrollTop()+$(window).height()>$(document).height()-400&&!e&&!o&&g()},d=function(){var s=$(this).closest(".user").attr("address");n(s)},p=function(){var s=$(this).closest(".user").attr("address");c(s)},f=function(){var s=$(this).closest(".user").attr("address"),n=$(this).hasClass("turnon");u(s,n)},b=function(s,n){v.shell({name:"users",el:t.users,data:{addresses:s,extra:a},inner:append},function(s){n&&n()})},m=function(s,n){e||(e=!0,topPreloader(80),t.c.addClass("loading"),v.sdk.users.get(s,function(){t.c.removeClass("loading"),e=!1,topPreloader(100),n&&n()}))},g=function(s){var n=_.filter(i,function(s,n){if(50*r<=n&&n<50*(r+1))return!0});n.length?(m(n,function(){b(n,s)}),r++):o=!0},k=function(){};return{primary:s,getdata:function(s,n){r=0,e=o=!1;var t={};i=deep(n.settings,"essenseData.addresses")||[],t.addresses=i,t.empty=deep(n.settings,"essenseData.empty"),t.caption=deep(n.settings,"essenseData.caption"),a=deep(n.settings,"essenseData.extra"),s(t)},destroy:function(){window.removeEventListener("scroll",l),delete v.app.platform.clbks.api.actions.subscribe.userlist,delete v.app.platform.clbks.api.actions.subscribePrivate.userlist,delete v.app.platform.clbks.api.actions.unsubscribe.userlist,delete v.app.platform.clbks.api.actions.blocking.userlist,t={}},init:function(s){k(),(t={}).c=s.el.find("#"+v.map.id),t.users=t.c.find(".users"),v.app.platform.clbks.api.actions.subscribe.userlist=function(s){t.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("following"),t.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},v.app.platform.clbks.api.actions.subscribePrivate.userlist=function(s){t.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("following"),t.c.find('.user[address="'+s+'"] .notificationturn').addClass("turnon")},v.app.platform.clbks.api.actions.unsubscribe.userlist=function(s){t.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("following"),t.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},v.app.platform.clbks.api.actions.blocking.userlist=function(s){t.c.find('.user[address="'+s+'"] .subscribebuttonstop').addClass("blocking"),t.c.find('.user[address="'+s+'"] .notificationturn').removeClass("turnon")},v.app.platform.clbks.api.actions.unblocking.userlist=function(s){t.c.find('.user[address="'+s+'"] .subscribebuttonstop').removeClass("blocking")},t.c.on("click",".subscribe",p),t.c.on("click",".unsubscribe",d),t.c.on("click",".unblocking",d),t.c.on("click",".notificationturn",f),g(function(){window.addEventListener("scroll",l)}),s.clbk(null,s)}}}var v=new nModule,e={};return v.run=function(s){var n=v.addEssense(e,t,s);v.init(n,s)},v.stop=function(){_.each(e,function(s){s.destroy()})},v}();"undefined"!=typeof module?module.exports=userslist:(app.modules.userslist={},app.modules.userslist.module=userslist);
 /*_____*/ 
var ustate=function(){function n(t){function e(n){p.app.platform.sdk.user.waitActions(function(e){p.app.platform.sdk.ustate.me(function(t){s=e,i=t,l.uscnt(function(){o.ustatecontent=o.c.find(".ustatecontent"),l.ustatecontent(),l.reputationsteps(),n&&n()})},!0)})}var o,i,s,t=deep(t,"history"),n=makeid(),a={post:{key:"post",vis:"scale",name:p.app.localization.e("spc"),bad:function(t){if(t<=2)return!0}},score:{key:"score",vis:"scale",name:p.app.localization.e("ssc"),bad:function(t){if(t<=10)return!0}},comment:{key:"comment",vis:"scale",name:p.app.localization.e("ccc"),bad:function(t){if(t<=10)return!0}},comment_score:{key:"comment_score",vis:"scale",name:p.app.localization.e("crc"),bad:function(t){if(t<=10)return!0}}},l={gifts:function(s){p.app.platform.sdk.processes.get(function(t){p.app.platform.sdk.processes.gifts(function(n){var o=p.app.platform.sdk.processes.level(i.reputation);o&&_.each(t,function(e){var t;e.level&&(t=s.find('.level[level="'+e.level+'"]'),e.level<o.level&&(_.find(n,function(t){return t.amount==1e8*e.bonus})?t.removeClass("waitgift"):t.addClass("waitgift")))})})})},currentLevel:function(a){p.app.platform.sdk.processes.get(function(t){var s=p.app.platform.sdk.processes.level(i.reputation);s&&_.each(t,function(t){var e,n,o;t.level&&(n="next",o=(e=a.find('.level[level="'+t.level+'"]')).find(".line"),t.level<s.level&&(n="completed",o.removeAttr("width")),t.level==s.level&&(n="current",o.width(100*s.perc+"%")),t.level>s.level&&(next="next",o.removeAttr("width")),e.attr("state",n))})})},reputationsteps:function(n){p.app.platform.sdk.processes.get(function(t){var e=p.app.platform.sdk.processes.level(i.reputation);p.shell({name:"reputation",el:o.c.find(".ustatecontentrep"),data:{reputation:i.reputation,level:e,levels:t}},function(t){l.currentLevel(t.el),l.gifts(t.el),t.el.find(".tooltip").tooltipster({theme:"tooltipster-light",maxWidth:600,zIndex:20}),n&&n()})})},uscnt:function(e){p.shell({name:"uscnt",el:o.c.find(".mwork"),data:{mestate:i,metrics:a}},function(t){e&&e()})},ustatecontent:function(e){p.shell({name:"ustatecontentnew",el:o.ustatecontent,data:{metrics:a,mestate:i,waitActions:s}},function(t){e&&e()})}},c=function(){};return{primary:t,getdata:function(t){0;t({})},destroy:function(){o={},delete p.app.platform.ws.messages["new block"].clbks.ustate,delete p.app.platform.sdk.ustate.clbks[n]},init:function(t){c(),(o={}).c=t.el.find("#"+p.map.id),p.app.platform.sdk.ustate.clbks[n]=e,e(function(){p.app.platform.ws.messages["new block"].clbks.ustate=function(t){p.app.platform.sdk.user.waitActions(function(t){s=t,l.ustatecontent()})},t.clbk(null,t)})},tooltip:{options:{minWidth:380,position:"left",functionPosition:function(t,e,n){return n.coord.top=10,n.coord.left+=10,n},theme:"tooltipster-light zindex ustatetooltip"}}}}var p=new nModule,o={};return p.run=function(t){var e=p.addEssense(o,n,t);p.init(e,t)},p.stop=function(){_.each(o,function(t){t.destroy()})},p}();"undefined"!=typeof module?module.exports=ustate:(app.modules.ustate={},app.modules.ustate.module=ustate);
